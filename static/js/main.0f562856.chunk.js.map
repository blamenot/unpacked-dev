{"version":3,"sources":["reducers/offers-add.js","reducers/auth.js","reducers/game-finder.js","reducers/game-cache.js","reducers/offer-finder.js","reducers/user-cache.js","reducers/chat-cache.js","reducers/clause-cache.js","reducers/address-lookup-cache.js","reducers/user-update.js","reducers/message-cache.js","actions/user-cache.js","constants/action-types.js","constants/collection-names.js","components/login-button.js","actions/auth.js","components/header-offers.js","constants/paths.js","components/header-profile-name.js","components/header-profile.js","components/header.js","components/modal.js","components/auth-modal.js","actions/game-cache.js","actions/game-finder.js","components/game-finder-input.js","components/game-dummy.js","components/game.js","components/game-tile.js","components/offers-add-suggestion.js","actions/offers-add.js","components/game-finder-offers.js","components/offers-add-modal.js","components/modals.js","components/offers-counter.js","components/game-finder-result.js","components/game-finder-results.js","components/location-finder-input.js","components/location-finder-marker.js","components/location-finder-map.js","pages/page-search.js","components/offers-add.js","components/user-game.js","components/user-game-list.js","pages/page-offers.js","components/ask-authenticate.js","actions/user-update.js","components/profile-form.js","components/profile-footer.js","components/profile-panel.js","components/profile-map.js","actions/address-lookup-cache.js","components/address-lookup.js","components/address-suggestion.js","components/address-suggestions.js","pages/page-profile.js","pages/page-registration.js","actions/chat-cache.js","actions/clause-cache.js","constants/clause-statuses.js","components/submit-to-offer.js","components/game-offer.js","components/game-offers.js","pages/page-game.js","components/chat.js","pages/page-chats.js","actions/message-cache.js","components/message.js","components/message-list.js","components/message-input.js","pages/page-chat.js","components/deal-balance.js","components/clause.js","components/deal-clauses.js","components/deal.js","pages/page-deal.js","pages/page-not-found.js","app.js","serviceWorker.js","index.js"],"names":["initialState","user","modalShown","wait","addError","authModalShown","subscribed","authData","logoutError","searchPhrase","searchKey","pendingPromise","gamesFetchError","gamesByIdWait","gamesByIdFetched","gamesByIdError","games","offersForGameWait","offersForGameFetched","offers","offersFetchErrors","usersByOfferWait","usersByOfferFetched","usersByOfferError","userByIdWait","userByIdError","userUpdateWait","userUpdateError","users","chatsByParticipantWait","chatsByParticipantFetched","chatsByParticipantError","chats","chatAddWait","chatAddError","clauses","clauseAddWait","clauseAddError","clausesByChatWait","clausesByChatFetched","clausesByChatError","clausesUpdateWait","clausesUpdateError","lookupPhrase","suggestions","suggestionsFetchWait","suggestionsFetchError","suggestionsFetched","isSaved","messages","messagesFetchWait","messagesFetchError","messagesUnsubscribe","userCacheFetchByOffer","gameId","type","payload","userCacheWaitByOffer","userCacheErrorByOffer","userCacheFetchById","userId","userCacheUpdate","userCacheUpdateError","userCacheFetchByOfferRequest","dispatch","a","async","query","firebase","firestore","collection","where","get","querySnapshot","docs","reduce","doc","id","data","userCacheFetchUserByIdRequest","ref","connect","onAuthShowModal","customText","className","onClick","auth","to","replace","uid","userCache","unregistered","name","displayName","path","onAuthSubscribe","onAuthStateChanged","authLogin","onAuthLogout","signOut","history","useEffect","push","Header","Modal","renderCallback","closeCallback","window","scrollY","document","body","style","top","width","position","scrollTo","parseFloat","closeByEsc","e","key","addEventListener","removeEventListener","target","currentTarget","uiConfig","signInFlow","signInOptions","GoogleAuthProvider","PROVIDER_ID","EmailAuthProvider","credentialHelper","firebaseui","CredentialHelper","NONE","callbacks","signInSuccessWithAuthResult","onHideModal","firebaseAuth","gameCacheFetchById","game","gameCacheWaitById","gameCacheFetchByIdRequest","gameFinderFetch","gameFinderFetchWait","gameFinderFetchError","gameFinder","onGameFinderSearchPhrase","gameFinderSearchPhrase","onGameFinderFetchRequest","gamesQuery","then","gameFinderFetchRequest","onGameFinderFetchCancel","placeholder","value","onChange","currentSearchKey","toLowerCase","trim","substring","length","GameDummy","error","Game","this","props","platform","src","pic","alt","React","Component","gameCache","fetchById","fetchWait","fetchError","onUserCacheAddUserGameRequest","isDemand","updateField","indexOf","update","FieldValue","arrayUnion","userCacheAddUserGameRequest","filteredGames","tags","some","tag","rederedResults","state","onOffersAddHideModal","Modals","offersAddModalShown","PureComponent","offersAdd","userCount","Object","values","filter","offerIds","fetched","onUserCacheFetchByOfferRequest","toString","GameFinderResult","gamePagePath","GameFinderResults","statePart","Marker","Popup","height","Map","center","zoom","scrollWheelZoom","TileLayer","attribution","url","map","latitude","longitude","getMarkers","onOffersAddShowModal","offersAddShowModal","authUserId","onOffersDeleteRequest","offerId","arrayRemove","userGameId","userCacheDeleteUserGameRequest","ownerId","deleteButton","UserGameList","gameIds","renderedOffers","match","params","onUserCacheFetchUserByIdRequest","isSelf","AskAuthenticate","userUpdateUnsaved","userUpdateSaved","userUpdateSaveRequest","updatedUser","userUpdates","successCallback","userCacheUserUpdate","userUpdateCreateRequest","set","userCacheUserCreate","userUpdate","onNameUpdate","ProfileFooter","onProfileUserSaveRequest","onProfileUserCreateRequest","isRegistration","getLocationAndPlaceLabel","location","place","addressLookupCacheFetch","addressLookupCacheFetchWait","onAddressLookup","encodeURI","fetch","response","json","addressLookupCacheFetchRequest","useState","setLookupPhrase","onLocationUpdate","suggestion","display_name","lon","lat","addressLookupCache","place_id","renderSuggestions","registeredUser","onProfileUserUnregistered","userUnregistered","chatCacheFetchByParticipant","participantId","chatCacheWaitByParticipant","chatCacheErrorByParticipant","chatCacheAddPush","chatId","chat","chatCacheFetchByParticipantRequest","clauseCacheAddPush","clauseId","clause","clauseCacheFetchByChat","clauseCacheWaitByChat","clauseCacheErrorByChat","clauseCacheUpdate","clauseCacheAddRequest","suggesterId","respondentId","status","date","Date","add","clauseRef","clauseCacheAddError","clauseCacheFetchActiveByChatRequest","clauseCacheUpdateStatusRequest","chatCache","authenticatedUserId","dealChatId","Array","isArray","participantIds","waitFetch","onChatCacheFetchByParticipantRequest","onChatAndClauseAddRequest","toggleRedirect","chatRef","onClauseAddRequest","redirectUrl","PageGame","fetchChats","userChats","renderedChats","renderChats","filteredChats","filterChatsByParticipant","messageCacheFetch","messageCacheUpdate","outdatedMessageId","updatedMessage","message","text","isUpdating","String","fromCharCode","getStatusSign","messageCache","onSendMessage","authorId","messageRef","sendDate","serverTimestamp","updateDate","confirmedMessageId","sendError","messageCacheSendMessageRequest","inputEl","useRef","current","onClauseFetchRequest","onMessagesFetchRequest","orderBy","limit","queyrSnapshot","metadata","hasPendingWrites","messageCacheFetchRequest","onMessagesSubscribe","onSnapshot","docChanges","forEach","change","updateError","messageCacheSubscribe","messageCacheSubscribeRequest","onMessagesUnsubscribe","chatClausesArray","clausesArray","clauseStatus","balance","gamePrice","unpackedPrice","getBalance","acceptClause","rejectClause","clauseCache","chatClauses","renderedClauses","renderedClause","gamesFetchErrors","isGamesFetched","every","isGamesWait","hasAllRequiredGames","fetchGames","gameCacheFetchMissingGamesRequest","JSON","stringify","NotFound","rootReducer","combineReducers","action","gameByIdError","offerFinder","filteredOffers","offersToAdd","offersFetchError","messageIndex","findIndex","slice","store","createStore","undefined","composeWithDevTools","applyMiddleware","thunk","Boolean","hostname","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","ReactDOM","render","component","exact","PageOffers","PageSearch","PageProfile","PageRegistration","PageChats","PageChat","PageDeal","PageNotFound","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"wTAIMA,EAAe,CACpBC,KAAM,KACNC,YAAY,EACZC,MAAM,EACNC,SAAU,ICELJ,EAAe,CACjBK,gBAAgB,EAChBC,YAAY,EACfC,SAAU,KACVC,YAAa,GACbL,MAAM,GCPDH,EAAe,CACpBS,aAAc,GACdC,UAAW,GACXC,eAAgB,KAChBC,gBAAiB,M,OCNZZ,EAAe,CACpBa,cAAe,GACfC,iBAAkB,GAClBC,eAAgB,GAChBC,MAAO,ICJFhB,EAAe,CACpBiB,kBAAmB,GACnBC,qBAAsB,GACtBC,OAAQ,GACRC,kBAAmB,ICEdpB,EAAe,CACpBqB,iBAAkB,GAClBC,oBAAqB,GACrBC,kBAAmB,GACnBC,cAAc,EACdC,cAAe,KACfC,gBAAgB,EAChBC,gBAAiB,GACjBC,MAAO,ICXF5B,EAAe,CACpB6B,uBAAwB,GACxBC,0BAA2B,GAC3BC,wBAAyB,GACzBC,MAAO,GACPC,aAAa,EACbC,aAAc,MCHTlC,EAAe,CACpBmC,QAAS,GACTC,eAAe,EACfC,eAAgB,KAChBC,kBAAmB,GACnBC,qBAAsB,GACtBC,mBAAoB,GACpBC,mBAAmB,EACnBC,mBAAoB,MCdf1C,EAAe,CACpB2C,aAAc,GACdC,YAAa,GACbC,sBAAsB,EACtBC,sBAAuB,KACvBC,oBAAoB,GCFf/C,EAAe,CACpBC,KAAM,KACN+C,SAAS,G,QCFJhD,EAAe,CACpBiD,SAAU,GACVC,mBAAmB,EACnBC,mBAAoB,KACpBC,oBAAqB,M,4CCEtB,SAASC,EAAsBC,EAAQ1B,GACtC,MAAO,CACN2B,KCgBuC,4BDfvCC,QAAS,CAACF,SAAQ1B,UAGpB,SAAS6B,EAAqBH,GAC7B,MAAO,CACNC,KCWsC,2BDVtCC,QAAS,CAACF,WAGZ,SAASI,EAAsBJ,EAAQ/B,GACtC,MAAO,CACNgC,KCMuC,4BDLvCC,QAAS,CAACF,WAGZ,SAASK,EAAmBC,EAAQ3D,GACnC,MAAO,CACNsD,KCCoC,yBDApCC,QAAS,CAACI,SAAQ3D,SAYpB,SAAS4D,EAAgBD,EAAQ3D,GAChC,MAAO,CACNsD,KCX+B,oBDY/BC,QAAS,CACRI,SACA3D,SAOH,SAAS6D,EAAqBnC,GAC7B,MAAO,CACN4B,KCrBqC,0BDsBrCC,QAAS,CAAC7B,oBAQL,SAASoC,EAA6BT,GAC5C,OAAO,SAAMU,GAAN,mBAAAC,EAAAC,OAAA,uDACAC,EAAQC,IAASC,YACrBC,WE1E4B,SF2E5BC,MAAM,WAAY,iBAAkBjB,GACtCU,EAASP,EAAqBH,IAJxB,oBAAAW,EAAA,MAMuBE,EAAMK,OAN7B,OAMCC,EAND,OAOC7C,EAAQ6C,EAAcC,KAAKC,QAAO,SAAC/C,EAAOgD,GAE/C,OADAhD,EAAMgD,EAAIC,IAAMD,EAAIE,OACblD,IACL,IACHoC,EAASX,EAAsBC,EAAQ1B,IAXlC,kDAaLoC,EAASN,EAAsBJ,EAAD,OAbzB,0DAqBD,SAASyB,EAA8BnB,GAC7C,OAAO,SAAMI,GAAN,iBAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YACnBC,WEhG4B,SFgGCM,IAAIhB,GACnCI,EAzDM,CAACT,KCH4B,0BDyD7B,oBAAAU,EAAA,MAKae,EAAIR,OALjB,OAKCI,EALD,OAMLZ,EAASL,EAAmBC,EAAQgB,EAAIE,QAAU,OAN7C,gDAQLd,EA3DK,CACNT,KCNoC,yBDOpCC,QAAS,CAAC/B,cAyDkB,QARtB,yDGpFR,IAMewD,eANS,iBAAO,MACJ,SAAAjB,GAAQ,MAAK,CACvCkB,gBADuC,WAEtC,OAAOlB,ECIE,CACHT,KHlBuB,wBEgBhB0B,EAZf,YAAqD,IAA/BE,EAA8B,EAA9BA,WAAYD,EAAkB,EAAlBA,gBACjC,OACC,4BAAQE,UAAU,OAAOC,QAASH,GAAkBC,GAAc,YEYpE,IAGeF,eAHS,SAAC,GAAD,MAAa,CACpC1E,SADuB,EAAE+E,KACV/E,YAED0E,EAff,YAAmC,IAAZ1E,EAAW,EAAXA,SACtB,OAAGA,EAED,kBAAC,IAAD,CAAMgF,GCPuB,kBDOFC,QAAQ,UAAUjF,EAASkF,MAAtD,YAKM,kBAAC,EAAD,CAAaN,WAAW,gBEIjC,IASeF,eATS,SAAC,GAAuB,IAAtBK,EAAqB,EAArBA,KAAMI,EAAe,EAAfA,UACzB9B,EAAS0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IAC9C,MAAO,CACNlF,SAAU+E,EAAK/E,SACfoF,aAA0C,OAA5BD,EAAU9D,MAAMgC,GAC9B3D,KAAMyF,EAAU9D,MAAMgC,MAITqB,EAnBf,YAAiE,IAArC1E,EAAoC,EAApCA,SAAUoF,EAA0B,EAA1BA,aAA0B,IAAZ1F,YAAY,MAAP,KAAO,EACzD2F,EAAQ3F,GAAQA,EAAK2F,MAASrF,EAASsF,YACvCC,EAAQH,EDPuB,gBAHL,gBCYXH,QAAQ,OAAQjF,EAASkF,KAC9C,OACC,kBAAC,IAAD,CAAMF,GAAIO,GAAOF,MCiCnB,IAiBeX,eAjBS,SAAC,GAAuB,IAAtBK,EAAqB,EAArBA,KAAMI,EAAe,EAAfA,UACzB9B,EAAS0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IAC9C,MAAO,CACNnF,WAAYgF,EAAKhF,WACjBC,SAAU+E,EAAK/E,SACfoF,aAA0C,OAA5BD,EAAU9D,MAAMgC,GAC9BzD,KAAMmF,EAAKnF,MAAQuF,EAAUlE,iBAGJ,SAAAwC,GAAQ,MAAK,CACvC+B,gBADuC,WAEtC,OAAO/B,GJiBE,SAAAA,GAEHI,IAASkB,OAAOU,oBAAmB,SAASzF,GACrCA,GACCyD,EAhDhB,SAAmBzD,GACf,MAAO,CACHgD,KH9BkB,aG+BlBC,QAAS,CAACjD,aA6CO0F,CAAU1F,IAC/ByD,EAASe,EAA8BxE,EAASkF,OAEpCzB,EA5CL,CACHT,KHnCmB,mBGkFnBS,EA3DG,CACHT,KH1BsB,uBO0D7B2C,aAJuC,WAKtC,OAAOlC,GJAE,SAAMA,GAAN,SAAAC,EAAAC,OAAA,uDACTF,EAnBM,CACNT,KHvC6B,qBGwDpB,oBAAAU,EAAA,MAGFG,IAASkB,OAAOa,WAHd,OAIFnC,EA3BE,CACHT,KHnCmB,gBGyDhB,gDAMRS,EAnBK,CACNT,KH3C+B,oBG4C/BC,QAAS,CACRhD,YAgByB,EAAD,MANhB,+DIGIyE,EAxDf,YAQC,IAPAmB,EAOD,EAPCA,QACA9F,EAMD,EANCA,WACAC,EAKD,EALCA,SACAoF,EAID,EAJCA,aACAxF,EAGD,EAHCA,KACA4F,EAED,EAFCA,gBACAG,EACD,EADCA,aAWA,OATAG,qBAAU,WACL/F,GACHyF,IAEEJ,GAAgBpF,GAAYA,EAASkF,KACvCW,EAAQE,KFnB2B,mBEqBlC,CAAChG,EAAYyF,EAAiBJ,EAAcpF,EAAU6F,IAEtDjG,EAED,6BACC,yCAGOI,EAER,6BACC,kBAAC,EAAD,MACA,yBAAK8E,QAASa,GAAd,WAKD,6BACC,kBAAC,EAAD,UCpBWK,MAdf,YAA4B,IAAXH,EAAU,EAAVA,QAChB,OACC,gCACC,6BACC,yCACA,kBAAC,IAAD,CAAMb,GHZsB,WGY5B,cACA,kBAAC,EAAD,MACA,kBAAC,IAAD,CAAMA,GHVqB,UGU3B,UAED,kBAAC,EAAD,CAAea,QAASA,M,uECiCZI,MAhDf,YAAiD,IAAjCC,EAAgC,EAAhCA,eAAgBC,EAAgB,EAAhBA,cAyC/B,OAvCAL,qBAAU,WAOT,OANGM,OAAOC,UACTC,SAASC,KAAKC,MAAMC,IAApB,WAA8BL,OAAOC,QAArC,OAEDC,SAASC,KAAKC,MAAME,MAAQ,OAC5BJ,SAASC,KAAKC,MAAMG,SAAW,QAExB,WACN,IAAMF,EAAMH,SAASC,KAAKC,MAAMC,IAC7BA,IACFL,OAAOQ,SAAS,EAAGC,WAAWJ,EAAIxB,QAAQ,IAAK,IAAIA,QAAQ,KAAM,MACjEqB,SAASC,KAAKC,MAAMC,IAAM,IAE3BH,SAASC,KAAKC,MAAME,MAAQ,GAC5BJ,SAASC,KAAKC,MAAMG,SAAW,OAIjCb,qBAAU,WACT,SAASgB,EAAWC,GACR,WAAVA,EAAEC,KAAqBb,GAAiBA,EAAcY,GAIxD,OAFAT,SAASW,iBAAiB,QAASH,GAE5B,WACNR,SAASY,oBAAoB,QAASJ,OAevC,yBAAKjC,UAAU,QAAQC,QANxB,SAAoBiC,GAChBZ,GAAiBY,EAAEI,SAAWJ,EAAEK,eAClCjB,EAAcY,KAKd,yBAAKlC,UAAU,eAAeqB,OClC3BmB,EAAW,CAEbC,WAAY,QAEfC,cAAe,CACd1D,IAASkB,KAAKyC,mBAAmBC,YACjC5D,IAASkB,KAAK2C,kBAAkBD,aAEjCE,iBAAkBC,OAAgBC,iBAAiBC,KACnDC,UAAW,CACVC,4BADU,WAET,OAAO,KAcV,IAKetD,eAAQ,MALI,SAAAjB,GAAQ,MAAK,CACpCwE,YADoC,WAEhC,OAAOxE,EPhBJ,CACHT,KHtBuB,wBUwChB0B,EAbf,YAAmC,IAAfuD,EAAc,EAAdA,YAInB,OACC,kBAAC,EAAD,CAAO/B,eAJe,kBACtB,kBAAC,IAAD,CAAoBmB,SAAUA,EAAUa,aAAcrE,IAASkB,UAGxBoB,cAAe8B,OCxBjD,SAASE,GAAmBpF,EAAQqF,GAC1C,MAAO,CACNpF,KXQoC,yBWPpCC,QAAS,CACRF,SACAqF,SAIH,SAASC,GAAkBtF,GAC1B,MAAO,CACNC,KXAmC,wBWCnCC,QAAS,CAACF,WAaJ,SAASuF,GAA0BvF,GACzC,OAAO,SAAMU,GAAN,iBAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YACnBC,WVnC2B,SUoC3BM,IAAItB,GACNU,EAAS4E,GAAkBtF,IAJrB,oBAAAW,EAAA,MAMae,EAAIR,OANjB,OAMCI,EAND,OAOLZ,EAAS0E,GAAmBpF,EAAQsB,EAAIE,QAAU,OAP7C,gDASLd,GAA2B,KAnBvB,CACNT,KXLoC,4BWc7B,yDCjBT,SAASuF,GAAgBnI,GACxB,MAAO,CACN4C,KZI+B,oBYH/BC,QAAS,CAAC7C,mBAGZ,SAASoI,GAAoBrI,EAAWC,GACvC,MAAO,CACN4C,KZDoC,yBYEpCC,QAAS,CAAC9C,YAAWC,mBAGvB,SAASqI,GAAqBpI,EAAiBD,GAC9C,MAAO,CACN4C,KZNqC,0BYOrCC,QAAS,CAAC5C,kBAAiBD,mBCG7B,IAgBesE,gBAhBS,SAAC,GAAD,IAAEgE,EAAF,EAAEA,WAAF,MAAmB,CAC1CxI,aAAcwI,EAAWxI,aACzBC,UAAWuI,EAAWvI,cAEI,SAACsD,GAAD,MAAe,CACzCkF,yBADyC,SAChBzI,GACxBuD,ED9BK,SAAgCvD,GACtC,MAAO,CACN8C,KZSuC,4BYRvCC,QAAS,CAAC/C,iBC2BD0I,CAAuB1I,KAEjC2I,yBAJyC,SAIhB1I,GACxBsD,EDAK,SAAgCtD,GAGtC,OAAO,SAAMsD,GAAN,iBAAAC,EAAAC,OAAA,gDACAmF,EAAajF,IAASC,YAC1BC,WXhD4B,SWiD5BC,MAAM,aAAc,iBAAkB7D,IAClCC,EAAiB0I,EAAW7E,OACnB8E,MACd,SAAA7E,GACC,IAAMzD,EAAQyD,EAAcC,KAAKC,QAAO,SAAC3D,EAAO4D,GAE/C,OADA5D,EAAM4D,EAAIC,IAAMD,EAAIE,OACb9D,IACL,IAEH,IAAI,IAAIsC,KADRU,EAAS8E,GAAgBnI,IACPK,EACjBgD,EAAS0E,GAAmBpF,EAAQtC,EAAMsC,QAI5C,SAAA1C,GACCoD,EAASgF,GAAqBpI,EAAiBD,OAGjDqD,EAAS+E,GAAoBrI,EAAWC,IArBlC,sCCHG4I,CAAuB7I,KAEjC8I,wBAPyC,WAQxCxF,EDXM,CAACT,KZV+B,iCayBzB0B,EA5Cf,YAMI,IALHxE,EAKE,EALFA,aACAC,EAIE,EAJFA,UACAwI,EAGE,EAHFA,yBACAE,EAEE,EAFFA,yBACAI,EACE,EADFA,wBAaA,OACC,2BACCjG,KAAK,OACLkG,YAAY,4BACZC,MAAOjJ,EACPkJ,SAhBF,SAA8BrC,GAC7B,IAAM7G,EAAe6G,EAAEI,OAAOgC,MACxBE,EAAmBnJ,EAAaoJ,cAAcC,OAAOC,UAAU,EAAE,GAEnEH,EAAiBI,OAAS,GAAMtJ,EACnC8I,IACuC,IAA5BI,EAAiBI,QAAkBJ,IAAqBlJ,GACnE0I,EAAyBQ,GAE1BV,EAAyBzI,SCLZwJ,OAjBf,YAA2E,IAAtD9J,EAAqD,EAArDA,KAAqD,IAA/C+J,aAA+C,MAAvC,qCAAuC,EACzE,OAAG/J,EAEF,yBAAKiF,UAAU,QACd,wCACA,yCAKA,yBAAKA,UAAU,QACd,sCACA,6BAAM8E,KCDKC,G,iLARb,OACC,yBAAK/E,UAAU,QACd,6BAAMgF,KAAKC,MAAM1B,KAAK2B,UACtB,yBAAKlF,UAAU,WAAWmF,IAAKH,KAAKC,MAAM1B,KAAK6B,IAAKC,IAAKL,KAAKC,MAAM1B,KAAK/C,Y,GAN1D8E,IAAMC,WCqBzB,IAYe1F,gBAZS,SAAC,EAAD,OAAE2F,EAAF,EAAEA,UAAatH,EAAf,EAAeA,OAAf,MAA4B,CACnDqF,KAAMiC,EAAU5J,MAAMsC,GACtBnD,KAAMyK,EAAU/J,cAAcyC,GAC9B4G,MAAOU,EAAU7J,eAAeuC,OAGN,SAAAU,GAAQ,MAAK,CACvC6G,UADuC,SAC7BvH,GACTU,EAAS6E,GAA0BvF,QAItB2B,EA7Bf,YAAsE,IAAlD3B,EAAiD,EAAjDA,OAAQqF,EAAyC,EAAzCA,KAAMmC,EAAmC,EAAnCA,UAAWC,EAAwB,EAAxBA,WAAYF,EAAY,EAAZA,UAMxD,GALAxE,qBAAU,WACLsC,GAASmC,GAAcC,GAC1BF,EAAUvH,MAGTqF,EACF,OAAO,yBAAKvD,UAAU,aACrB,kBAAC,GAAD,CAAMuD,KAAMA,EAAMrF,OAAQA,KAG5B,IAAMnD,EAAO2K,IAAenC,IAASmC,IAAcC,EACnD,OAAO,yBAAK3F,UAAU,aACrB,kBAAC,GAAD,CAAWjF,KAAMA,EAAM+J,MAAOa,QCDhC,IAUe9F,gBAVS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAMI,EAAR,EAAQA,UAAR,MAAwB,CAC/C9B,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IACvCxF,KAAMyF,EAAUJ,EAAK/E,UAAY+E,EAAK/E,SAASkF,SAErB,SAAAzB,GAAQ,MAAK,CACvCgH,8BADuC,SACTpH,EAAQN,EAAQ2H,GAC7CjH,ElBwFM,SAAqCJ,EAAQN,EAAQ2H,GAC5D,OAAO,SAAMjH,GAAN,qBAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YACnBC,WEnH4B,SFmHCM,IAAIhB,GACnCI,EA1DM,CAACT,KClB6B,2BDyE9B,oBAAAU,EAAA,MAKae,EAAIR,OALjB,UAKCI,EALD,QAOD3E,EAAO2E,EAAIE,QACToG,EAAcD,EAAW,YAAc,eACnBhL,EAAKiL,GAAaC,QAAQ7H,GAAU,GATzD,oCAAAW,EAAA,MAUEe,EAAIoG,OAAJ,eACJF,EAAc9G,IAASC,UAAUgH,WAAWC,WAAWhI,MAXrD,QAaJrD,EAAKiL,GAAejL,EAAKiL,IAAgB,GACzCjL,EAAKiL,GAAa5E,KAAKhD,GAdnB,QAgBLU,EAASH,EAAgBD,EAAQ3D,IAhB5B,kDAkBL+D,EAASF,EAAqB,EAAD,KAlBxB,0DkBzFGyH,CAA4B3H,EAAQN,EAAQ2H,IACrDjH,ECZM,CACNT,KlBGmC,8BiBWtB0B,EAtBf,YAA2F,IAA7D0D,EAA4D,EAA5DA,KAAMrF,EAAsD,EAAtDA,OAAQM,EAA8C,EAA9CA,OAAcoH,GAAgC,EAAtC/K,KAAsC,EAAhC+K,+BAIzD,OACC,yBAAK5F,UAAU,wBACdC,QALc,WACf2F,EAA8BpH,EAAQN,GAAQ,KAK7C,kBAAC,GAAD,CAAUqF,KAAMA,EAAMrF,OAAQA,QEEjC,IAiBe2B,gBAjBS,SAAC,GAA6B,IAA5B2F,EAA2B,EAA3BA,UACrBY,EAAgB,GACd/K,EAF8C,EAAhBwI,WAEJxI,aAAaoJ,cAC7C,IAAK,IAAIvG,KAAUsH,EAAU5J,MAAO,CACnC,IAAI2H,EAAOiC,EAAU5J,MAAMsC,GACVqF,EAAK8C,KAAKC,MAAK,SAACC,GAChC,OAAmD,IAA5CA,EAAI9B,cAAcsB,QAAQ1K,QAGjC+K,EAAclI,GAAUqF,GAG1B,MAAO,CACN3H,MAAOwK,KAIMvG,EA5Bf,YAAqC,IAATjE,EAAQ,EAARA,MACvB4K,EAAiB,GACrB,IAAK,IAAItI,KAAUtC,EAClB4K,EAAetF,KAAK,kBAAC,GAAD,CACnBhD,OAAQA,EACRqF,KAAM3H,EAAMsC,GACZiE,IAAKjE,KAEP,OAAOsI,KCLF7E,GAAQ,CACb,gBAAmB,QACnB,UAAa,QACb,MAAS,QACT,QAAW,OACX,UAAa,WAuBd,IAMe9B,gBANS,SAAA4G,GAAK,MAAK,MACP,SAAA7H,GAAQ,MAAK,CACvC8H,qBADuC,WAEtC9H,EFzBM,CACNT,KlBGmC,8BoBwBtB0B,EA1Bf,YAAiD,IAAxB6G,EAAuB,EAAvBA,qBAexB,OACC,kBAAC,EAAD,CAAOrF,eAfe,kBACtB,yBAAKM,MAAOA,IACX,4CACA,gCACC,uCACA,yCAED,kBAAC,GAAD,MACA,6BACC,kBAAC,GAAD,SAMqCL,cAAeoF,OCzBlDC,G,iLAEJ,OAAI3B,KAAKC,MAAMhK,eACP,kBAAC,GAAD,MACG+J,KAAKC,MAAM2B,oBACd,kBAAC,GAAD,MAED,S,GAPYtB,IAAMuB,eAeZhH,gBAJS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAM4G,EAAR,EAAQA,UAAR,MAAwB,CAC/C7L,eAAgBiF,EAAKjF,eACrB2L,oBAAqBE,EAAUhM,cAEjB+E,CAAyB8G,ICAxC,IAgBe9G,gBAhBS,SAAC,EAAD,GAA4B,IAA1BS,EAAyB,EAAzBA,UAAapC,EAAY,EAAZA,OAGtC,MAAO,CACN6I,UAHiBC,OAAOC,OAAO3G,EAAU9D,OACxC0K,QAAO,SAAArM,GAAI,OAAIA,GAAQA,EAAKsM,UAAYtM,EAAKsM,SAASpB,QAAQ7H,IAAW,KAAG0G,OAG7E7J,KAAMuF,EAAUrE,iBAAiBiC,GACjC4G,MAAOxE,EAAUnE,kBAAkB+B,GACnCkJ,QAAS9G,EAAUpE,oBAAoBgC,OAGd,SAAAU,GAAQ,MAAK,CACvCyI,+BADuC,SACRnJ,GAC9BU,EAASD,EAA6BT,QAIzB2B,EAjCf,YAAoG,IAA3E3B,EAA0E,EAA1EA,OAAQ6I,EAAkE,EAAlEA,UAAWhM,EAAuD,EAAvDA,KAAM+J,EAAiD,EAAjDA,MAAOsC,EAA0C,EAA1CA,QAASC,EAAiC,EAAjCA,+BAMjE,OALApG,qBAAU,WACLlG,GAASqM,GACZC,EAA+BnJ,KAE9B,CAACA,EAAQnD,EAAMqM,EAASC,IACxBtM,EACK,0CACG+J,EACH,8BAAOA,EAAMwC,cACTF,GAGJL,KCFMQ,OAVf,YAA4C,IAAhBrJ,EAAe,EAAfA,OACrBsJ,GADoC,EAAPjE,KlBDN,gBkBEOnD,QAAQ,UAAWlC,IACvD,OAAQ,kBAAC,IAAD,CAAMiC,GAAIqH,GAChB,6BACC,kBAAC,GAAD,CAAUtJ,OAAQA,IAClB,kBAAC,GAAD,CAAeA,OAAQA,OCGZuJ,OAXf,YAAsC,IAAT7L,EAAQ,EAARA,MACxB4K,EAAiB,GACrB,IAAK,IAAItI,KAAUtC,EAClB4K,EAAetF,KAAK,kBAAC,GAAD,CACnBhD,OAAQA,EACRqF,KAAM3H,EAAMsC,GACZiE,IAAKjE,KAEP,OAAOsI,GCDR,IAKe3G,gBALS,SAAC,GAAD,EAAE6H,UAAF,MAAkB,MAEf,SAAA9I,GAAQ,MAAK,KAGzBiB,EAXf,WACC,OAAO,2BACL1B,KAAK,OACLkG,YAAY,2B,oCCiBf,IAKexE,gBALS,SAAC,GAAD,EAAE6H,UAAF,MAAkB,MAEf,SAAA9I,GAAQ,MAAK,KAGzBiB,EAxBf,YAAkD,IAAlBiC,EAAiB,EAAjBA,SAAUtB,EAAO,EAAPA,KACzC,OAAIsB,EAAS,IAAOA,EAAS,GAU5B,kBAAC6F,GAAA,EAAD,CAAQ7F,SAAUA,GACjB,kBAAC8F,GAAA,EAAD,KACEpH,IAVF,kBAACmH,GAAA,EAAD,CAAQ7F,SAAU,CAAC,QAAS,UAC3B,kBAAC8F,GAAA,EAAD,KACE,oBAAsBpH,OCJtBmB,I,MAAQ,CACbE,MAAO,QACPgG,OAAQ,UAkBT,IAqBehI,gBArBS,SAAC,EAAD,GAAiC,IAA/BK,EAA8B,EAA9BA,KAAMI,EAAwB,EAAxBA,UAAa1E,EAAW,EAAXA,MACtC4C,EAAS0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IAC1C7D,EAAQ,GACZ,IAAI,IAAI0B,KAAUtC,EACjB,IAAI,IAAI4C,KAAU8B,EAAU9D,MAAO,CAClC,IAAI3B,EAAOyF,EAAU9D,MAAMgC,GAC3B,GAAG3D,GAAQA,EAAKsM,UAAYtM,EAAKsM,SAASpB,QAAQ7H,IAAW,EAAG,CAC/D1B,EAAMgC,GAAU3D,EAChB,OAIH,MAAO,CACNM,SAAU+E,EAAK/E,SACfN,KAAMyF,EAAU9D,MAAMgC,GACtBhC,MAAOA,MAGkB,SAAAoC,GAAQ,MAAK,KAGzBiB,EApCf,YAA2C,EAAdhF,KAAe,IAAT2B,EAAQ,EAARA,MAClC,OAAQ,kBAACsL,GAAA,EAAD,CAAKC,OAAQ,CAAC,QAAS,SAAUC,KAAM,GAAIrG,MAAOA,GAAOsG,iBAAiB,GAChF,kBAACC,GAAA,EAAD,CACCC,YAAY,0EACZC,IAAI,uDAKR,SAAoB5L,GACnB,OAAOwK,OAAOC,OAAOzK,GAAO6L,KAAI,SAAAxN,GAAI,OACnC,kBAAC,GAAD,CAAsBsH,IAAKtH,EAAK4E,GAAIe,KAAM3F,EAAK2F,KAAMsB,SAAU,CAACjH,EAAKyN,SAAUzN,EAAK0N,gBALlFC,CAAWhM,OCKf,IAiBeqD,gBAjBS,SAAC,GAA6B,IAA5B2F,EAA2B,EAA3BA,UACrBY,EAAgB,GACd/K,EAF8C,EAAhBwI,WAEJxI,aAAaoJ,cAC7C,IAAK,IAAIvG,KAAUsH,EAAU5J,MAAO,CACnC,IAAI2H,EAAOiC,EAAU5J,MAAMsC,GACVqF,EAAK8C,KAAKC,MAAK,SAACC,GAChC,OAAmD,IAA5CA,EAAI9B,cAAcsB,QAAQ1K,QAGjC+K,EAAclI,GAAUqF,GAG1B,MAAO,CACN3H,MAAOwK,KAIMvG,EAhCf,YAA+B,IAATjE,EAAQ,EAARA,MACrB,OACC,yBAAKoE,UAAU,gBACd,yBAAKA,UAAU,qBACd,kBAAC,GAAD,MACA,kBAAC,GAAD,CAAmBpE,MAAOA,KAE3B,yBAAKoE,UAAU,qBACd,kBAAC,GAAD,MACA,kBAAC,GAAD,CAAmBpE,MAAOA,SCA9B,IAOeiE,gBAPS,SAAA4G,GAAK,MAAK,MACP,SAAA7H,GAAQ,MAAK,CACvC6J,qBADuC,SAClB5N,GACpB+D,EXZK,SAA4B/D,GAClC,MAAO,CACNsD,KlBQmC,wBkBPnCC,QAAS,CAACvD,SWSD6N,CAAmB7N,QAIfgF,EAlBf,YAA4C,IAAxB4I,EAAuB,EAAvBA,qBACnB,OACE,yBAAKzI,UAAU,aACd,yBAAKA,UAAU,OAAOC,QAASwI,GAC9B,yCACA,yBAAKzI,UAAU,YAAf,UCUL,IAQeH,gBARS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAF,MAAa,CACpCyI,WAAYzI,EAAK/E,UAAY+E,EAAK/E,SAASkF,QAEjB,SAAAzB,GAAQ,MAAK,CACvCgK,sBADuC,SACjBpK,EAAQqK,GAC7BjK,E/BqHM,SAAwCJ,EAAQN,EAAQ2H,GAC/D,OAAO,SAAMjH,GAAN,qBAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YACnBC,WEhJ4B,SFgJCM,IAAIhB,GACnCI,EAvFM,CAACT,KClB6B,2BDsG9B,oBAAAU,EAAA,MAKae,EAAIR,OALjB,UAKCI,EALD,UAOD3E,EAAO2E,EAAIE,QACToG,EAAcD,EAAW,YAAc,aACpBhL,EAAKiL,GAAaC,QAAQ7H,IAAW,GATzD,oCAAAW,EAAA,MAUEe,EAAIoG,OAAJ,eACJF,EAAc9G,IAASC,UAAUgH,WAAW6C,YAAY5K,MAXtD,QAaJrD,EAAKiL,GAAejL,EAAKiL,GAAaoB,QAAO,SAAA6B,GAAU,OAAIA,IAAe7K,KAbtE,QAeLU,EAASH,EAAgBD,EAAQ3D,IAf5B,kDAiBL+D,EAASF,EAAqB,EAAD,KAjBxB,0D+BtHGsK,CAA+BxK,EAAQqK,GAAS,QAG5ChJ,EAtBf,YAAyE,IAAtD3B,EAAqD,EAArDA,OAAQ+K,EAA6C,EAA7CA,QAASN,EAAoC,EAApCA,WAAYC,EAAwB,EAAxBA,sBACzCM,EAAgBP,IAAeM,EAClC,4BAAQjJ,UAAU,eACjBC,QAAS,kBAAM2I,EAAsBK,EAAS/K,KAD/C,QAIA,GACH,OACE,yBAAK8B,UAAU,SACd,kBAAC,GAAD,CAAU9B,OAAQA,IACjBgL,MCAUC,OAZf,YAA2C,IAApBC,EAAmB,EAAnBA,QAASH,EAAU,EAAVA,QAE/B,GAAGG,GAAWpC,OAAOC,OAAOmC,EAAU,GAAI,CACzC,IAAMC,EAAiB,GADkB,uBAExC,IAAI,IAAJ,IAAkBD,EAAlB,+CAA2B,CAAC,IAApBlL,EAAmB,QAC3BmL,EAAenI,KAAK,kBAAC,GAAD,CAAUhD,OAAQA,EAAQiE,IAAKjE,EAAQ+K,QAASA,MAH5B,kFAKzC,OAAOI,EAER,OAAO,sDCmBR,IAWexJ,gBAXS,SAAC,EAAD,OAAEK,EAAF,EAAEA,KAAMI,EAAR,EAAQA,UAAagJ,EAArB,EAAqBA,MAArB,MAAiC,CACxDnO,SAAU+E,EAAK/E,SACfJ,KAAMuF,EAAUlE,aAChBvB,KAAMyF,EAAU9D,MAAM8M,EAAMC,OAAO/K,YAGT,SAAAI,GAAQ,MAAK,CACvC4K,gCADuC,SACPhL,GAC/B,OAAOI,EAASe,EAA8BnB,QAGjCqB,EAnCf,YAA8F,IAAzEmB,EAAwE,EAAxEA,QAASsI,EAA+D,EAA/DA,MAAOnO,EAAwD,EAAxDA,SAAUJ,EAA8C,EAA9CA,KAAMF,EAAwC,EAAxCA,KAAM2O,EAAkC,EAAlCA,gCAS1D,GARAvI,qBAAU,WACN9F,GAAYmO,EAAMC,OAAO/K,OAC3BgL,EAAgCF,EAAMC,OAAO/K,QACnCrD,IAAamO,EAAMC,OAAO/K,QACpCwC,EAAQE,K3BVqB,kB2BUCd,QAAQ,UAAWjF,EAASkF,QAEzD,CAAClF,EAAUqO,EAAiCF,EAAMC,OAAO/K,OAAQwC,IAEjEjG,EACF,OAAQ,wCACF,GAAIF,EAAM,CAChB,IAAM4O,EAASH,EAAMC,OAAO/K,UAAYrD,GAAYA,EAASkF,KAC7D,OACC,6BACEoJ,GAAU,kBAAC,GAAD,MACX,kBAAC,GAAD,CAAcL,QAASvO,EAAKsM,SAAU8B,QAASK,EAAMC,OAAO/K,UAI9D,OAAO,KClBMkL,OANf,WACC,OACC,oDAAyB,kBAAC,EAAD,QCKpB,SAASC,GAAkB9O,GACjC,MAAO,CACNsD,KlCwDiC,sBkCvDjCC,QAAS,CAACvD,SAGL,SAAS+O,GAAgB/O,GAC/B,MAAO,CACNsD,KlCmD+B,oBkClD/BC,QAAS,CAACvD,SASL,SAASgP,GAAsBrL,EAAQsL,GAC7C,OAAO,SAAAlL,GAENA,EnC2IK,SAA6BJ,EAAQuL,EAAaC,GACxD,OAAO,SAAMpL,GAAN,mBAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YACnBC,WE7K4B,SF6KCM,IAAIhB,GACnCI,EApHM,CAACT,KClB6B,2BDmI9B,oBAAAU,EAAA,MAKae,EAAIR,OALjB,cAKCI,EALD,OAOC3E,EAPD,eAQD2E,EAAIE,OARH,GASDqK,GATC,WAAAlL,EAAA,MAWCe,EAAIoG,OAAOnL,IAXZ,OAYL+D,EAASH,EAAgBD,EAAQ3D,IACjCmP,EAAgBnP,GAbX,kDAeL+D,EAASF,EAAqB,EAAD,KAfxB,0DmC5IGuL,CAAoBzL,EAAQsL,GADb,SAAAA,GAAW,OAAIlL,EAASgL,GAAgBE,SAS3D,SAASI,GAAwB1L,EAAQ3D,GAC/C,OAAO,SAAA+D,GAENA,EnC0JK,SAA6BJ,EAAQ3D,EAAMmP,GACjD,OAAO,SAAMpL,GAAN,eAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YAClBC,WEvM2B,SFuMEM,IAAIhB,GACnCI,EA9IK,CAACT,KClB6B,2BD6J9B,oBAAAU,EAAA,MAKEe,EAAIuK,IAAItP,IALV,OAMJ+D,EAASH,EAAgBD,EAAQ3D,IACjCmP,EAAgBnP,GAPZ,gDASJ+D,EAASF,EAAqB,EAAD,KATzB,yDmC3JG0L,CAAoB5L,EAAQ3D,GADb,SAAAA,GAAI,OAAI+D,EAASgL,GAAgB/O,SCb3D,IAcegF,gBAdS,SAAC,EAAD,OAAES,EAAF,EAAEA,UAAWJ,EAAb,EAAaA,KAAMmK,EAAnB,EAAmBA,WAAc7L,EAAjC,EAAiCA,OAAjC,MAA8C,CACrE3D,KAAMyF,EAAU9D,MAAMgC,GACtBsL,YAAaO,EAAWxP,KACxB4O,OAAQvJ,EAAK/E,SAASkF,MAAQ7B,EAC9BzD,KAAMuF,EAAUlE,cAAgBkE,EAAUhE,mBAEhB,SAAAsC,GAAQ,MAAK,CACvC0L,aADuC,SAC1BzP,EAAM2F,GAClB5B,EAAS+K,GAAkB,eACvB9O,EADsB,CAEzB2F,eAIYX,EAvCf,YAA8E,EAAxDrB,OAAyD,IAAjD3D,EAAgD,EAAhDA,KAAMiP,EAA0C,EAA1CA,YAAaL,EAA6B,EAA7BA,OAAQ1O,EAAqB,EAArBA,KAAMuP,EAAe,EAAfA,aAI1D9J,EAAO,GAIX,OAHG3F,GAAQA,EAAK2F,OACfA,EAAO3F,EAAK2F,MAEVzF,EACK,wCACE0O,GACsC,kBAArCK,GAAeA,EAAYtJ,QACpCA,EAAOsJ,EAAYtJ,MAGnB,6BACC,2BACCrC,KAAK,OAAOkG,YAAY,OAAOC,MAAO9D,EAAM+D,SAhBhD,SAAsBrC,GACrBoI,EAAazP,EAAMqH,EAAEI,OAAOgC,YAmBrB,yCAAe9D,MClBT+J,OAJf,WACC,OAAO,qDCkBR,IAce1K,gBAdS,SAAC,EAAD,OAAES,EAAF,EAAEA,UAAWJ,EAAb,EAAaA,KAAMmK,EAAnB,EAAmBA,WAAc7L,EAAjC,EAAiCA,OAAjC,MAA8C,CACrE3D,KAAMyF,EAAU9D,MAAMgC,GACtBsL,YAAaO,EAAWxP,KACxB4O,OAAQvJ,EAAK/E,SAASkF,MAAQ7B,EAC9BzD,KAAMuF,EAAUlE,cAAgBkE,EAAUhE,mBAEhB,SAAAsC,GAAQ,MAAK,CACvC4L,yBADuC,SACdhM,EAAQsL,GAChClL,EAASiL,GAAsBrL,EAAQsL,KAExCW,2BAJuC,SAIZjM,EAAQ3D,GAClC+D,EAASsL,GAAwB1L,EAAQ3D,QAG5BgF,EA7Bf,YAA4H,IAArGrB,EAAoG,EAApGA,OAAoG,IAA5FkM,sBAA4F,SAApEZ,EAAoE,EAApEA,YAAaU,EAAuD,EAAvDA,yBAA0BC,EAA6B,EAA7BA,2BAO7F,OACC,6BACC,4BAAQxK,QARV,WACC,GAAGyK,EACF,OAAOD,EAA2BjM,EAAQsL,GAE3CU,EAAyBhM,EAAQsL,KAIhC,Y,SCXGnI,GAAQ,CACbE,MAAO,QACPgG,OAAQ,SA2BT,IAOehI,gBAPS,SAAC,EAAD,OAAES,EAAF,EAAEA,UAAWJ,EAAb,EAAaA,KAAMmK,EAAnB,EAAmBA,WAAc7L,EAAjC,EAAiCA,OAAjC,MAA8C,CACrE3D,KAAMyF,EAAU9D,MAAMgC,GACtBsL,YAAaO,EAAWxP,KACxB4O,OAAQvJ,EAAK/E,SAASkF,MAAQ7B,EAC9BzD,KAAMuF,EAAUlE,cAAgBkE,EAAUhE,kBAG5BuD,EAtBf,YAAyD,IAAnChF,EAAkC,EAAlCA,KAAMiP,EAA4B,EAA5BA,YAA4B,KAAfL,OAAe,EAAP1O,KAVjD,SAAkCF,EAAMiP,GACvC,OAAGA,GAAkD,kBAA3BA,EAAYvB,WAAgE,kBAA5BuB,EAAYvB,UAC9E,CAAC,CAACuB,EAAYxB,SAAUwB,EAAYvB,WAAY,sBAErD1N,GAAqC,kBAArBA,EAAK0N,WAA0D,kBAArB1N,EAAK0N,UAC1D,CAAC,CAAC1N,EAAKyN,SAAUzN,EAAK0N,WAAY,kBAGnC,CAAC,CAAC,QAAS,SAAU,4CAIFoC,CAAyB9P,EAAMiP,IAFF,oBAEhDc,EAFgD,KAEtCC,EAFsC,KAGvD,OAAQ,kBAAC/C,GAAA,EAAD,CAAKC,OAAQ6C,EAAU5C,KAAM,GAAIrG,MAAOA,GAAOsG,iBAAiB,GACtE,kBAACC,GAAA,EAAD,CACCC,YAAY,0EACZC,IAAI,uDAEL,kBAACT,GAAA,EAAD,CAAQ7F,SAAU8I,GACjB,kBAAChD,GAAA,EAAD,KACEiD,QCtBN,SAASC,GAAwBtN,GAChC,MAAO,CACNW,KvCwDwC,6BuCvDxCC,QAAS,CAACZ,gBAGZ,SAASuN,GAA4BxN,GACpC,MAAO,CACNY,KvCmD6C,kCuClD7CC,QAAS,CAACb,iBCeZ,IAYesC,gBAZS,SAAC,EAAD,OAAES,EAAF,EAAEA,UAAWJ,EAAb,EAAaA,KAAMmK,EAAnB,EAAmBA,WAAc7L,EAAjC,EAAiCA,OAAjC,MAA8C,CACrE3D,KAAMyF,EAAU9D,MAAMgC,GACtBsL,YAAaO,EAAWxP,KACxB4O,OAAQvJ,EAAK/E,SAASkF,MAAQ7B,EAC9BzD,KAAMuF,EAAUlE,cAAgBkE,EAAUhE,mBAEhB,SAAAsC,GAAQ,MAAK,CACvCoM,gBADuC,SACvBzN,GACfqB,EDbK,SAAwCrB,GAC9C,OAAO,SAAMqB,GAAN,mBAAAC,EAAAC,OAAA,uDACAC,EAAS,yEACZkM,UAAU1N,GACbqB,EAASmM,GAA4BxN,IAH/B,oBAAAsB,EAAA,MAKkBqM,MAAMnM,IALxB,cAKCoM,EALD,kBAAAtM,EAAA,MAMqBsM,EAASC,QAN9B,OAMC5N,EAND,OAOLoB,EAASkM,GAAwBtN,IAP5B,kDASLoB,EAhBK,CACNT,KvC8C8C,mCuC7C9CC,QAAS,CAACV,sBAc6B,EAAD,MAThC,0DCYG2N,CAA+B9N,QAI3BsC,EApCf,YAA6E,IAApDhF,EAAmD,EAAnDA,KAAMiP,EAA6C,EAA7CA,YAA2BkB,GAAkB,EAAhCvB,OAAgC,EAAxB1O,KAAwB,EAAlBiQ,iBAAkB,EACnCM,mBAAS,IAD0B,oBACpE/N,EADoE,KACtDgO,EADsD,KAgB3E,OAdAtK,qBAAU,WACuC,kBAAtC6I,GAAeA,EAAYe,OACpCU,EAAgBzB,EAAYe,OACnBhQ,GAAQA,EAAKgQ,OACtBU,EAAgB1Q,EAAKgQ,SAErB,CAACf,EAAajP,IASf,6BACC,2BAAOsD,KAAK,OAAOmG,MAAO/G,EAAcgH,SAR1C,SAA8BrC,GAC7BqJ,EAAgBrJ,EAAEI,OAAOgC,UAQxB,4BAAQnG,KAAK,SAAS8B,QANxB,oBAAApB,EAAAC,OAAA,gDACCkM,EAAgBzN,GADjB,uCAME,cCPH,IAeesC,gBAfS,SAAC,GAAD,MAAmB,CAC1ChF,KADuB,EAAEwP,WACRxP,SAGS,SAAA+D,GAAQ,MAAK,CACvC4M,iBADuC,SACtB3Q,EAAMgQ,EAAOtC,EAAWD,GACxC1J,EAAS+K,GAAkB,eACvB9O,EADsB,CAEzBgQ,QACAtC,YACAD,mBAKYzI,EA7Bf,YAAmE,IAAtC4L,EAAqC,EAArCA,WAAY5Q,EAAyB,EAAzBA,KAAM2Q,EAAmB,EAAnBA,iBAS9C,OACC,wBAAIvL,QATL,WACCuL,EACC3Q,EACA4Q,EAAWC,cACVD,EAAWE,KACXF,EAAWG,OAIkBH,EAAWC,iBCG5C,IAOe7L,gBAPS,SAAC,GAAD,IAAEgM,EAAF,EAAEA,mBAAF,MAA2B,CAClD9Q,KAAM8Q,EAAmB9Q,KACzByC,YAAaqO,EAAmBrO,gBAEN,SAAAoB,GAAQ,MAAK,KAGzBiB,EApBf,YAAmD,IAArB9E,EAAoB,EAApBA,KAAMyC,EAAc,EAAdA,YACnC,OAAGzC,EACK,2CAED,4BAEP,SAA2ByC,GAC1B,OAAOA,EAAY6K,KAAI,SAAAoD,GAAU,OAChC,kBAAC,GAAD,CAAmBtJ,IAAKsJ,EAAWK,SAAUL,WAAYA,OAJ/CM,CAAkBvO,OC2B/B,IASeqC,gBATS,SAAC,GAAD,MAAa,CACpC1E,SADuB,EAAE+E,KACV/E,aAGW,SAAAyD,GAAQ,MAAK,CACvC4K,gCADuC,SACPhL,GAC/BI,EAASe,EAA8BnB,QAG1BqB,EAjCf,YAA0E,IAApDyJ,EAAmD,EAAnDA,MAAOnO,EAA4C,EAA5CA,SAAUqO,EAAkC,EAAlCA,gCAChChL,EAAS8K,EAAMC,OAAOlJ,IAO5B,OANAY,qBAAU,WACN9F,GACFqO,EAAgChL,MAI9BrD,EAIH,6BACC,kBAAC,GAAD,CAAaqD,OAAQA,IACrB,kBAAC,GAAD,CAAeA,OAAQA,IACvB,kBAAC,GAAD,MACA,kBAAC,GAAD,CAAYA,OAAQA,IACpB,kBAAC,GAAD,CAAcA,OAAQA,IACtB,kBAAC,GAAD,OATM,kBAAC,GAAD,SCST,IAceqB,gBAdS,SAAC,GAAD,IAAES,EAAF,EAAEA,UAAWJ,EAAb,EAAaA,KAAMmK,EAAnB,EAAmBA,WAAnB,MAAoC,CAC3D2B,eAAgB9L,EAAK/E,UAAYmF,EAAU9D,MAAM0D,EAAK/E,SAASkF,KAC/DlF,SAAU+E,EAAK/E,SACf2O,YAAaO,EAAWxP,KACxBE,KAAMuF,EAAUlE,cAAgBkE,EAAUhE,mBAEhB,SAAAsC,GAAQ,MAAK,CACvCqN,0BADuC,SACb9Q,GACzB,IAAM+Q,EAAmB,CACxB1L,KAAMrF,EAASsF,aAEhB7B,EAAS+K,GAAkBuC,QAGdrM,EAnCf,YAAoG,IAA7EmB,EAA4E,EAA5EA,QAASgL,EAAmE,EAAnEA,eAAgB7Q,EAAmD,EAAnDA,SAAU2O,EAAyC,EAAzCA,YAAamC,EAA4B,EAA5BA,0BAStE,OARAhL,qBAAU,WACN9F,GAAY6Q,GACdhL,EAAQE,KvCXsB,gBuCWCd,QAAQ,OAAQjF,EAASkF,MAEtDlF,IAAa2O,GACfmC,EAA0B9Q,KAEzB,CAACA,EAAU2O,EAAamC,EAA2BjL,EAASgL,IAC3D7Q,EAIH,6BACC,kBAAC,GAAD,CAAaqD,OAAQrD,EAASkF,MAC9B,kBAAC,GAAD,CAAc7B,OAAQrD,EAASkF,IAAKqK,gBAAgB,KAL9C,kBAAC,GAAD,SCJT,SAASyB,GAA4BC,EAAexP,GACnD,MAAO,CACNuB,K7C+B6C,kC6C9B7CC,QAAS,CAACgO,gBAAexP,UAG3B,SAASyP,GAA2BD,GACnC,MAAO,CACNjO,K7C0B4C,iC6CzB5CC,QAAS,CAACgO,kBAGZ,SAASE,GAA4BF,EAAezP,GACnD,MAAO,CACNwB,K7CqB6C,kC6CpB7CC,QAAS,CAACgO,gBAAezP,4BAG3B,SAAS4P,GAAiBC,EAAQC,GACjC,MAAO,CACNtO,K7CgBiC,sB6CfjCC,QAAS,CAACoO,SAAQC,SAmBb,SAASC,GAAmCN,GAClD,OAAO,SAAMxN,GAAN,mBAAAC,EAAAC,OAAA,uDAEAC,EAAQC,IAASC,YAAYC,W5CtDL,S4CuD5BC,MAAM,iBAAkB,iBAAkBiN,GAC5CxN,EAASyN,GAA2BD,IAJ9B,oBAAAvN,EAAA,MAMuBE,EAAMK,OAN7B,OAMCC,EAND,OAOCzC,EAAQyC,EAAcC,KAAKC,QAAO,SAAC3C,EAAO4C,GAE/C,OADA5C,EAAM4C,EAAIC,IAAMD,EAAIE,OACb9C,IACL,IACHgC,EAASuN,GAA4BC,EAAexP,IAX/C,kDAaLgC,EAAS0N,GAA4BF,EAAD,OAb/B,0DClCR,SAASO,GAAmBC,EAAUC,GACrC,MAAO,CACN1O,K9C+BmC,wB8C9BnCC,QAAS,CAACwO,WAAUC,WActB,SAASC,GAAuBN,EAAQzP,GACvC,MAAO,CACNoB,K9CiBwC,6B8ChBxCC,QAAS,CAACoO,SAAQzP,YAGpB,SAASgQ,GAAsBP,GAC9B,MAAO,CACNrO,K9CYuC,4B8CXvCC,QAAS,CAACoO,WAGZ,SAASQ,GAAuBR,EAAQpP,GACvC,MAAO,CACNe,K9COwC,6B8CNxCC,QAAS,CACRoO,SACApP,uBAIH,SAAS6P,GAAkBL,EAAUC,GACpC,MAAO,CACN1O,K9CDwC,6B8CExCC,QAAS,CACRwO,WACAC,WAoBI,SAASK,GAAsBV,EAAQvD,EAASkE,EAAaC,EAC1DlP,EAAQ2H,EAAUmE,GAC3B,OAAO,SAAMpL,GAAN,iBAAAC,EAAAC,OAAA,uDACA+N,EAAS,CACdL,SACAvD,UACAkE,cACAC,eACAlP,SACAmP,OC7FoC,0BD8FpCxH,WACAyH,KAAM,IAAIC,MAEX3O,EArEM,CACNT,K9C0BmC,0B8C+B7B,oBAAAU,EAAA,MAamBG,IAASC,YAC/BC,W7ChG6B,W6CgGEsO,IAAIX,IAdhC,OAaCY,EAbD,OAeL7O,EAAS+N,GAAmBc,EAAUhO,GAAIoN,IACX,oBAArB7C,GACTA,EAAgByD,EAAUhO,IAjBtB,kDAoBLb,GAA6B,EAAD,GAzEvB,CACNT,K9CsBoC,yB8CrBpCC,QAAS,CAACpD,cAuEA0S,MApBJ,0DA4BD,SAASC,GAAoCnB,GACnD,OAAO,SAAM5N,GAAN,mBAAAC,EAAAC,OAAA,uDACAC,EAAQC,IAASC,YAAYC,W7ChHH,W6CiH9BC,MAAM,SAAS,KAAMqN,GACrBrN,MAAM,SAAU,KAAM,CCtHa,0BACD,2BDsHpCP,EAASmO,GAAsBP,IAJzB,oBAAA3N,EAAA,MAMuBE,EAAMK,OAN7B,OAMCC,EAND,OAOCtC,EAAUsC,EAAcC,KAAKC,QAAO,SAACxC,EAASyC,GAEnD,OADAzC,EAAQyC,EAAIC,IAAMD,EAAIE,OACf3C,IACL,IACH6B,EAASkO,GAAuBN,EAAQzP,IAXnC,kDAaL6B,EAASoO,GAAuBR,EAAD,OAb1B,0DAsBD,SAASoB,GAA+BhB,EAAUC,GACxD,OAAO,SAAMjO,GAAN,eAAAC,EAAAC,OAAA,uDACAc,EAAMZ,IAASC,YAAYC,W7CvID,W6CwI9BM,IAAIoN,GACNhO,EAxEM,CAACT,K9CR+B,6B8C6EhC,oBAAAU,EAAA,MAKCe,EAAIoG,OAAO,CAChBqH,OAAQR,EAAOQ,UANX,OAQLzO,EAASqO,GAAkBL,EAAUC,IARhC,gDAULjO,GAAgC,EAAD,GA5E1B,CAACT,K9CVgC,+B8C4EjC,yDE3FR,IAyCe0B,gBAzCS,SAAC,EAAD,GAAmC,IAAjCK,EAAgC,EAAhCA,KAAM2N,EAA0B,EAA1BA,UAAa5E,EAAa,EAAbA,QACtC6E,EAAsB5N,EAAK/E,UAAY+E,EAAK/E,SAASkF,IAEvD0N,EAAa,KACjB,IAAI,IAAIvB,KAAUqB,EAAUjR,MAAO,CAClC,IAAI6P,EAAOoB,EAAUjR,MAAM4P,GAC3B,GAAGwB,MAAMC,QAAQxB,EAAKyB,iBACjBzB,EAAKyB,eAAenI,QAAQ+H,IAAwB,GACpDrB,EAAKyB,eAAenI,QAAQkD,IAAY,EAAI,CAChD8E,EAAavB,EACb,OAGF,MAAO,CACNsB,sBACA1G,QAASyG,EAAUnR,0BAA0BoR,GAC7CK,UAAWN,EAAUpR,uBAAuBqR,GAC5CC,iBAGyB,SAAAnP,GAAQ,MAAK,CACvCwP,qCADuC,SACFhC,GACpCxN,EAAS8N,GAAmCN,KAE7CiC,0BAJuC,SAIbpF,EAASkE,EAAaC,EAAclP,EAAQ2H,EAAUyI,GHK1E,IAA6BJ,EAAgBlE,EGElDpL,GHFkCsP,EGEL,CAACf,EAAaC,GHFOpD,EGJlD,SAA+BwC,GAI9B5N,EAASsO,GAAsBV,EAAQvD,EAASkE,EAAaC,EAAclP,EAAQ2H,GAHnF,WACCyI,E3CpE0B,iB2CoEIlO,QAAQ,UAAWoM,SHG7C,SAAM5N,GAAN,iBAAAC,EAAAC,OAAA,uDACA2N,EAAO,CAACyB,kBACdtP,EAxCM,CACNT,K7CWiC,wB6C0B3B,oBAAAU,EAAA,MAIiBG,IAASC,YAC7BC,W5C/E2B,S4C+EEsO,IAAIf,IAL9B,OAIC8B,EAJD,OAML3P,EAAS2N,GAAiBgC,EAAQ9O,GAAIgN,IACP,oBAArBzC,GACTA,EAAgBuE,EAAQ9O,IARpB,kDAWLb,EA5CK,CACNT,K7COkC,uB6CNlCC,QAAS,CAACpD,SA0CkB,EAAD,MAXrB,6DGGPwT,mBAbuC,SAapBhC,EAAQvD,EAASkE,EAAaC,EAAclP,EAAQ2H,EAAUyI,GAIhF1P,EAASsO,GAAsBV,EAAQvD,EAASkE,EAAaC,EAAclP,EAAQ2H,GAHnF,WACCyI,E3C5E2B,iB2C4EGlO,QAAQ,UAAWoM,YAMrC3M,EA1Ef,YACwF,IAD/DoJ,EAC8D,EAD9DA,QAAS/K,EACqD,EADrDA,OAAQ4P,EAC6C,EAD7CA,oBAAqB1G,EACwB,EADxBA,QAAS+G,EACe,EADfA,UAAWJ,EACI,EADJA,WAClFK,EAAsF,EAAtFA,qCAAsCC,EAAgD,EAAhDA,0BAA2BG,EAAqB,EAArBA,mBACjEvN,qBAAU,WACLkN,GAAc/G,GACjBgH,EAAqCN,KAIpC,CAACA,EAAqB1G,EAAS+G,EAAWC,IAPyC,MAShD9C,mBAAS,IATuC,oBAS/EmD,EAT+E,KASlEH,EATkE,KAmBtF,OAAIG,EACI,kBAAC,IAAD,CAAUtO,GAAIsO,IACXX,EAEDK,EACF,8CACE/G,GACF,4BAAQnH,QAfhB,WACK8N,EAIHS,EAAmBT,EAAY9E,EAAS6E,EAAqB7E,EAAS/K,GAAQ,EAAOoQ,GAFrFD,EAA0BpF,EAAS6E,EAAqB7E,EAAS/K,GAAQ,EAAOoQ,KAY1E,OAJA,wDC3BT,IAGezO,gBAHS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAF,MAAa,CACpC1B,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,OAEzBR,EAVf,YAAsD,IAAjC3B,EAAgC,EAAhCA,OAAQM,EAAwB,EAAxBA,OAAQyK,EAAgB,EAAhBA,QAASpO,EAAO,EAAPA,KAC7C,OAAG2D,IAAWyK,EACN,sCAAYpO,EAAK2F,KAAjB,IAAuB,4CAExB,sCAAY3F,EAAK2F,KAAjB,IAAuB,kBAAC,GAAD,CAAeyI,QAASA,EAAS/K,OAAQA,QCgBxE,IAqBe2B,gBArBS,SAAC,EAAD,GAA4B,IAA1BS,EAAyB,EAAzBA,UAAapC,EAAY,EAAZA,OAClC1B,EAAQ,GACZ,IAAI,IAAIgC,KAAU8B,EAAU9D,MACxB8D,EAAU9D,MAAMgC,GAAQ2I,UAAY7G,EAAU9D,MAAMgC,GAAQ2I,SAASpB,QAAQ7H,IAAW,IAC1F1B,EAAMgC,GAAU8B,EAAU9D,MAAMgC,IAIlC,MAAO,CACNhC,QACAzB,KAAMuF,EAAUrE,iBAAiBiC,GACjC4G,MAAOxE,EAAUnE,kBAAkB+B,GACnCkJ,QAAS9G,EAAUpE,oBAAoBgC,OAGd,SAAAU,GAAQ,MAAK,CACvCyI,+BADuC,SACRnJ,GAC9BU,EAASD,EAA6BT,QAIzB2B,EAvCf,YAA6F,IAAvE3B,EAAsE,EAAtEA,OAAQ1B,EAA8D,EAA9DA,MAAOzB,EAAuD,EAAvDA,KAAaqM,GAA0C,EAAjDtC,MAAiD,EAA1CsC,SAASC,EAAiC,EAAjCA,+BAC1DpG,qBAAU,WACLlG,GAASqM,GACZC,EAA+BnJ,KAE9B,CAACA,EAAQnD,EAAMqM,EAASC,IAE3B,IAAIgC,EAAiB,GACrB,IAAK,IAAI7K,KAAUhC,EAClB6M,EAAenI,KAAK,kBAAC,GAAD,CACnBhD,OAAQA,EACRrD,KAAM2B,EAAMgC,GACZyK,QAASzK,EACT2D,IAAK3D,KAEP,OAAO6K,KCROqF,OATf,YAA6B,IAATpF,EAAQ,EAARA,MACnB,OACC,6BACC,kBAAC,GAAD,CAAUpL,OAAQoL,EAAMC,OAAOrL,SAC/B,kBAAC,GAAD,CAAYA,OAAQoL,EAAMC,OAAOrL,WCMpC,IASe2B,gBATS,SAAC,GAAY,IAAXK,EAAU,EAAVA,KAEzB,MAAO,CACN1B,OAFc0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,QAKpB,SAAAzB,GAAQ,MAAK,KAGzBiB,EAlBf,YAAwC,IAAxB2M,EAAuB,EAAvBA,OACT9L,GADgC,EAAf+L,KAAe,EAATjO,O/CEA,iB+CDD4B,QAAQ,UAAWoM,IAC/C,OACC,6BACC,kBAAC,IAAD,CAAMrM,GAAIO,GAAO8L,OC6BpB,IAgBe3M,gBAhBS,SAAC,GAAuB,IAAtBK,EAAqB,EAArBA,KAAM2N,EAAe,EAAfA,UACzBrP,EAAS0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IAC9C,MAAO,CACN7B,SACAzD,KAAO8S,EAAUpR,uBAAuB+B,GACxCsG,MAAO+I,EAAUlR,wBAAwB6B,GACzC4I,QAASyG,EAAUnR,0BAA0B8B,GAC7C5B,MAAOiR,EAAUjR,UAGQ,SAAAgC,GAAQ,MAAK,CACvC+P,WADuC,SAC5BnQ,GACVI,EAAS8N,GAAmClO,QAI/BqB,EAjDf,YAAuF,EAAlEmB,QAAkE,EAAzDsI,MAA0D,IAAnD9K,EAAkD,EAAlDA,OAAQzD,EAA0C,EAA1CA,KAAM+J,EAAoC,EAApCA,MAAOsC,EAA6B,EAA7BA,QAASxK,EAAoB,EAApBA,MAAO+R,EAAa,EAAbA,WAMzE,OALA1N,qBAAU,YACNzC,GAAWzD,GAAS+J,GAAUsC,GAChCuH,EAAWnQ,MAGVsG,EACK,6BAAMA,EAAMwC,YAEjBvM,EACK,wCAKT,SAAqB6T,GACpB,IAAIC,EAAgB,GACpB,IAAK,IAAIrC,KAAUoC,EAClBC,EAAc3N,KAAK,kBAAC,GAAD,CAAMiB,IAAKqK,EAAQA,OAAQA,EAAQC,KAAMmC,EAAUpC,MAEvE,OAAOqC,EAPAC,CASR,SAAkClS,EAAO4B,GACxC,IAAIuQ,EAAgB,GACpB,IAAI,IAAIvC,KAAU5P,EACbA,EAAM4P,IACNwB,MAAMC,QAAQrR,EAAM4P,GAAQ0B,iBAC3BtR,EAAM4P,GAAQ0B,eAAenI,QAAQvH,IAAW,IACpDuQ,EAAcvC,GAAU5P,EAAM4P,IAGhC,OAAOuC,EAnBWC,CAAyBpS,EAAO4B,OCJnD,SAASyQ,GAAkBpR,GAC1B,MAAO,CACNM,KtDyDiC,sBsDxDjCC,QAAS,CACRP,aAiBH,SAASqR,GAAmBC,EAAmBC,GAC9C,MAAO,CACNjR,KtDuCkC,uBsDtClCC,QAAS,CACR+Q,oBACAC,mBCxBH,IAKevP,gBALS,SAAC,GAAD,EAAE6H,UAAF,MAAkB,MAEf,SAAA9I,GAAQ,MAAK,KAGzBiB,EAhBf,YAA8B,IAAXwP,EAAU,EAAVA,QAClB,OACC,6BAAMA,EAAQC,KAAd,IAGF,SAAuBD,GACtB,GAAGA,EAAQE,WACV,OAAOC,OAAOC,aAAa,MAE5B,OAAOD,OAAOC,aAAa,OAPLC,CAAcL,OCGrC,IAMexP,gBANS,SAAC,GAAD,MAAqB,CAC5ChC,SADuB,EAAE8R,aACF9R,aAEG,SAAAe,GAAQ,MAAK,KAGzBiB,EAXf,YACC,OADyC,EAAnB2M,OAAmB,EAAX3O,SACdwK,KAAI,SAAAgH,GAAO,OAC1B,kBAAC,GAAD,CAASlN,IAAKkN,EAAQ5P,GAAI4P,QAASA,UCYrC,IASexP,gBATS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAF,MAAa,CACpC1B,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,QAEb,SAAAzB,GAAQ,MAAK,CACvCgR,cADuC,SACzBN,EAAM9C,EAAQqD,GAC3BjR,EH8EK,SAAwC4N,EAAQ8C,EAAMO,GAC5D,OAAO,SAAMjR,GAAN,iBAAAC,EAAAC,OAAA,uDACAgR,EAAa9Q,IAASC,YAAYC,WrDjGP,YqDiGwCM,MACnE6P,EAAU,CACf7C,SACA8C,OACAO,WACAE,SAAU/Q,IAASC,UAAUgH,WAAW+J,kBACxCC,WAAYjR,IAASC,UAAUgH,WAAW+J,mBAPrC,oBAAAnR,EAAA,MAUCiR,EAAW3F,IAAIkF,IAVhB,OAWLzQ,EArEK,CACNT,KtD+B0C,+BsD9B1CC,QAAS,CACR8R,mBAkEmCJ,EAAWrQ,MAXzC,sDAaLb,EAASsQ,GAAmBY,EAAWrQ,GAAZ,aAC1BA,GAAIqQ,EAAWrQ,IACZ4P,EAFuB,CAG1Bc,UAAS,SAhBL,8DG/EGC,CAA+Bd,EAAM9C,EAAQqD,QAIzChQ,EAvBf,YAAyD,IAAjC2M,EAAgC,EAAhCA,OAAQhO,EAAwB,EAAxBA,OAAQoR,EAAgB,EAAhBA,cACjCS,EAAUC,mBAKhB,OACC,6BACC,2BAAOnS,KAAK,OAAOyB,IAAKyQ,EAAShM,YAAY,2BAC7C,4BAAQlG,KAAK,SAAS8B,QAPxB,WACC2P,EAAcpD,EAAQ6D,EAAQE,QAAQjM,MAAO9F,GAC7C6R,EAAQE,QAAQjM,MAAM,KAKrB,YCoBH,IAkBezE,gBAlBS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAF,MAAa,CACpC1B,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,QAEb,SAAAzB,GAAQ,MAAK,CACvC4R,qBADuC,SAClBhE,GACpB5N,EAAS+O,GAAoCnB,KAE9CiE,uBAJuC,SAIhBjE,GACtB5N,EJgCK,SAAkC4N,GACxC,OAAO,SAAM5N,GAAN,mBAAAC,EAAAC,OAAA,uDACAC,EAAQC,IAASC,YAAYC,WrDrEF,YqDsE/BC,MAAM,SAAS,KAAMqN,GACrBkE,QAAQ,YACRC,MAAM,KACR/R,EAzDM,CACNT,KtDkDsC,6BsDChC,oBAAAU,EAAA,MAOwBE,EAAMK,OAP9B,OAOCwR,EAPD,OAQC/S,EAAW+S,EAActR,KAAK+I,KAAI,SAAA7I,GAAG,sBACvCA,EAAIE,OADmC,CAE1CD,GAAID,EAAIC,GACR8P,WAAY/P,EAAIqR,SAASC,sBAE1BlS,EAASqQ,GAAkBpR,IAbtB,wDAeLe,EA9DK,CACNT,KtD8CuC,4BsD7CvCC,QAAS,CACRuH,WA2DgC,EAAD,MAf1B,+DIjCGoL,CAAyBvE,KAEnCwE,oBAPuC,SAOnBxE,GACnB5N,EJsFK,SAAsC4N,GAC5C,OAAO,SAAA5N,GACN,IAGMZ,EAHQgB,IAASC,YAAYC,WrD9HF,YqD+H9BC,MAAM,SAAU,KAAMqN,GACtBrN,MAAM,aAAc,IAAK,IAAIoO,MACE0D,YAChC,SAAA5R,GACCA,EAAc6R,aAAaC,SAAQ,SAAAC,GAClCxS,EAASsQ,GACPkC,EAAO5R,IAAIC,GADc,aAGxBA,GAAI2R,EAAO5R,IAAIC,IACZ2R,EAAO5R,IAAIE,OAJU,CAKxB6P,WAAY6B,EAAO5R,IAAIqR,SAASC,2BAMrC,SAAAO,GACC,MAAMA,KAGTzS,EAtGF,SAA+BZ,GAC9B,MAAO,CACNG,KtDwBuC,4BsDvBvCC,QAAS,CACRJ,wBAkGQsT,CAAsBtT,KI7GtBuT,CAA6B/E,KAEvCgF,sBAVuC,WJuBjC,IAAiCxT,EIZtCY,GJaDZ,IACO,CACNG,KtDeuC,4BsDdvCC,QAAS,CACRJ,oBAAqB,aIbT6B,EArCf,YAAwG,IAApFyJ,EAAmF,EAAnFA,MAAO9K,EAA4E,EAA5EA,OAAQgS,EAAoE,EAApEA,qBAAsBC,EAA8C,EAA9CA,uBAAwBO,EAAsB,EAAtBA,oBAQhF,GAPA/P,qBAAU,WACNzC,GAAU8K,EAAMC,OAAOiD,SACzBgE,EAAqBlH,EAAMC,OAAOiD,QAClCiE,EAAuBnH,EAAMC,OAAOiD,QACpCwE,EAAoB1H,EAAMC,OAAOiD,WAEhC,CAAChO,EAAQ8K,EAAMC,OAAOiD,OAAQgE,EAAsBC,EAAwBO,KAC3ExS,EACH,OAAO,kBAAC,GAAD,MAER,IAAMkC,ErDjBuB,iBqDiBDN,QAAQ,UAAWkJ,EAAMC,OAAOiD,QAC5D,OAAQ,6BACP,kBAAC,IAAD,CAAMrM,GAAIO,GAAV,QACA,kBAAC,GAAD,CAAa8L,OAAQlD,EAAMC,OAAOiD,SAClC,kBAAC,GAAD,CAAcA,OAAQlD,EAAMC,OAAOiD,aCHrC,IAOe3M,gBAPS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAMsF,EAAR,EAAQA,UAAR,MAAwB,CAC/ChH,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IACvCzE,MAAO4J,EAAU5J,UAES,SAAAgD,GAAQ,MAAK,KAGzBiB,EA1Bf,YAA0D,IAAnC4R,EAAkC,EAAlCA,iBAAkB7V,EAAgB,EAAhBA,MAAO4C,EAAS,EAATA,OAC/C,OAAO,gDAER,SAAoBkT,EAAc9V,EAAO4C,EAAQmT,GAChD,OAAOD,EAAanS,QAAO,SAACqS,EAAS/E,GACpC,GAAGA,EAAOQ,SAAWsE,EACpB,OAAOC,EAIR,IAAMC,GAAcjW,EAAMiR,EAAO3O,QAAQ4T,cACzC,OAAGtT,IAAWqO,EAAO5D,QACb2I,EAAUC,EAEXD,EAAUC,IAEf,GAf0BE,CAAWN,EAAkB7V,EAAO4C,EZN5B,8BaoBtC,IAkBeqB,gBAlBS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAF,MAAa,CACpC1B,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,QAEb,SAACzB,EAAD,OAAYgO,EAAZ,EAAYA,SAAUC,EAAtB,EAAsBA,OAAtB,MAAmC,CAC7DmF,aAD6D,WAE5DpT,EAASgP,GAA+BhB,EAAD,eACnCC,EADmC,CAEtCQ,Ob3BmC,8Ba8BrC4E,aAP6D,WAQ5DrT,EAASgP,GAA+BhB,EAAD,eACnCC,EADmC,CAEtCQ,ObhCmC,iCaqCvBxN,EA/Bf,YAAyE,EAAvD+M,SAAwD,IAA9CC,EAA6C,EAA7CA,OAAQrO,EAAqC,EAArCA,OAAQwT,EAA6B,EAA7BA,aAAcC,EAAe,EAAfA,aACzD,OACC,6BACC,kBAAC,GAAD,CAAU/T,OAAQ2O,EAAO3O,SAEtB2O,EAAOO,eAAiB5O,GbZQ,2BaYGqO,EAAOQ,QACxC,4BAAQpN,QAAS+R,GAAjB,UAEL,4BAAQ/R,QAASgS,GAAjB,cCFH,IAcepS,gBAdS,SAAC,EAAD,GAA8B,IAA5BqS,EAA2B,EAA3BA,YAAe1F,EAAY,EAAZA,OACpC2F,EAAc,GAClB,IAAI,IAAIvF,KAAYsF,EAAYnV,QAC5ByP,GAAU0F,EAAYnV,QAAQ6P,IAC7BsF,EAAYnV,QAAQ6P,GAAUJ,SAAWA,IAC5C2F,EAAYvF,GAAYsF,EAAYnV,QAAQ6P,IAI9C,MAAO,CACNuF,iBAIatS,EAxBf,YAAsC,IAAfsS,EAAc,EAAdA,YAClBC,EAAkB,GACtB,IAAK,IAAIxF,KAAYuF,EAAa,CACjC,IAAME,EAAiB,kBAAC,GAAD,CAAQlQ,IAAKyK,EAC5BA,SAAUA,EACVC,OAAQsF,EAAYvF,KAC5BwF,EAAgBlR,KAAKmR,GAEtB,OAAOD,KCwBR,IA4BevS,gBA5BS,SAAC,EAAD,GAAyC,IAAvCqS,EAAsC,EAAtCA,YAAa1M,EAAyB,EAAzBA,UAAagH,EAAY,EAAZA,OAC7CiF,EAAmBzK,OAAOC,OAAOiL,EAAYnV,SAASmK,QAAO,SAAA2F,GAAM,OAAIA,EAAOL,OAASA,KACvF8F,EAAmBb,EAAiBlS,QAAO,SAAC+S,EAAkBzF,GACnE,OAAGrH,EAAU7J,eAAekR,EAAO3O,QAC5B,GAAN,mBAAWoU,GAAX,CAA6B9M,EAAU7J,eAAekR,EAAO3O,UAEvDoU,IACL,IACGC,EAAiBd,EAAiBe,OAAM,SAAA3F,GAAM,OAAIrH,EAAU9J,iBAAiBmR,EAAO3O,WACpFuU,EAAchB,EAAiBnL,MAAK,SAAAuG,GAAM,OAAIrH,EAAU/J,cAAcoR,EAAO3O,WAC7EwU,EAAsBjB,EAAiBe,OAAM,SAAA3F,GAAM,OAAIrH,EAAU5J,MAAMiR,EAAO3O,WAEpF,MAAO,CACNuT,mBACA7V,MAAO4J,EAAU5J,MACjBH,cAAe+J,EAAU/J,cACzB6W,mBACAC,iBACAE,cACAC,0BAGyB,SAAA9T,GAAQ,MAAK,CACvC+T,WADuC,SAC5BvJ,EAASxN,EAAOH,GAC1BmD,EnDRM,SAA2CwK,EAASxN,EAAOH,GACjE,OAAO,SAAMmD,GAAN,SAAAC,EAAAC,OAAA,gDAENsK,EAAQ+H,SAAQ,SAAAjT,GACXzC,EAAcyC,IAAYtC,EAAMsC,IACnCU,EAAS6E,GAA0BvF,OAJ/B,sCmDOE0U,CAAkCxJ,EAASxN,EAAOH,QAI9CoE,EA3Df,YAUI,IATH2M,EASE,EATFA,OACAiF,EAQE,EARFA,iBACA7V,EAOE,EAPFA,MACAH,EAME,EANFA,cACA6W,EAKE,EALFA,iBACAC,EAIE,EAJFA,eACAE,EAGE,EAHFA,YACAC,EAEE,EAFFA,oBACAC,EACE,EADFA,WAMA,OAJA1R,qBAAU,WACT,IAAMmI,EAAUqI,EAAiBpJ,KAAI,SAAAwE,GAAM,OAAIA,EAAO3O,UACtDyU,EAAWvJ,EAASxN,EAAOH,MAEzBgX,IAAgBF,EACX,wCAEJG,EAOI,6BACP,kBAAC,GAAD,CAAalG,OAAQA,IACrB,kBAAC,GAAD,CAAaiF,iBAAkBA,KAPvB,oDAEP,6BAAMoB,KAAKC,UAAUR,QCAxB,IAUezS,gBAVS,SAAC,GAAD,IAAEK,EAAF,EAAEA,KAAMgS,EAAR,EAAQA,YAAR,MAA0B,CACjD1T,OAAQ0B,EAAK/E,UAAY+E,EAAK/E,SAASkF,IACvCnD,kBAAmBgV,EAAYhV,sBAEL,SAAA0B,GAAQ,MAAK,CACvC4R,qBADuC,SAClBhE,GACpB5N,EAAS+O,GAAoCnB,QAIhC3M,EA3Bf,YAA8E,IAA1DyJ,EAAyD,EAAzDA,MAAO9K,EAAkD,EAAlDA,OAAQtB,EAA0C,EAA1CA,kBAAmBsT,EAAuB,EAAvBA,qBAC/ChE,EAASlD,EAAMC,OAAOiD,OAO5B,OANAvL,qBAAU,WACNzC,GAAU8K,EAAMC,OAAOiD,QACzBgE,EAAqBlH,EAAMC,OAAOiD,UAEjC,CAAChO,EAAQ8K,EAAMC,OAAOiD,OAAQgE,IAE7BhS,GAG6B,IAA9BtB,EAAkBsP,GACb,wCAED,kBAAC,GAAD,CAAMA,OAAQA,IALb,kBAAC,GAAD,SClBM,SAASuG,KACvB,OAAO,8CC8CR,IAAMC,GAAcC,0BAAgB,CAChCnM,U7EvCW,WAAyC,IAA/BL,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACtD,OAAOA,EAAO/U,MACb,IYImC,wBZJP,OAAO,eAC/BsI,EADwB,CAE3B3L,YAAY,EACZD,KAAMqY,EAAO9U,QAAQvD,OAEtB,IYAmC,wBZAP,OAAO,eAC/B4L,EADwB,CAE3B3L,YAAY,EACZD,KAAM,OAEP,QAAS,OAAO4L,I6E4BdvG,K5EhCW,WAAyC,IAA/BuG,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACnD,OAAOA,EAAO/U,MAChB,IWpB6B,kBXoBP,OAAO,eAChBsI,EADS,CAEZxL,gBAAgB,IAEpB,IWvBuB,kBXuBD,OAAO,eACtBwL,EADe,CAElBxL,gBAAgB,IAE1B,IW1B4B,iBX0BP,OAAO,eACfwL,EADQ,CAEXvL,YAAY,IAEhB,IW7BkB,aX6BD,OAAO,eAC1BuL,EADmB,CAEtBxL,gBAAgB,EAChBE,SAAU+X,EAAO9U,QAAQjD,WAEpB,IWjCmB,cXiCD,OAAO,eAC3BsL,EADoB,CAEvBtL,SAAU,KACVJ,MAAM,IAEP,IWrC6B,mBXqCN,OAAO,eAC1B0L,EADmB,CAEtB1L,MAAM,EACNK,YAAa,KAEd,IWzC+B,oBXyCP,OAAO,eAC3BqL,EADoB,CAEvBrL,YAAa8X,EAAO9U,QAAQhD,cAEvB,QAAS,OAAOqL,I4EApB5C,W3EpCW,WAAwC,IAA/B4C,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IUMuC,4BVNP,OAAO,eACnCsI,EAD4B,CAE/BpL,aAAc6X,EAAO9U,QAAQ/C,eAE9B,IUG+B,oBVHP,OAAIoL,EAAMlL,iBAAmB2X,EAAO9U,QAAQ7C,eAE5D,eACHkL,EADJ,CAEClL,eAAgB,OAIVkL,EAER,IUNoC,yBVMP,OAAO,eAChCA,EADyB,CAE5BnL,UAAW4X,EAAO9U,QAAQ9C,UAC1BC,eAAgB2X,EAAO9U,QAAQ7C,eAC/BC,gBAAiB,KAElB,IUXqC,0BVWP,OAAGiL,EAAMlL,iBAAmB2X,EAAO9U,QAAQ7C,eACjE,eACHkL,EADJ,CAEClL,eAAgB,KAChBK,MAAO,GACPJ,gBAAiB0X,EAAO9U,QAAQ5C,kBAI1BiL,EAER,IUrBsC,2BVqBP,OAAO,eAClCA,EAD2B,CAE9BlL,eAAgB,OAEjB,QAAS,OAAOkL,I2EAdjB,U1EvCW,WAAwC,IAA/BiB,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,ISIoC,yBTJP,OAAO,eAChCsI,EADyB,CAE5BhL,cAAc,eACVgL,EAAMhL,cADG,eAEXyX,EAAO9U,QAAQF,QAAS,IAE1BxC,iBAAiB,eACb+K,EAAM/K,iBADM,eAEdwX,EAAO9U,QAAQF,QAAS,IAE1BtC,MAAM,eACF6K,EAAM7K,MADL,eAEHsX,EAAO9U,QAAQF,OAASgV,EAAO9U,QAAQmF,SAG1C,ISVmC,wBTUP,OAAO,eAC/BkD,EADwB,CAE3BhL,cAAc,eACVgL,EAAMhL,cADG,eAEXyX,EAAO9U,QAAQF,QAAS,IAE1BxC,iBAAiB,eACb+K,EAAM/K,iBADM,eAEdwX,EAAO9U,QAAQF,QAAS,IAE1BvC,eAAe,eACX8K,EAAM9K,eADI,eAEZuX,EAAO9U,QAAQF,OAAS,SAG3B,ISxBoC,yBTwBP,OAAO,eAChCuI,EADyB,CAE5BhL,cAAc,eACVgL,EAAMhL,cADG,eAEXyX,EAAO9U,QAAQF,QAAS,IAE1BxC,iBAAiB,eACb+K,EAAM/K,iBADM,eAEdwX,EAAO9U,QAAQF,QAAS,IAE1BvC,eAAe,eACX8K,EAAM9K,eADI,eAEZuX,EAAO9U,QAAQF,OAASgV,EAAO9U,QAAQ+U,kBAG1C,QAAS,OAAO1M,I0EPd2M,YzExCW,WAAwC,IAA/B3M,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IQcgC,qBRX/B,IAAIkV,EAAiB,GACrB,IAAI,IAAIxK,KAAWpC,EAAM1K,OACrB0K,EAAM1K,OAAO8M,GAAS3K,SAAWgV,EAAO9U,QAAQF,SAClDmV,EAAexK,GAAWpC,EAAM1K,OAAO8M,IAGzC,OAAO,eACHpC,EADJ,CAEC5K,kBAAkB,eACd4K,EAAM5K,kBADO,eAEfqX,EAAO9U,QAAQF,QAAS,IAE1BpC,qBAAqB,eACjB2K,EAAM3K,qBADU,eAElBoX,EAAO9U,QAAQF,QAAS,IAE1BnC,OAAO,eACHsX,EADE,GAEFH,EAAO9U,QAAQkV,eAIrB,IQV+B,oBRUP,OAAO,eAC3B7M,EADoB,CAEvB5K,kBAAkB,eACd4K,EAAM5K,kBADO,eAEfqX,EAAO9U,QAAQF,QAAS,IAE1BpC,qBAAqB,eACjB2K,EAAM3K,qBADU,eAElBoX,EAAO9U,QAAQF,QAAS,IAE1BlC,kBAAkB,eACdyK,EAAMzK,kBADO,eAEfkX,EAAO9U,QAAQF,OAAS,OAG3B,IQxBgC,qBRwBP,OAAO,eAC5BuI,EADqB,CAExB5K,kBAAkB,eACd4K,EAAM5K,kBADO,eAEfqX,EAAO9U,QAAQF,QAAS,IAE1BpC,qBAAqB,eACjB2K,EAAM3K,qBADU,eAElBoX,EAAO9U,QAAQF,QAAS,IAE1BlC,kBAAkB,eACdyK,EAAMzK,kBADO,eAEfkX,EAAO9U,QAAQF,OAASgV,EAAO9U,QAAQmV,qBAG1C,QAAS,OAAO9M,IyEhBdnG,UxE/BW,WAAwC,IAA/BmG,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IOQuC,4BPRP,OAAO,eACnCsI,EAD4B,CAE/BxK,iBAAiB,eACbwK,EAAMxK,iBADM,eAEdiX,EAAO9U,QAAQF,QAAS,IAE1BhC,oBAAoB,eAChBuK,EAAMvK,oBADS,eAEjBgX,EAAO9U,QAAQF,QAAS,IAE1B1B,MAAM,eACFiK,EAAMjK,MADL,GAED0W,EAAO9U,QAAQ5B,SAGpB,IONsC,2BPMP,OAAO,eAClCiK,EAD2B,CAE9BxK,iBAAiB,eACbwK,EAAMxK,iBADM,eAEdiX,EAAO9U,QAAQF,QAAS,IAE1BhC,oBAAoB,eAChBuK,EAAMvK,oBADS,eAEjBgX,EAAO9U,QAAQF,QAAS,IAE1B/B,kBAAkB,eACdsK,EAAMtK,kBADO,eAEf+W,EAAO9U,QAAQF,OAAS,SAG3B,IOpBuC,4BPoBP,OAAO,eACnCuI,EAD4B,CAE/BxK,iBAAiB,eACbwK,EAAMxK,iBADM,eAEdiX,EAAO9U,QAAQF,QAAS,IAE1BhC,oBAAoB,eAChBuK,EAAMvK,oBADS,eAEjBgX,EAAO9U,QAAQF,QAAS,IAE1B/B,kBAAkB,eACdsK,EAAMtK,kBADO,eAEf+W,EAAO9U,QAAQF,OAASgV,EAAO9U,QAAQjC,sBAG1C,IOlCoC,yBPkCP,OAAO,eAChCsK,EADyB,CAE5BrK,cAAc,EACdI,MAAM,eACFiK,EAAMjK,MADL,eAEH0W,EAAO9U,QAAQI,OAAQ0U,EAAO9U,QAAQvD,SAGzC,IOzCmC,wBPyCP,OAAO,eAC/B4L,EADwB,CAE3BrK,cAAc,EACdC,cAAe,OAEhB,IO7CoC,yBP6CP,OAAO,eAChCoK,EADyB,CAE5BrK,cAAc,EACdC,cAAe6W,EAAO9U,QAAQ/B,gBAE/B,IOjD+B,oBPiDP,OAAO,eAC3BoK,EADoB,CAEvBnK,gBAAgB,EAChBE,MAAM,eACFiK,EAAMjK,MADL,eAEH0W,EAAO9U,QAAQI,OAAS0U,EAAO9U,QAAQvD,SAG1C,IOxDoC,yBPwDP,OAAO,eAChC4L,EADyB,CAE5BnK,gBAAgB,EAChBC,iBAAiB,IAElB,IO5DqC,0BP4DP,OAAO,eACjCkK,EAD0B,CAE7BnK,gBAAgB,EAChBC,gBAAiB2W,EAAO9U,QAAQ7B,kBAEjC,QAAS,OAAOkK,IwEnDdoH,UvErCW,WAAwC,IAA/BpH,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IM2B6C,kCN3BP,OAAO,eACzCsI,EADkC,CAErChK,uBAAuB,eACnBgK,EAAMhK,uBADY,eAEpByW,EAAO9U,QAAQgO,eAAgB,IAEjC1P,0BAA0B,eACtB+J,EAAM/J,0BADe,eAEvBwW,EAAO9U,QAAQgO,eAAgB,IAEjCxP,MAAM,eACF6J,EAAM7J,MADL,GAEDsW,EAAO9U,QAAQxB,SAGpB,IMa4C,iCNbP,OAAO,eACxC6J,EADiC,CAEpChK,uBAAuB,eACnBgK,EAAMhK,uBADY,eAEpByW,EAAO9U,QAAQgO,eAAgB,IAEjC1P,0BAA0B,eACtB+J,EAAM/J,0BADe,eAEvBwW,EAAO9U,QAAQgO,eAAgB,IAEjCzP,wBAAwB,eACpB8J,EAAM9J,wBADa,eAErBuW,EAAO9U,QAAQgO,cAAgB,SAGlC,IMD6C,kCNCP,OAAO,eACzC3F,EADkC,CAErChK,uBAAuB,eACnBgK,EAAMhK,uBADY,eAEpByW,EAAO9U,QAAQgO,eAAgB,IAEjC1P,0BAA0B,eACtB+J,EAAM/J,0BADe,eAEvBwW,EAAO9U,QAAQgO,eAAgB,IAEjCzP,wBAAwB,eACpB8J,EAAM9J,wBADa,eAErBuW,EAAO9U,QAAQgO,cAAgB8G,EAAO9U,QAAQzB,4BAGjD,IMfiC,sBNeP,OAAO,eAC7B8J,EADsB,CAEzB7J,MAAM,eACF6J,EAAM7J,MADL,eAEHsW,EAAO9U,QAAQoO,OAAS0G,EAAO9U,QAAQqO,OAEzC5P,aAAa,IAEd,IMtBiC,sBNsBP,OAAO,eAC7B4J,EADsB,CAEzB5J,aAAa,EACbC,aAAc,OAEf,IM1BkC,uBN0BP,OAAO,eAC9B2J,EADuB,CAE1B5J,aAAa,EACbC,aAAcoW,EAAO9U,QAAQpD,WAE9B,QAAS,OAAOyL,IuE3BdyL,YtEjCW,WAAwC,IAA/BzL,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IK6BmC,wBL7BP,OAAO,eAC/BsI,EADwB,CAE3B1J,QAAQ,eACJ0J,EAAM1J,QADH,eAELmW,EAAO9U,QAAQwO,SAAWsG,EAAO9U,QAAQyO,SAE3C7P,eAAe,IAEhB,IKsBmC,wBLtBP,OAAO,eAC/ByJ,EADwB,CAE3BzJ,eAAe,EACfC,eAAgB,OAEjB,IKkBoC,yBLlBP,OAAO,eAChCwJ,EADyB,CAE5BzJ,eAAe,EACfC,eAAgBiW,EAAO9U,QAAQpD,WAEhC,IKcwC,6BLdP,OAAO,eACpCyL,EAD6B,CAEhC1J,QAAQ,eACJ0J,EAAM1J,QADH,GAEHmW,EAAO9U,QAAQrB,SAEnBG,kBAAkB,eACduJ,EAAMvJ,kBADO,eAEfgW,EAAO9U,QAAQoO,QAAS,IAE1BrP,qBAAqB,eACjBsJ,EAAMtJ,qBADU,eAElB+V,EAAO9U,QAAQoO,QAAS,MAG3B,IKAuC,4BLAP,OAAO,eACnC/F,EAD4B,CAE/BvJ,kBAAkB,eACduJ,EAAMvJ,kBADO,eAEfgW,EAAO9U,QAAQoO,QAAS,IAE1BrP,qBAAqB,eACjBsJ,EAAMtJ,qBADU,eAElB+V,EAAO9U,QAAQoO,QAAS,IAE1BpP,mBAAmB,eACfqJ,EAAMrJ,mBADQ,eAEhB8V,EAAO9U,QAAQoO,OAAS,SAG3B,IKdwC,6BLcP,OAAO,eACpC/F,EAD6B,CAEhCvJ,kBAAkB,eACduJ,EAAMvJ,kBADO,eAEfgW,EAAO9U,QAAQoO,QAAS,IAE1BrP,qBAAqB,eACjBsJ,EAAMtJ,qBADU,eAElB+V,EAAO9U,QAAQoO,QAAS,IAE1BpP,mBAAmB,eACfqJ,EAAMrJ,mBADQ,eAEhB8V,EAAO9U,QAAQoO,OAAS0G,EAAO9U,QAAQhB,uBAG1C,IK5BwC,6BL4BP,OAAO,eACpCqJ,EAD6B,CAEhC1J,QAAQ,eACJ0J,EAAM1J,QADH,eAELmW,EAAO9U,QAAQwO,SAAWsG,EAAO9U,QAAQyO,SAE3CxP,mBAAmB,IAEpB,IKnCsC,2BLmCP,OAAO,eAClCoJ,EAD2B,CAE9BpJ,mBAAmB,EACnBC,mBAAoB,OAErB,IKvCuC,4BLuCP,OAAO,eACnCmJ,EAD4B,CAE/BpJ,mBAAmB,EACnBC,mBAAoB4V,EAAO9U,QAAQiT,cAEpC,QAAS,OAAO5K,IsEjDdoF,mBrE3CW,WAAwC,IAA/BpF,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IIgDwC,6BJhDP,OAAO,eACpCsI,EAD6B,CAEhCjJ,YAAa0V,EAAO9U,QAAQZ,YAC5BC,sBAAsB,EACtBE,oBAAoB,IAErB,II2C6C,kCJ3CP,OAAO,eACzC8I,EADkC,CAErClJ,aAAc2V,EAAO9U,QAAQb,aAC7BE,sBAAsB,EACtBE,oBAAoB,IAGrB,IIqC8C,mCJrCP,OAAO,eAC1C8I,EADmC,CAEtChJ,sBAAsB,EACtBE,oBAAoB,EACpBD,sBAAuBwV,EAAO9U,QAAQV,wBAEvC,QAAS,OAAO+I,IqEuBd4D,WpE5CW,WAAyC,IAA/B5D,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACtD,OAAOA,EAAO/U,MACb,IGoDiC,sBHpDP,OAAO,eAC7BsI,EADsB,CAEzB5L,KAAMqY,EAAO9U,QAAQvD,KACrB+C,SAAS,IAEV,IGgD+B,oBHhDP,OAAO,eAC3B6I,EADoB,CAEvB5L,KAAMqY,EAAO9U,QAAQvD,KACrB+C,SAAS,IAEV,QAAS,OAAO6I,IoEiCdkJ,anE3CW,WAAwC,IAA/BlJ,EAA8B,uDAAtB7L,EAAcsY,EAAQ,uCACrD,OAAOA,EAAO/U,MACb,IEqDiC,sBFrDP,OAAO,eAC7BsI,EADsB,CAEzB5I,SAAUqV,EAAO9U,QAAQP,SACzBC,mBAAmB,IAEpB,IEiDsC,2BFjDP,OAAO,eAClC2I,EAD2B,CAE9B3I,mBAAmB,EACnBC,mBAAoB,OAErB,IE6CuC,4BF7CP,OAAO,eACnC0I,EAD4B,CAE/B3I,mBAAmB,EACnBC,mBAAoBmV,EAAO9U,QAAQuH,aAEpC,IEyCkC,uBFxCjC,IAAM6N,EAAgBN,EAAO9U,QAAQ+Q,kBAClC1I,EAAM5I,SAAS4V,WAAU,SAAApE,GAAO,OAAIA,EAAQ5P,KAAOyT,EAAO9U,QAAQ+Q,sBACjE,EACJ,OAAGqE,GAAgB,EACX,eACH/M,EADJ,CAEC5I,SAAS,GAAD,mBACJ4I,EAAM5I,SAAS6V,MAAM,EAAGF,IADpB,CAEPN,EAAO9U,QAAQgR,gBAFR,YAGJ3I,EAAM5I,SAAS6V,MAAMF,EAAe,OAInC,eACH/M,EADJ,CAEC5I,SAAS,GAAD,mBACJ4I,EAAM5I,UADF,CAEPqV,EAAO9U,QAAQgR,mBAIlB,IEoB0C,+BFpBP,OAAO,eACtC3I,EAD+B,CAElC5I,SAAU4I,EAAM5I,SAASwK,KAAI,SAAAgH,GAC5B,OAAGA,EAAQ5P,KAAOyT,EAAO9U,QAAQ8R,mBACzB,eACHb,EADJ,CAECE,YAAY,IAGPF,OAGT,IESuC,4BFTP,OAAO,eACnC5I,EAD4B,CAE/BzI,oBAAqBkV,EAAO9U,QAAQJ,sBAErC,QAAS,OAAOyI,MmETZkN,GAAQC,sBACbZ,QACGa,EACAC,8BAAoBC,0BAAgBC,OCrDpBC,QACW,cAA7B1S,OAAOqJ,SAASsJ,UAEe,UAA7B3S,OAAOqJ,SAASsJ,UAEhB3S,OAAOqJ,SAASsJ,SAAS5K,MACvB,2D,MCFNtK,IAASmV,cATc,CACtBC,OAAQ,0CACRC,WAAY,+BACZC,YAAa,sCACbC,UAAW,eACXC,cAAe,2BACfC,kBAAmB,gBACnBC,MAAO,yCAGRC,IAASC,OAAO,mBFoDD,WACd,OACC,kBAAC,IAAD,CAAUjB,MAAOA,IAChB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOkB,UAAW1T,IAClB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAO2T,OAAK,EAACpU,KAAK,IAAImU,UAAWE,KACjC,kBAAC,IAAD,CAAOD,OAAK,EAACpU,K5D3Ec,U4D2EUmU,UAAWG,KAChD,kBAAC,IAAD,CAAOF,OAAK,EAACpU,K5D3Ec,kB4D2EUmU,UAAWE,KAChD,kBAAC,IAAD,CAAOD,OAAK,EAACpU,K5D9Ee,gB4D8EUmU,UAAWI,KACjD,kBAAC,IAAD,CAAOH,OAAK,EAACpU,K5D5EoB,gB4D4EUmU,UAAWK,KACtD,kBAAC,IAAD,CAAOJ,OAAK,EAACpU,K5D5EY,gB4D4EUmU,UAAWnG,KAC9C,kBAAC,IAAD,CAAOoG,OAAK,EAACpU,K5D5Ea,S4D4EUmU,UAAWM,KAC/C,kBAAC,IAAD,CAAOL,OAAK,EAACpU,K5D5EY,iB4D4EUmU,UAAWO,KAC9C,kBAAC,IAAD,CAAON,OAAK,EAACpU,K5D5EY,iB4D4EUmU,UAAWQ,KAC9C,kBAAC,IAAD,CAAOR,UAAWS,MAEnB,kBAAC,GAAD,UErEY,MAAS7T,SAAS8T,eAAe,SDgH3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMxR,MAAK,SAAAyR,GACjCA,EAAaC,kB","file":"static/js/main.0f562856.chunk.js","sourcesContent":["import {\n\tOFFERS_ADD_SHOW_MODAL,\n\tOFFERS_ADD_HIDE_MODAL\n} from '../constants/action-types'\nconst initialState = {\n\tuser: null,\n\tmodalShown: false,\n\twait: false,\n\taddError: ''\n}\nexport default function (state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase OFFERS_ADD_SHOW_MODAL: return {\n\t\t\t...state,\n\t\t\tmodalShown: true,\n\t\t\tuser: action.payload.user\n\t\t}\n\t\tcase OFFERS_ADD_HIDE_MODAL: return {\n\t\t\t...state,\n\t\t\tmodalShown: false,\n\t\t\tuser: null\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tAUTH_SHOW_MODAL,\n    AUTH_HIDE_MODAL,\n\tAUTH_SUBSCRIBE,\n    AUTH_LOGIN,\n    AUTH_LOGOUT,\n\tAUTH_LOGOUT_WAIT,\n\tAUTH_LOGOUT_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n    authModalShown: false,\n    subscribed: false, //Firebase has authentification state change subscription\n\tauthData: null, //Authenticated user data owned by firebase\n\tlogoutError: '',\n\twait: false //auth state change is not always triggered.\n}\n\nexport default function (state = initialState, action) {\n    switch(action.type) {\n\t\tcase AUTH_SHOW_MODAL: return {\n            ...state,\n            authModalShown: true,\n        }\n        case AUTH_HIDE_MODAL: return {\n            ...state,\n            authModalShown: false\n        }\n\t\tcase AUTH_SUBSCRIBE: return {\n            ...state,\n            subscribed: true\n        }\n        case AUTH_LOGIN: return {\n\t\t\t...state,\n\t\t\tauthModalShown: false,\n\t\t\tauthData: action.payload.authData\n        }\n        case AUTH_LOGOUT: return {\n\t\t\t...state,\n\t\t\tauthData: null,\n\t\t\twait: false,\n\t\t}\n\t\tcase AUTH_LOGOUT_WAIT: return {\n\t\t\t...state,\n\t\t\twait: true,\n\t\t\tlogoutError: ''\n\t\t}\n\t\tcase AUTH_LOGOUT_ERROR: return {\n\t\t\t...state,\n\t\t\tlogoutError: action.payload.logoutError\n\t\t}\n        default: return state\n\t}\n}","import {\n\tGAME_FINDER_SEARCH_PHRASE,\n\tGAME_FINDER_FETCH,\n\tGAME_FINDER_FETCH_WAIT,\n\tGAME_FINDER_FETCH_ERROR,\n\tGAME_FINDER_FETCH_CANCEL\n} from '../constants/action-types'\n\nconst initialState = {\n\tsearchPhrase: '', //Whole phrase user is searching\n\tsearchKey: '', //String search key usualy 2 letters\n\tpendingPromise: null, //Last fetch promise \n\tgamesFetchError: null, //Last fetch error for searchKey\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase GAME_FINDER_SEARCH_PHRASE: return {\n\t\t\t...state,\n\t\t\tsearchPhrase: action.payload.searchPhrase\n\t\t}\n\t\tcase GAME_FINDER_FETCH: if (state.pendingPromise === action.payload.pendingPromise) {\n\t\t\t//request is still being expected\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpendingPromise: null\n\t\t\t}\n\t\t} else {\n\t\t\t//this request was cancelled\n\t\t\treturn state\n\t\t}\n\t\tcase GAME_FINDER_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tsearchKey: action.payload.searchKey,\n\t\t\tpendingPromise: action.payload.pendingPromise,\n\t\t\tgamesFetchError: ''\n\t\t}\n\t\tcase GAME_FINDER_FETCH_ERROR: if(state.pendingPromise === action.payload.pendingPromise) {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpendingPromise: null,\n\t\t\t\tgames: {},\n\t\t\t\tgamesFetchError: action.payload.gamesFetchError\n\t\t\t}\n\t\t} else {\n\t\t\t//TODO log error\n\t\t\treturn state\n\t\t}\n\t\tcase GAME_FINDER_FETCH_CANCEL: return {\n\t\t\t...state,\n\t\t\tpendingPromise: null\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tGAME_CACHE_FETCH_BY_ID,\n\tGAME_CACHE_WAIT_BY_ID,\n\tGAME_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\n\nconst initialState = {\n\tgamesByIdWait: {}, //Map, key: id of game, value: Boolean is being Fetched\n\tgamesByIdFetched: {}, //Map, key: id of game, value: Boolean is already fetche (successfull or not)\n\tgamesByIdError: {},//Map, key: id of game, value: Error on game fetching\n\tgames: {} //Map, key: id of game, value: game object\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase GAME_CACHE_FETCH_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: true,\n\t\t\t},\n\t\t\tgames: {\n\t\t\t\t...state.games,\n\t\t\t\t[action.payload.gameId]: action.payload.game\n\t\t\t}\n\t\t}\n\t\tcase GAME_CACHE_WAIT_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdError: {\n\t\t\t\t...state.gamesByIdError,\n\t\t\t\t[action.payload.gameId]: null\n\t\t\t}\n\t\t}\n\t\tcase GAME_CACHE_ERROR_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tgamesByIdError: {\n\t\t\t\t...state.gamesByIdError,\n\t\t\t\t[action.payload.gameId]: action.payload.gameByIdError\n\t\t\t}\t\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tOFFER_FINDER_FETCH,\n\tOFFER_FINDER_WAIT,\n\tOFFER_FINDER_ERROR,\n} from '../constants/action-types'\n\nconst initialState = {\n\toffersForGameWait: {}, //map key - gameId, value Boolean is being fetched\n\toffersForGameFetched: {}, //map key - gameId, value Boolean is fetched\n\toffers: {}, //map of offers\n\toffersFetchErrors: {} //map key - gameId, value query Error\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase OFFER_FINDER_FETCH: {\n\t\t\t//Fetched all active offers for the game.\n\t\t\t//All previous offer are outdated\n\t\t\tlet filteredOffers = {}\n\t\t\tfor(let offerId in state.offers) {\n\t\t\t\tif(state.offers[offerId].gameId !== action.payload.gameId) {\n\t\t\t\t\tfilteredOffers[offerId] = state.offers[offerId]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\toffersForGameWait: {\n\t\t\t\t\t...state.offersForGameWait,\n\t\t\t\t\t[action.payload.gameId]: false\n\t\t\t\t},\n\t\t\t\toffersForGameFetched: {\n\t\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t\t[action.payload.gameId]: true\n\t\t\t\t},\n\t\t\t\toffers: {\n\t\t\t\t\t...filteredOffers,\n\t\t\t\t\t...action.payload.offersToAdd\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcase OFFER_FINDER_WAIT: return {\n\t\t\t...state,\n\t\t\toffersForGameWait: {\n\t\t\t\t...state.offersForGameWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\toffersForGameFetched: {\n\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\toffersFetchErrors: {\n\t\t\t\t...state.offersFetchErrors,\n\t\t\t\t[action.payload.gameId]: ''\n\t\t\t}\n\t\t}\n\t\tcase OFFER_FINDER_ERROR: return {\n\t\t\t...state,\n\t\t\toffersForGameWait: {\n\t\t\t\t...state.offersForGameWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\toffersForGameFetched: {\n\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\toffersFetchErrors: {\n\t\t\t\t...state.offersFetchErrors,\n\t\t\t\t[action.payload.gameId]: action.payload.offersFetchError\n\t\t\t}\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tUSER_CACHE_FETCH_BY_OFFER,\n\tUSER_CACHE_WAIT_BY_OFFER,\n\tUSER_CACHE_ERROR_BY_OFFER,\n\tUSER_CACHE_FETCH_BY_ID,\n\tUSER_CACHE_WAIT_BY_ID,\n\tUSER_CACHE_ERROR_BY_ID,\n\tUSER_CACHE_UPDATE,\n\tUSER_CACHE_UPDATE_WAIT,\n\tUSER_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n\tusersByOfferWait: {}, //Map, key: GameId, value: Boolean is being fetched\n\tusersByOfferFetched: {}, //Map, key: GameId, value: Boolean is fetched\n\tusersByOfferError: {},  //Map, key: GameId, value Error fetching Error\n\tuserByIdWait: false,\n\tuserByIdError: null,\n\tuserUpdateWait: false,\n\tuserUpdateError: '',\n\tusers: {} //Map, key: user UID, value Object user\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase USER_CACHE_FETCH_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t...action.payload.users\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_WAIT_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferError: {\n\t\t\t\t...state.usersByOfferError,\n\t\t\t\t[action.payload.gameId]: null\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_ERROR_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusersByOfferError: {\n\t\t\t\t...state.usersByOfferError,\n\t\t\t\t[action.payload.gameId]: action.payload.usersByOfferError\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_FETCH_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: false,\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t[action.payload.userId]:action.payload.user\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_WAIT_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: true,\n\t\t\tuserByIdError: null\n\t\t}\n\t\tcase USER_CACHE_ERROR_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: false,\n\t\t\tuserByIdError: action.payload.userByIdError\n\t\t}\n\t\tcase USER_CACHE_UPDATE: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: false,\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t[action.payload.userId]: action.payload.user\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_UPDATE_WAIT: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: true,\n\t\t\tuserUpdateError: false\n\t\t}\n\t\tcase USER_CACHE_UPDATE_ERROR: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: false,\n\t\t\tuserUpdateError: action.payload.userUpdateError\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tCHAT_CACHE_FETCH_BY_PARTICIPANT, //TODO rename all actions to user FETCH_BY_SOMTH\n\tCHAT_CACHE_WAIT_BY_PARTICIPANT,\n\tCHAT_CACHE_ERROR_BY_PARTICIPANT,\n\tCHAT_CACHE_ADD_PUSH,\n\tCHAT_CACHE_ADD_WAIT,\n\tCHAT_CACHE_ADD_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n\tchatsByParticipantWait: {}, //Map, key: participantId, value Boolean is being fetched\n\tchatsByParticipantFetched: {}, //Map, key: participantId, value Boolean is fetched\n\tchatsByParticipantError: {}, //Map, key: participantId, value Error\n\tchats: {}, //Map, key: chatId, value Object chat\n\tchatAddWait: false,\n\tchatAddError: null\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase CHAT_CACHE_FETCH_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchats: {\n\t\t\t\t...state.chats,\n\t\t\t\t...action.payload.chats\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_WAIT_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantError: {\n\t\t\t\t...state.chatsByParticipantError,\n\t\t\t\t[action.payload.participantId]: null\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_ERROR_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchatsByParticipantError: {\n\t\t\t\t...state.chatsByParticipantError,\n\t\t\t\t[action.payload.participantId]: action.payload.chatsByParticipantError\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_ADD_PUSH: return {\n\t\t\t...state,\n\t\t\tchats: {\n\t\t\t\t...state.chats,\n\t\t\t\t[action.payload.chatId]: action.payload.chat\n\t\t\t},\n\t\t\tchatAddWait: false\n\t\t}\n\t\tcase CHAT_CACHE_ADD_WAIT: return {\n\t\t\t...state,\n\t\t\tchatAddWait: false,\n\t\t\tchatAddError: null\n\t\t}\n\t\tcase CHAT_CACHE_ADD_ERROR: return {\n\t\t\t...state,\n\t\t\tchatAddWait: false,\n\t\t\tchatAddError: action.payload.addError\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tCLAUSE_CACHE_ADD_PUSH,\n\tCLAUSE_CACHE_ADD_WAIT,\n\tCLAUSE_CACHE_ADD_ERROR,\n\tCLAUSE_CACHE_FETCH_BY_CHAT,\n\tCLAUSE_CACHE_WAIT_BY_CHAT,\n\tCLAUSE_CACHE_ERROR_BY_CHAT,\n\tCLAUSE_CACHE_UPDATE_STATUS,\n\tCLAUSE_CACHE_UPDATE_WAIT,\n\tCLAUSE_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n\tclauses: {}, //Map, key: clauseId, value Object clause\n\tclauseAddWait: false, //Boolean flag, clause is now being added to server\n\tclauseAddError: null, //Error on adding clause object to (server database)\n\tclausesByChatWait: {}, //Map, key: chatId, value: Boolean is being Fetched\n\tclausesByChatFetched: {}, //Map, key: chatId, value: Boolean is Fetched\n\tclausesByChatError: {}, //Map, key: chatId, value: Error\n\tclausesUpdateWait: false, //Boolean flag, clause is being updated\n\tclausesUpdateError: null //Error on updating clause specifficaly status\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase CLAUSE_CACHE_ADD_PUSH: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t[action.payload.clauseId]: action.payload.clause\n\t\t\t},\n\t\t\tclauseAddWait: false\n\t\t}\n\t\tcase CLAUSE_CACHE_ADD_WAIT: return {\n\t\t\t...state,\n\t\t\tclauseAddWait: true,\n\t\t\tclauseAddError: null\n\t\t}\n\t\tcase CLAUSE_CACHE_ADD_ERROR: return {\n\t\t\t...state,\n\t\t\tclauseAddWait: false,\n\t\t\tclauseAddError: action.payload.addError\n\t\t}\n\t\tcase CLAUSE_CACHE_FETCH_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t...action.payload.clauses\n\t\t\t},\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_WAIT_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatError: {\n\t\t\t\t...state.clausesByChatError,\n\t\t\t\t[action.payload.chatId]: null\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_ERROR_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tclausesByChatError: {\n\t\t\t\t...state.clausesByChatError,\n\t\t\t\t[action.payload.chatId]: action.payload.clausesByChatError\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_STATUS: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t[action.payload.clauseId]: action.payload.clause\n\t\t\t},\n\t\t\tclausesUpdateWait: false\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_WAIT: return {\n\t\t\t...state,\n\t\t\tclausesUpdateWait: true,\n\t\t\tclausesUpdateError: null,\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_ERROR: return {\n\t\t\t...state,\n\t\t\tclausesUpdateWait: false,\n\t\t\tclausesUpdateError: action.payload.updateError\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tADDRESS_LOOKUP_CACHE_FETCH,\n\tADDRESS_LOOKUP_CACHE_FETCH_WAIT,\n\tADDRESS_LOOKUP_CACHE_FETCH_ERROR,\n} from '../constants/action-types'\n\nconst initialState = {\n\tlookupPhrase: '', //Lookup phrase\n\tsuggestions: [], //Array of places, https://nominatim.org/release-docs/develop/api/Output/\n\tsuggestionsFetchWait: false,\n\tsuggestionsFetchError: null,\n\tsuggestionsFetched: false\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH: return {\n\t\t\t...state,\n\t\t\tsuggestions: action.payload.suggestions,\n\t\t\tsuggestionsFetchWait: false,\n\t\t\tsuggestionsFetched: true\n\t\t}\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tlookupPhrase: action.payload.lookupPhrase,\n\t\t\tsuggestionsFetchWait: true,\n\t\t\tsuggestionsFetched: false,\n\n\t\t}\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH_ERROR: return {\n\t\t\t...state,\n\t\t\tsuggestionsFetchWait: false,\n\t\t\tsuggestionsFetched: true,\n\t\t\tsuggestionsFetchError: action.payload.suggestionsFetchError\n\t\t}\n\t\tdefault: return state\n\t}\n}","/*\n\tReducer used only for self update. \n\tGeneric user update is not supported.\n*/\nimport {\n\tUSER_UPDATE_UNSAVED,\n\tUSER_UPDATE_SAVED\n} from '../constants/action-types'\n\nconst initialState = {\n\tuser: null,\n\tisSaved: true,\n}\n\nexport default function (state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase USER_UPDATE_UNSAVED: return {\n\t\t\t...state,\n\t\t\tuser: action.payload.user,\n\t\t\tisSaved: false,\n\t\t}\n\t\tcase USER_UPDATE_SAVED: return {\n\t\t\t...state,\n\t\t\tuser: action.payload.user,\n\t\t\tisSaved: true,\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tMESSAGE_CACHE_FETCH,\n\tMESSAGE_CACHE_FETCH_WAIT,\n\tMESSAGE_CACHE_FETCH_ERROR,\n\tMESSAGE_CACHE_UPDATE,\n\tMESSAGE_CACHE_UPDATE_CONFIRM,\n\tMESSAGE_CACHE_SUBSCRITION\n} from '../constants/action-types'\n\nconst initialState = {\n\tmessages: [], //Message list for specific chat.\n\tmessagesFetchWait: true, //Boolean flag, messages for chat are being fetched.\n\tmessagesFetchError: null, //Error on fetching chat messages.\n\tmessagesUnsubscribe: null //firebase unsubscribe function\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase MESSAGE_CACHE_FETCH: return {\n\t\t\t...state,\n\t\t\tmessages: action.payload.messages,\n\t\t\tmessagesFetchWait: false\n\t\t}\n\t\tcase MESSAGE_CACHE_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tmessagesFetchWait: true,\n\t\t\tmessagesFetchError: null,\n\t\t}\n\t\tcase MESSAGE_CACHE_FETCH_ERROR: return {\n\t\t\t...state,\n\t\t\tmessagesFetchWait: false,\n\t\t\tmessagesFetchError: action.payload.fetchError\n\t\t}\n\t\tcase MESSAGE_CACHE_UPDATE: {\n\t\t\tconst messageIndex = (action.payload.outdatedMessageId\n\t\t\t\t? state.messages.findIndex(message => message.id === action.payload.outdatedMessageId)\n\t\t\t\t: -1)\n\t\t\tif(messageIndex >= 0 ) { //message is in array, replace it with updated\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tmessages: [\n\t\t\t\t\t\t...state.messages.slice(0, messageIndex),\n\t\t\t\t\t\taction.payload.updatedMessage,\n\t\t\t\t\t\t...state.messages.slice(messageIndex + 1)\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {//message is not in array, put in list as the last one, \n\t\t\t\t...state,\n\t\t\t\tmessages: [\n\t\t\t\t\t...state.messages,\n\t\t\t\t\taction.payload.updatedMessage\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t\tcase MESSAGE_CACHE_UPDATE_CONFIRM: return {\n\t\t\t...state,\n\t\t\tmessages: state.messages.map(message => {\n\t\t\t\tif(message.id === action.payload.confirmedMessageId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...message,\n\t\t\t\t\t\tisUpdating: false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn message\n\t\t\t})\n\t\t}\n\t\tcase MESSAGE_CACHE_SUBSCRITION: return {\n\t\t\t...state,\n\t\t\tmessagesUnsubscribe: action.payload.messagesUnsubscribe\n\t\t}\n\t\tdefault: return state\n\t}\n}","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tUSER_CACHE_FETCH_BY_OFFER,\n\tUSER_CACHE_WAIT_BY_OFFER,\n\tUSER_CACHE_ERROR_BY_OFFER,\n\tUSER_CACHE_FETCH_BY_ID,\n\tUSER_CACHE_WAIT_BY_ID,\n\tUSER_CACHE_ERROR_BY_ID,\n\tUSER_CACHE_UPDATE,\n\tUSER_CACHE_UPDATE_WAIT,\n\tUSER_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\nimport {COLLECTION_USERS} from '../constants/collection-names'\n//Actions\nfunction userCacheFetchByOffer(gameId, users) {\n\treturn {\n\t\ttype: USER_CACHE_FETCH_BY_OFFER,\n\t\tpayload: {gameId, users}\n\t}\n}\nfunction userCacheWaitByOffer(gameId) {\n\treturn {\n\t\ttype: USER_CACHE_WAIT_BY_OFFER,\n\t\tpayload: {gameId}\n\t}\n}\nfunction userCacheErrorByOffer(gameId, usersByOfferError) {\n\treturn {\n\t\ttype: USER_CACHE_ERROR_BY_OFFER,\n\t\tpayload: {gameId}\n\t}\n}\nfunction userCacheFetchById(userId, user) {\n\treturn {\n\t\ttype: USER_CACHE_FETCH_BY_ID,\n\t\tpayload: {userId, user}\n\t}\n}\nfunction userCacheWaitById() {\n\treturn {type: USER_CACHE_WAIT_BY_ID}\n}\nfunction userCacheErrorById(userByIdError) {\n\treturn {\n\t\ttype: USER_CACHE_ERROR_BY_ID,\n\t\tpayload: {userByIdError}\n\t}\n}\nfunction userCacheUpdate(userId, user) {\n\treturn {\n\t\ttype: USER_CACHE_UPDATE,\n\t\tpayload: {\n\t\t\tuserId,\n\t\t\tuser\n\t\t}\n\t}\n}\nfunction userCacheUpdateWait() {\n\treturn {type: USER_CACHE_UPDATE_WAIT}\n}\nfunction userCacheUpdateError(userUpdateError) {\n\treturn {\n\t\ttype: USER_CACHE_UPDATE_ERROR,\n\t\tpayload: {userUpdateError}\n\t}\n}\n//Thunks\n/**\n * Fetches all user for specified gameId as Offer\n * @param {String} gameId\n */\nexport function userCacheFetchByOfferRequest(gameId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore() //TODO rename complex names to query\n\t\t\t.collection(COLLECTION_USERS)\n\t\t\t.where('offerIds', 'array-contains', gameId)\n\t\tdispatch(userCacheWaitByOffer(gameId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst users = querySnapshot.docs.reduce((users, doc) => {\n\t\t\t\tusers[doc.id] = doc.data()\n\t\t\t\treturn users\n\t\t\t}, {})\n\t\t\tdispatch(userCacheFetchByOffer(gameId, users))\n\t\t} catch (usersByOfferError) {\n\t\t\tdispatch(userCacheErrorByOffer(gameId, usersByOfferError))\n\t\t}\n\t}\n}\n/**\n * Fetches single user\n * @param {String} userId same as authData.uid\n */\nexport function userCacheFetchUserByIdRequest(userId) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheWaitById())\n\t\ttry {\n\t\t\tconst doc = await ref.get()\n\t\t\tdispatch(userCacheFetchById(userId, doc.data() || null))\n\t\t} catch(userByIdError) {\n\t\t\tdispatch(userCacheErrorById (userByIdError))\n\t\t}\n\t}\n}\n/**\n * Adds Offer or demand to user Object\n * @param {String} userId\n * @param {String} gameId\n * @param {Boolean} isDemand\n */\n export function userCacheAddUserGameRequest(userId, gameId, isDemand) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tlet user = doc.data()\n\t\t\tconst updateField = isDemand ? 'demandIds' : 'offerIds'\n\t\t\tif (!user[updateField] || user[updateField].indexOf(gameId) < 0) {\n\t\t\t\tawait ref.update({\n\t\t\t\t\t[updateField]: firebase.firestore.FieldValue.arrayUnion(gameId)\n\t\t\t\t})\n\t\t\t\tuser[updateField] = user[updateField] || []\n\t\t\t\tuser[updateField].push(gameId)\n\t\t\t}\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n/**\n * Deletes Offer or demand to user Object\n * @param {String} userId\n * @param {String} gameId\n * @param {Boolean} isDemand\n */\n export function userCacheDeleteUserGameRequest(userId, gameId, isDemand) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tlet user = doc.data()\n\t\t\tconst updateField = isDemand ? 'demandIds' : 'offerIds'\n\t\t\tif (user[updateField] && user[updateField].indexOf(gameId) >= 0) {\n\t\t\t\tawait ref.update({\n\t\t\t\t\t[updateField]: firebase.firestore.FieldValue.arrayRemove(gameId)\n\t\t\t\t})\n\t\t\t\tuser[updateField] = user[updateField].filter(userGameId => userGameId !== gameId)\n\t\t\t}\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n\n/**\n * Updates specified user\n * @param {String} userId\n * @param {Object} userUpdates\n * @param {Function} successCallback\n */\nexport function userCacheUserUpdate(userId, userUpdates, successCallback) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tconst user = {\n\t\t\t\t...doc.data(),\n\t\t\t\t...userUpdates\n\t\t\t}\n\t\t\tawait ref.update(user)\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t\tsuccessCallback(user)\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n/**\n * Creates specified user\n * @param {String} userId\n * @param {Object} user\n * @param {Function} successCallback\n */\nexport function userCacheUserCreate(userId, user, successCallback) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n \t\t\t.collection(COLLECTION_USERS).doc(userId)\n \t\tdispatch(userCacheUpdateWait())\n \t\ttry {\n \t\t\tawait ref.set(user)\n \t\t\tdispatch(userCacheUpdate(userId, user))\n \t\t\tsuccessCallback(user)\n \t\t} catch (userUpdateError) {\n \t\t\tdispatch(userCacheUpdateError(userUpdateError))\n \t\t}\n\t}\n}","export const AUTH_SHOW_MODAL = 'AUTH_SHOW_MODAL'\nexport const AUTH_HIDE_MODAL = 'AUTH_HIDE_MODAL'\nexport const AUTH_SUBSCRIBE = 'AUTH_SUBSCRIBE'\nexport const AUTH_LOGIN = 'AUTH_LOGIN'\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT'\nexport const AUTH_LOGOUT_WAIT= 'AUTH_LOGOUT_WAIT'\nexport const AUTH_LOGOUT_ERROR = 'AUTH_LOGOUT_ERROR'\n\nexport const OFFERS_FETCH = 'OFFERS_FETCH'\nexport const OFFERS_FETCH_WAIT = 'OFFERS_FETCH_WAIT'\nexport const OFFERS_FETCH_ERROR = 'OFFERS_FETCH_ERROR'\nexport const OFFERS_PUSH = 'OFFERS_PUSH'\nexport const OFFERS_DELETE = 'OFFERS_DELETE'\nexport const OFFERS_DELETE_WAIT = 'OFFERS_DELETE_WAIT'\nexport const OFFERS_DELETE_ERROR = 'OFFERS_DELETE_ERROR'\n\nexport const OFFERS_ADD_SHOW_MODAL = 'OFFERS_ADD_SHOW_MODAL'\nexport const OFFERS_ADD_HIDE_MODAL = 'OFFERS_ADD_HIDE_MODAL'\n\nexport const GAME_CACHE_FETCH_BY_ID = 'GAME_CACHE_FETCH_BY_ID'\nexport const GAME_CACHE_WAIT_BY_ID = 'GAME_CACHE_WAIT_BY_ID'\nexport const GAME_CACHE_ERROR_BY_ID = 'GAME_CACHE_ERROR_BY_ID'\n\nexport const GAME_FINDER_SEARCH_PHRASE = 'GAME_FINDER_SEARCH_PHRASE'\nexport const GAME_FINDER_FETCH = 'GAME_FINDER_FETCH'\nexport const GAME_FINDER_FETCH_WAIT = 'GAME_FINDER_FETCH_WAIT'\nexport const GAME_FINDER_FETCH_ERROR = 'GAME_FINDER_FETCH_ERROR'\nexport const GAME_FINDER_FETCH_CANCEL = 'GAME_FINDER_FETCH_CANCEL'\n\nexport const OFFER_FINDER_FETCH = 'OFFER_FINDER_FETCH'\nexport const OFFER_FINDER_WAIT = 'OFFER_FINDER_WAIT'\nexport const OFFER_FINDER_ERROR = 'OFFER_FINDER_ERROR'\n\nexport const USER_CACHE_FETCH_BY_OFFER = 'USER_CACHE_FETCH_BY_OFFER'\nexport const USER_CACHE_WAIT_BY_OFFER = 'USER_CACHE_WAIT_BY_OFFER'\nexport const USER_CACHE_ERROR_BY_OFFER = 'USER_CACHE_ERROR_BY_OFFER'\nexport const USER_CACHE_FETCH_BY_ID = 'USER_CACHE_FETCH_BY_ID'\nexport const USER_CACHE_WAIT_BY_ID = 'USER_CACHE_WAIT_BY_ID'\nexport const USER_CACHE_ERROR_BY_ID = 'USER_CACHE_ERROR_BY_ID'\nexport const USER_CACHE_UPDATE = 'USER_CACHE_UPDATE'\nexport const USER_CACHE_UPDATE_WAIT = 'USER_CACHE_UPDATE_WAIT'\nexport const USER_CACHE_UPDATE_ERROR = 'USER_CACHE_UPDATE_ERROR'\n\nexport const GAME_FETCH = 'GAME_FETCH'\nexport const GAME_FETCH_WAIT = 'GAME_FETCH_WAIT'\nexport const GAME_FETCH_ERROR = 'GAME_FETCH_ERROR'\n\nexport const CHAT_CACHE_FETCH_BY_PARTICIPANT = 'CHAT_CACHE_FETCH_BY_PARTICIPANT'\nexport const CHAT_CACHE_WAIT_BY_PARTICIPANT = 'CHAT_CACHE_WAIT_BY_PARTICIPANT'\nexport const CHAT_CACHE_ERROR_BY_PARTICIPANT = 'CHAT_CACHE_ERROR_BY_PARTICIPANT'\nexport const CHAT_CACHE_ADD_PUSH = 'CHAT_CACHE_ADD_PUSH'\nexport const CHAT_CACHE_ADD_WAIT = 'CHAT_CACHE_ADD_WAIT'\nexport const CHAT_CACHE_ADD_ERROR = 'CHAT_CACHE_ADD_ERROR'\n\nexport const CLAUSE_CACHE_ADD_PUSH = 'CLAUSE_CACHE_ADD_PUSH'\nexport const CLAUSE_CACHE_ADD_WAIT = 'CLAUSE_CACHE_ADD_WAIT'\nexport const CLAUSE_CACHE_ADD_ERROR = 'CLAUSE_CACHE_ADD_ERROR'\nexport const CLAUSE_CACHE_FETCH_BY_CHAT = 'CLAUSE_CACHE_FETCH_BY_CHAT'\nexport const CLAUSE_CACHE_WAIT_BY_CHAT = 'CLAUSE_CACHE_WAIT_BY_CHAT'\nexport const CLAUSE_CACHE_ERROR_BY_CHAT = 'CLAUSE_CACHE_ERROR_BY_CHAT'\nexport const CLAUSE_CACHE_UPDATE_STATUS = 'CLAUSE_CACHE_UPDATE_STATUS'\nexport const CLAUSE_CACHE_UPDATE_WAIT = 'CLAUSE_CACHE_UPDATE_WAIT'\nexport const CLAUSE_CACHE_UPDATE_ERROR = 'CLAUSE_CACHE_UPDATE_ERROR'\n\nexport const ADDRESS_LOOKUP_CACHE_FETCH = 'ADDRESS_LOOKUP_CACHE_FETCH'\nexport const ADDRESS_LOOKUP_CACHE_FETCH_WAIT = 'ADDRESS_LOOKUP_CACHE_FETCH_WAIT'\nexport const ADDRESS_LOOKUP_CACHE_FETCH_ERROR = 'ADDRESS_LOOKUP_CACHE_FETCH_ERROR'\n\nexport const USER_UPDATE_UNSAVED = 'USER_UPDATE_UNSAVED'\nexport const USER_UPDATE_SAVED = 'USER_UPDATE_SAVED'\n\nexport const MESSAGE_CACHE_FETCH = 'MESSAGE_CACHE_FETCH'\nexport const MESSAGE_CACHE_FETCH_WAIT = 'MESSAGE_CACHE_FETCH_WAIT'\nexport const MESSAGE_CACHE_FETCH_ERROR = 'MESSAGE_CACHE_FETCH_ERROR'\nexport const MESSAGE_CACHE_UPDATE = 'MESSAGE_CACHE_UPDATE'\nexport const MESSAGE_CACHE_UPDATE_CONFIRM = 'MESSAGE_CACHE_UPDATE_CONFIRM'\nexport const MESSAGE_CACHE_SUBSCRITION = 'MESSAGE_CACHE_SUBSCRITION'","export const COLLECTION_USERS = 'users'\nexport const COLLECTION_OFFERS = 'offers'\nexport const COLLECTION_GAMES = 'games'\nexport const COLLECTION_CHATS = 'chats'\nexport const COLLECTION_CLAUSES = 'clauses'\nexport const COLLECTION_MESSAGES = 'messages'","import React from 'react'\nimport {connect} from 'react-redux'\nimport {authShowModal} from '../actions/auth'\n\nfunction LoginButton({customText, onAuthShowModal}) {\n\treturn (\n\t\t<button className=\"link\" onClick={onAuthShowModal}>{customText || 'Login'}</button>\n\t)\n}\n\nconst mapStateToProps = () => ({})\nconst mapDispatchToProps = dispatch => ({\n\tonAuthShowModal() {\n\t\treturn dispatch(authShowModal())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginButton) ","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport {\n\tAUTH_SHOW_MODAL,\n    AUTH_HIDE_MODAL,\n\tAUTH_SUBSCRIBE,\n    AUTH_LOGIN,\n    AUTH_LOGOUT,\n\tAUTH_LOGOUT_WAIT,\n\tAUTH_LOGOUT_ERROR\n} from '../constants/action-types'\nimport {\n\tuserCacheFetchUserByIdRequest\n} from './user-cache'\n\n//Actions\nexport function authShowModal() {\n    return {\n        type: AUTH_SHOW_MODAL\n    }\n}\nexport function authHideModal() {\n    return {\n        type: AUTH_HIDE_MODAL\n    }\n}\nfunction authSubscribe() {\n    return {\n        type: AUTH_SUBSCRIBE\n    }\n}\nfunction authLogin(authData) {\n    return {\n        type: AUTH_LOGIN,\n        payload: {authData}\n    }\n}\nfunction authLogout() {\n    return {\n        type: AUTH_LOGOUT\n    }\n}\nfunction authLogoutWait() {\n\treturn {\n\t\ttype: AUTH_LOGOUT_WAIT\n\t}\n}\nfunction authLogoutError(logoutError){\n\treturn {\n\t\ttype: AUTH_LOGOUT_ERROR,\n\t\tpayload: {\n\t\t\tlogoutError: logoutError,\n\t\t}\n\t}\n}\n\n//Thunks\n/**\n * Logouts user.\n */\nexport function authRequestLogout() {\n    return async dispatch => {\n\t\tdispatch(authLogoutWait())\n\t\ttry {\n\t\t\tawait firebase.auth().signOut()\n        \tdispatch(authLogout())    \n\t\t} catch (logoutError) {\n\t\t\tdispatch(authLogoutError(logoutError))\n\t\t}\n    }\n}\n/**\n * Adds authentication state observer\n */\nexport function authRequestSubscribe() {\n    return dispatch => {\n        //Subscribe to auth state change\n        firebase.auth().onAuthStateChanged(function(authData) {\n            if(authData) {\n                dispatch(authLogin(authData))\n\t\t\t\tdispatch(userCacheFetchUserByIdRequest(authData.uid))\n            } else {\n                dispatch(authLogout())\n            }\n        })\n        //self dispatch\n        dispatch(authSubscribe())\n    }\n}\n","import React from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport {PATH_PAGE_OFFERS} from '../constants/paths'\nimport LoginButton from './login-button'\n\nfunction HeaderOffers({authData}) {\n\tif(authData) {\n\t\treturn (\n\t\t\t<Link to={PATH_PAGE_OFFERS.replace(':userId',authData.uid)}>\n\t\t\t\tMy games\n\t\t\t</Link>\n\t\t)\n\t} else {\n\t\treturn <LoginButton customText='My games'/>\n\t}\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tauthData: auth.authData\n})\nexport default connect(mapStateToProps)(HeaderOffers) ","export const PATH_PAGE_PROFILE = '/profile/:uid'\nexport const PATH_PAGE_SEARCH = '/search'\nexport const PATH_PAGE_OFFERS = '/offers/:userId'\nexport const PATH_PAGE_REGISTRATION = '/registration'\nexport const PATH_PAGE_GAME = '/game/:gameId'\nexport const PATH_PAGE_CHATS = '/chats'\nexport const PATH_PAGE_CHAT = '/chats/:chatId'\nexport const PATH_PAGE_DEAL = '/deals/:chatId'","import React from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport {\n\tPATH_PAGE_REGISTRATION,\n\tPATH_PAGE_PROFILE\n} from '../constants/paths'\n\nfunction HeaderProfileName({authData, unregistered, user=null}) {\n\tconst name = (user && user.name) || authData.displayName\n\tconst path = (unregistered \n\t\t? PATH_PAGE_REGISTRATION \n\t\t: PATH_PAGE_PROFILE.replace(':uid', authData.uid))\n\treturn (\n\t\t<Link to={path}>{name}</Link>\n\t)\n}\n\nconst mapStateToProps = ({auth, userCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tauthData: auth.authData,\n\t\tunregistered: userCache.users[userId] === null,\n\t\tuser: userCache.users[userId]\n\t}\n}\n\nexport default connect(mapStateToProps)(HeaderProfileName) ","import React, {useEffect} from 'react'\nimport { connect } from 'react-redux'\nimport {authRequestLogout, authRequestSubscribe} from '../actions/auth'\nimport {PATH_PAGE_REGISTRATION} from '../constants/paths'\n\nimport LoginButton from './login-button'\nimport HeaderProfileName from './header-profile-name'\n\nfunction HeaderProfile({\n\thistory,\n\tsubscribed,\n\tauthData,\n\tunregistered,\n\twait,\n\tonAuthSubscribe,\n\tonAuthLogout})\n{\n\tuseEffect(() => {\n\t\tif(!subscribed) { //Subscribe to auth change on firebase\n\t\t\tonAuthSubscribe()\n\t\t}\n\t\tif(unregistered && authData && authData.uid ) {\n\t\t\thistory.push(PATH_PAGE_REGISTRATION)\n\t\t}\n\t}, [subscribed, onAuthSubscribe, unregistered, authData, history])\n\n\tif(wait) {//if pending authentication of fetching authorized user.\n\t\treturn (\n\t\t\t<nav>\n\t\t\t\t<div>wait...</div>\n\t\t\t</nav>\n\t\t)\n\t} else if(authData) { //user is authenticated\n\t\treturn (\n\t\t\t<nav>\n\t\t\t\t<HeaderProfileName />\n\t\t\t\t<div onClick={onAuthLogout}>Logout</div>\n\t\t\t</nav>\n\t\t)\n\t} else { //user not authenticated\n\t\treturn (\n\t\t\t<nav>\n\t\t\t\t<LoginButton />\n\t\t\t</nav>\n\t\t)\n\t}\n}\nconst mapStateToProps = ({auth, userCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tsubscribed: auth.subscribed,\n\t\tauthData: auth.authData,\n\t\tunregistered: userCache.users[userId] === null,\n\t\twait: auth.wait || userCache.userByIdWait\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonAuthSubscribe() {\n\t\treturn dispatch(authRequestSubscribe())\n\t},\n\tonAuthLogout() {\n\t\treturn dispatch(authRequestLogout())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderProfile)","import React from 'react'\nimport {Link} from 'react-router-dom'\nimport HeaderOffers from './header-offers'\nimport HeaderProfile from './header-profile'\nimport {\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_CHATS\n} from '../constants/paths'\nfunction Header({history}) {\n\treturn (\n\t\t<header>\n\t\t\t<nav>\n\t\t\t\t<div>UNPACKED</div>\n\t\t\t\t<Link to={PATH_PAGE_SEARCH}>Find games</Link>\n\t\t\t\t<HeaderOffers/>\n\t\t\t\t<Link to={PATH_PAGE_CHATS}>Deals</Link>\n\t\t\t</nav>\n\t\t\t<HeaderProfile history={history} />\n\t\t</header>\n\t)\n}\n\nexport default Header","import React, {useEffect} from 'react'\nimport '../styles/modal.css'\nfunction Modal({renderCallback, closeCallback}) {\n\t//Fix body to prevent background scrolling;\n\tuseEffect(() => {\n\t\tif(window.scrollY) {\n\t\t\tdocument.body.style.top = `-${window.scrollY}px`\n\t\t}\n\t\tdocument.body.style.width = '100%'\n\t\tdocument.body.style.position = 'fixed'\n\t\t\n\t\treturn function() {\n\t\t\tconst top = document.body.style.top\n\t\t\tif(top) {\n\t\t\t\twindow.scrollTo(0, parseFloat(top.replace('-', '').replace('px', '')));\n\t\t\t\tdocument.body.style.top = ''\n\t\t\t}\n\t\t\tdocument.body.style.width = ''\n\t\t\tdocument.body.style.position = ''\n\t\t}\n\t})\n\t//Subscribe ESC close \n\tuseEffect(() => {\n\t\tfunction closeByEsc(e) {\n\t\t\t(e.key === \"Escape\") && closeCallback && closeCallback(e)\n\t\t}\n\t\tdocument.addEventListener('keyup', closeByEsc)\n\n\t\treturn function() {\n\t\t\tdocument.removeEventListener('keyup', closeByEsc)\n\t\t}\n\t})\n\n\t/**\n\t * Handles click event:\n\t *  if clicked on modal mask tries to close the modal\n\t * @param {Event} e click event\n\t */\n\tfunction modalClick(e) {\n\t\tif(closeCallback && e.target === e.currentTarget) {\n\t\t\tcloseCallback(e)\n\t\t}\n\t}\n\treturn (\n\t\t<div className='modal' onClick={modalClick}>\n\t\t\t<div className='modal__body'>{renderCallback()}</div>\n\t\t</div>\n\t)\n}\n\nexport default Modal;","import React from 'react'\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport firebase from 'firebase/app'\nimport 'firebase/auth'\n\nimport * as firebaseui from 'firebaseui'\nimport {connect} from 'react-redux'\nimport Modal from './modal'\nimport {authHideModal} from '../actions/auth'\n\n// Configure FirebaseUI.\nconst uiConfig = {\n\t// Popup signin flow rather than redirect flow.\n    signInFlow: 'popup',\n\t// We will display Google and Email as auth providers.\n\tsignInOptions: [\n\t\tfirebase.auth.GoogleAuthProvider.PROVIDER_ID,\n\t\tfirebase.auth.EmailAuthProvider.PROVIDER_ID\n\t],\n\tcredentialHelper: firebaseui.auth.CredentialHelper.NONE,\n\tcallbacks: {\n\t\tsignInSuccessWithAuthResult() {\n\t\t\treturn false\n\t\t}\n\t}\n}\n\n// Auth component\nfunction AuthModal({onHideModal}) {\n\tconst renderCallback = () => (\n\t\t<StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={firebase.auth()} />\n\t)\n\treturn (\n\t\t<Modal renderCallback={renderCallback} closeCallback={onHideModal}/>\n\t)\n}\nconst mapDispatchToProps = dispatch => ({\n    onHideModal() {\n        return dispatch(authHideModal())\n    }\n})\nexport default connect(null, mapDispatchToProps)(AuthModal)","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {COLLECTION_GAMES} from '../constants/collection-names'\nimport {\n\tGAME_CACHE_FETCH_BY_ID,\n\tGAME_CACHE_WAIT_BY_ID,\n\tGAME_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\n//Actions\nexport function gameCacheFetchById(gameId, game) {\n\treturn {\n\t\ttype: GAME_CACHE_FETCH_BY_ID,\n\t\tpayload: {\n\t\t\tgameId,\n\t\t\tgame\n\t\t}\n\t}\n}\nfunction gameCacheWaitById(gameId) {\n\treturn {\n\t\ttype: GAME_CACHE_WAIT_BY_ID,\n\t\tpayload: {gameId}\n\t}\n}\nfunction gameCacheErrorById(gameId, gameByIdError) {\n\treturn {\n\t\ttype: GAME_CACHE_ERROR_BY_ID\n\t}\n}\n//Thunks\n/**\n * Fetches single game by Id,\n * @param {String} gameId id id datebase\n */\n export function gameCacheFetchByIdRequest(gameId) {\n \treturn async dispatch => {\n \t\tconst ref = firebase.firestore()\n \t\t\t.collection(COLLECTION_GAMES)\n \t\t\t.doc(gameId)\n \t\tdispatch(gameCacheWaitById(gameId))\n \t\ttry {\n \t\t\tconst doc = await ref.get()\n \t\t\tdispatch(gameCacheFetchById(gameId, doc.data() || null))\n \t\t} catch(gameByIdError) {\n \t\t\tdispatch(gameCacheErrorById(gameId, gameByIdError))\n \t\t}\n \t}\n }\n/**\n * Fetches games that haven't beent fetched\n * @param {Object} \n */\n export function gameCacheFetchMissingGamesRequest(gameIds, games, gamesByIdWait) {\n \treturn async dispatch => {\n \t\t//TODO convert to single bulk dispatch and fetch\n \t\tgameIds.forEach(gameId => {\n \t\t\tif(!gamesByIdWait[gameId] && !games[gameId]) {\n \t\t\t\tdispatch(gameCacheFetchByIdRequest(gameId))\n \t\t\t}\n \t\t})\n \t}\n }","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tGAME_FINDER_SEARCH_PHRASE,\n\tGAME_FINDER_FETCH,\n\tGAME_FINDER_FETCH_WAIT,\n\tGAME_FINDER_FETCH_ERROR,\n\tGAME_FINDER_FETCH_CANCEL\n} from '../constants/action-types'\nimport {COLLECTION_GAMES} from '../constants/collection-names'\nimport {gameCacheFetchById} from './game-cache'\n//Actions\nexport function gameFinderSearchPhrase(searchPhrase) {\n\treturn {\n\t\ttype: GAME_FINDER_SEARCH_PHRASE,\n\t\tpayload: {searchPhrase}\n\t}\n}\nfunction gameFinderFetch(pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH,\n\t\tpayload: {pendingPromise}\n\t}\n}\nfunction gameFinderFetchWait(searchKey, pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH_WAIT,\n\t\tpayload: {searchKey, pendingPromise}\n\t}\n}\nfunction gameFinderFetchError(gamesFetchError, pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH_ERROR,\n\t\tpayload: {gamesFetchError, pendingPromise}\n\t}\n}\nexport function gameFinderFetchCancel() {\n\treturn {type: GAME_FINDER_FETCH_CANCEL}\n}\n//Thunks\n/**\n * Fetches list of games according to search string,\n * Should not be used for filtering games\n * @param {String} searchKey 2 chars key stored for each game\n */\nexport function gameFinderFetchRequest(searchKey) {\n\t/*TODO create game cache for finding games,\n\t\tso you won't get possibly enormous ammount of queries */\n\treturn async dispatch => {\n\t\tconst gamesQuery = firebase.firestore()\n\t\t\t.collection(COLLECTION_GAMES)\n\t\t\t.where('searchKeys', 'array-contains', searchKey)\n\t\tconst pendingPromise = gamesQuery.get()\n\t\tpendingPromise.then(\n\t\t\tquerySnapshot => {\n\t\t\t\tconst games = querySnapshot.docs.reduce((games, doc) => {\n\t\t\t\t\tgames[doc.id] = doc.data()\n\t\t\t\t\treturn games\n\t\t\t\t}, {})\n\t\t\t\tdispatch(gameFinderFetch(pendingPromise))\n\t\t\t\tfor(let gameId in games) {\n\t\t\t\t\tdispatch(gameCacheFetchById(gameId, games[gameId]))\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tgamesFetchError => {\n\t\t\t\tdispatch(gameFinderFetchError(gamesFetchError, pendingPromise))\n\t\t\t}\n\t\t)\n\t\tdispatch(gameFinderFetchWait(searchKey, pendingPromise))\n\t}\n}","import React from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tgameFinderSearchPhrase,\n\tgameFinderFetchRequest,\n\tgameFinderFetchCancel\n} from '../actions/game-finder'\n\nfunction GameFinderInput ({\n\tsearchPhrase,\n\tsearchKey,\n\tonGameFinderSearchPhrase,\n\tonGameFinderFetchRequest,\n\tonGameFinderFetchCancel\n}) {\n\tfunction onSearchPhraseChange(e) {\n\t\tconst searchPhrase = e.target.value\n\t\tconst currentSearchKey = searchPhrase.toLowerCase().trim().substring(0,2)\n\n\t\tif((currentSearchKey.length < 2) && searchKey) {\n\t\t\tonGameFinderFetchCancel()\n\t\t} else if ((currentSearchKey.length === 2) && (currentSearchKey !== searchKey)) {\n\t\t\tonGameFinderFetchRequest(currentSearchKey)\n\t\t}\n\t\tonGameFinderSearchPhrase(searchPhrase)\n\t}\n\treturn (\n\t\t<input \n\t\t\ttype=\"text\" \n\t\t\tplaceholder=\"start typing game name...\"\n\t\t\tvalue={searchPhrase}\n\t\t\tonChange={onSearchPhraseChange}/>\n\t)\n}\n\n\nconst mapStateToProps = ({gameFinder}) => ({\n\tsearchPhrase: gameFinder.searchPhrase,\n\tsearchKey: gameFinder.searchKey\n})\nconst mapDispatchToProps = (dispatch) => ({\n\tonGameFinderSearchPhrase(searchPhrase) {\n\t\tdispatch(gameFinderSearchPhrase(searchPhrase))\n\t},\n\tonGameFinderFetchRequest(searchKey) {\n\t\tdispatch(gameFinderFetchRequest(searchKey))\n\t},\n\tonGameFinderFetchCancel() {\n\t\tdispatch(gameFinderFetchCancel())\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GameFinderInput)","import React from 'react'\n\nfunction GameDummy ({wait, error = 'Game is not in wait or error state'}) {\n\tif(wait) {\n\t\treturn (\n\t\t<div className=\"game\">\n\t\t\t<div>Wait...</div>\n\t\t\t<div>Loading</div>\n\t\t</div>\n\t\t)\n\t} else {\n\t\treturn (\n\t\t\t<div className=\"game\">\n\t\t\t\t<div>Error</div>\n\t\t\t\t<div>{error}</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\nexport default GameDummy","import React from 'react'\n//TODO rename component to game tile\nclass Game extends React.Component {\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"game\">\n\t\t\t\t<div>{this.props.game.platform}</div>\n\t\t\t\t<img className=\"game-img\" src={this.props.game.pic} alt={this.props.game.name}/>\n\t\t\t</div>\n\t\t)\n\t}\n}\nexport default Game","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {gameCacheFetchByIdRequest} from '../actions/game-cache'\nimport GameDummy from './game-dummy'\nimport Game from './game'\n\nfunction GameTile ({gameId, game, fetchWait, fetchError, fetchById}) {\n\tuseEffect(() => {\n\t\tif(!game && !fetchWait && !fetchError) {\n\t\t\tfetchById(gameId)\n\t\t}\n\t})\n\tif(game) {\n\t\treturn <div className=\"game-tile\">\n\t\t\t<Game game={game} gameId={gameId} />\n\t\t</div>\n\t}\n\tconst wait = fetchWait || (!game && !fetchWait && !fetchError)\n\treturn <div className=\"game-tile\">\n\t\t<GameDummy wait={wait} error={fetchError}/>\n\t</div>\n}\n\nconst mapStateToProps = ({gameCache}, {gameId}) => ({\n\tgame: gameCache.games[gameId],\n\twait: gameCache.gamesByIdWait[gameId],\n\terror: gameCache.gamesByIdError[gameId]\n})\n\nconst mapDispatchToProps = dispatch => ({\n\tfetchById(gameId) {\n\t\tdispatch(gameCacheFetchByIdRequest(gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GameTile)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheAddUserGameRequest} from '../actions/user-cache'\nimport {offersAddHideModal} from '../actions/offers-add'\nimport GameTile from './game-tile'\n\nfunction OffersAddSuggestion({game, gameId, userId, user, onUserCacheAddUserGameRequest}) {\n\tconst onClick = () => {\n\t\tonUserCacheAddUserGameRequest(userId, gameId, false)\n\t}\n\treturn (\n\t\t<div className=\"offers-add-suggestion\"\n\t\t onClick={onClick}>\n\t\t\t<GameTile game={game} gameId={gameId}/>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({auth, userCache}) => ({\n\tuserId: auth.authData && auth.authData.uid,\n\tuser: userCache[auth.authData && auth.authData.uid]\n})\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheAddUserGameRequest(userId, gameId, isDemand) {\n\t\tdispatch(userCacheAddUserGameRequest(userId, gameId, isDemand))\n\t\tdispatch(offersAddHideModal())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAddSuggestion) ","import {\n    OFFERS_ADD_SHOW_MODAL,\n    OFFERS_ADD_HIDE_MODAL\n} from '../constants/action-types'\n\n//Actions\nexport function offersAddShowModal(user) {\n\treturn {\n\t\ttype: OFFERS_ADD_SHOW_MODAL,\n\t\tpayload: {user}\n\t}\n}\nexport function offersAddHideModal() {\n\treturn {\n\t\ttype: OFFERS_ADD_HIDE_MODAL\n\t}\n}","import React from 'react'\nimport {connect} from 'react-redux'\nimport OffersAddSuggestion from './offers-add-suggestion.js'\n\nfunction GameFinderOffers ({games}) {\n\tlet rederedResults = []\n\tfor (let gameId in games) {\n\t\trederedResults.push(<OffersAddSuggestion \n\t\t\tgameId={gameId}\n\t\t\tgame={games[gameId]}\n\t\t\tkey={gameId}/>)\n\t}\n\treturn rederedResults\n}\n//TODO same in game-finder results\nconst mapStateToProps = ({gameCache, gameFinder}) => {\n\tlet filteredGames = {}\n\tconst searchPhrase = gameFinder.searchPhrase.toLowerCase()\n\tfor (let gameId in gameCache.games) {\n\t\tlet game = gameCache.games[gameId]\n\t\tlet isSuitable = game.tags.some((tag) => {\n\t\t\treturn tag.toLowerCase().indexOf(searchPhrase) === 0\n\t\t})\n\t\tif(isSuitable) {\n\t\t\tfilteredGames[gameId] = game\n\t\t}\t\n\t}\n\treturn {\n\t\tgames: filteredGames\n\t}\n}\n\nexport default connect(mapStateToProps)(GameFinderOffers)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Modal from './modal'\nimport {offersAddHideModal} from '../actions/offers-add'\nimport GameFinderInput from './game-finder-input'\nimport GameFinderOffers from './game-finder-offers'\n\nconst style = {\n\t'backgroundColor': 'white',\n\t'minHeight': '400px',\n\t'width': '700px',\n\t'padding': '12px',\n\t'textAlign': 'initial'\n}\n\nfunction OffersAddModal({onOffersAddHideModal}) {\n\tconst renderCallback = () => (\n\t\t<div style={style}>\n\t\t\t<h3>Offer a game</h3>\n\t\t\t<select>\n\t\t\t\t<option>PS4</option>\n\t\t\t\t<option>XBOX</option>\n\t\t\t</select>\n\t\t\t<GameFinderInput />\n\t\t\t<div>\n\t\t\t\t<GameFinderOffers />\n\t\t\t</div>\n\t\t</div>\n\t)\n\t\n\treturn (\n\t\t<Modal renderCallback={renderCallback} closeCallback={onOffersAddHideModal}/>\n\t)\n}\n\nconst mapStateToProps = state => ({})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersAddHideModal(){\n\t\tdispatch(offersAddHideModal())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAddModal)","import React from 'react';\nimport {connect} from 'react-redux'\n\nimport AuthModal from './auth-modal'\nimport OffersAddModal from './offers-add-modal'\n\nclass Modals extends React.PureComponent {\n\trender() {\n\t\tif (this.props.authModalShown) {\n\t\t\treturn <AuthModal />\n\t\t} else if (this.props.offersAddModalShown) {\n\t\t\treturn <OffersAddModal />\n\t\t}\n\t\treturn null\n\t}\n}\n\nconst mapStateToProps = ({auth, offersAdd}) => ({\n\tauthModalShown: auth.authModalShown,\n\toffersAddModalShown: offersAdd.modalShown\n})\nexport default connect(mapStateToProps)(Modals)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheFetchByOfferRequest} from '../actions/user-cache'\n\nfunction OffersCounter ({gameId, userCount, wait, error, fetched, onUserCacheFetchByOfferRequest}) {\n\tuseEffect(() => {\n\t\tif(!wait && !fetched) {\n\t\t\tonUserCacheFetchByOfferRequest(gameId)\n\t\t}\n\t}, [gameId, wait, fetched, onUserCacheFetchByOfferRequest])\n\tif(wait) {\n\t\treturn <span>Wait ...</span>\n\t} else if (error) {\n\t\treturn <span>{error.toString()}</span>\n\t} else if (!fetched) {\n\t\treturn false\n\t} else {\n\t\treturn userCount\n\t}\n}\n\nconst mapStateToProps = ({userCache}, {gameId}) => {\n\tconst userCount = Object.values(userCache.users)\n\t\t.filter(user => user && user.offerIds && user.offerIds.indexOf(gameId) >= 0).length\n\treturn {\n\t\tuserCount,\n\t\twait: userCache.usersByOfferWait[gameId],\n\t\terror: userCache.usersByOfferError[gameId],\n\t\tfetched: userCache.usersByOfferFetched[gameId]\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchByOfferRequest(gameId) {\n\t\tdispatch(userCacheFetchByOfferRequest(gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersCounter)","import React from 'react'\nimport {Link} from 'react-router-dom'\nimport {PATH_PAGE_GAME} from '../constants/paths'\nimport GameTile from './game-tile'\nimport OffersCounter from './offers-counter'\nfunction GameFinderResult ({gameId, game}) {\n\tconst gamePagePath = PATH_PAGE_GAME.replace(':gameId', gameId)\n\treturn (<Link to={gamePagePath}>\n\t\t\t<div>\n\t\t\t\t<GameTile gameId={gameId}/>\n\t\t\t\t<OffersCounter gameId={gameId} />\n\t\t\t</div>\n\t\t</Link>)\n}\n\nexport default GameFinderResult","import React from 'react'\nimport GameFinderResult from './game-finder-result'\nfunction GameFinderResults ({games}) {\n\tlet rederedResults = []\n\tfor (let gameId in games) {\n\t\trederedResults.push(<GameFinderResult \n\t\t\tgameId={gameId}\n\t\t\tgame={games[gameId]}\n\t\t\tkey={gameId}/>)\n\t}\n\treturn rederedResults\n}\n\nexport default GameFinderResults","import React from 'react'\nimport {connect} from 'react-redux'\n\nfunction LocationFinderInput () {\n\treturn <input \n\t\t\ttype=\"text\" \n\t\t\tplaceholder=\"Type in the adderss\"/>\n}\n\nconst mapStateToProps = ({statePart}) => ({\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LocationFinderInput)","import React from 'react'\nimport {connect} from 'react-redux'\nimport { Marker, Popup } from 'react-leaflet'\n\nfunction LocationFinderMarker ({position, name}) {\n\tif(!position[0] || !position[1]) {\n\t\treturn (\n\t\t\t<Marker position={[55.7558, 37.6173]}>\n\t\t\t\t<Popup>\n\t\t\t\t\t{'Unknown position ' + name }\n\t\t\t\t</Popup>\n\t\t\t</Marker>\n\t\t)\n\t}\n\treturn (\n\t\t<Marker position={position}>\n\t\t\t<Popup>\n\t\t\t\t{name}\n\t\t\t</Popup>\n\t\t</Marker>\n\t)\n}\n\nconst mapStateToProps = ({statePart}) => ({\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LocationFinderMarker)","import React from 'react'\nimport {connect} from 'react-redux'\nimport { Map, TileLayer} from 'react-leaflet'\nimport LocationFinderMarker from './location-finder-marker'\nimport '../styles/map.css'\nconst style = {\n\twidth: '500px',\n\theight: '500px'\n}\n\nfunction LocationFinderMap ({user, users}) {\n\treturn (<Map center={[55.7558, 37.6173]} zoom={10} style={style} scrollWheelZoom={false}>\n\t\t\t<TileLayer\n\t\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n\t\t\t\turl=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n\t\t\t/>\n\t\t\t{getMarkers(users)}\n\t\t</Map>)\n}\nfunction getMarkers(users) {\n\treturn Object.values(users).map(user => (\n\t\t<LocationFinderMarker key={user.id} name={user.name} position={[user.latitude, user.longitude]}/>\n\t))\n}\n\nconst mapStateToProps = ({auth, userCache}, {games}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\tlet users = {}\n\tfor(let gameId in games) {\n\t\tfor(let userId in userCache.users) {\n\t\t\tlet user = userCache.users[userId]\n\t\t\tif(user && user.offerIds && user.offerIds.indexOf(gameId) >= 0) {\n\t\t\t\tusers[userId] = user\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\treturn {\n\t\tauthData: auth.authData,\n\t\tuser: userCache.users[userId],\n\t\tusers: users\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LocationFinderMap)","import React from 'react'\nimport {connect} from 'react-redux'\nimport GameFinderInput from '../components/game-finder-input'\nimport GameFinderResults from '../components/game-finder-results'\nimport LocationFinderInput from '../components/location-finder-input'\nimport LocationFinderMap from '../components/location-finder-map'\nfunction PageSearch ({games}) {\n\treturn (\n\t\t<div className=\"search-panel\">\n\t\t\t<div className=\"search-panel_part\">\n\t\t\t\t<GameFinderInput />\n\t\t\t\t<GameFinderResults games={games}/>\n\t\t\t</div>\n\t\t\t<div className=\"search-panel_part\">\n\t\t\t\t<LocationFinderInput />\n\t\t\t\t<LocationFinderMap games={games}/>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({gameCache, gameFinder}) => {\n\tlet filteredGames = {}\n\tconst searchPhrase = gameFinder.searchPhrase.toLowerCase()\n\tfor (let gameId in gameCache.games) {\n\t\tlet game = gameCache.games[gameId]\n\t\tlet isSuitable = game.tags.some((tag) => {\n\t\t\treturn tag.toLowerCase().indexOf(searchPhrase) === 0\n\t\t})\n\t\tif(isSuitable) {\n\t\t\tfilteredGames[gameId] = game\n\t\t}\t\n\t}\n\treturn {\n\t\tgames: filteredGames\n\t}\n}\n\nexport default connect(mapStateToProps)(PageSearch)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {offersAddShowModal} from '../actions/offers-add'\n\nfunction OffersAdd({onOffersAddShowModal}) {\n\treturn (\n\t\t\t<div className=\"game-tile\">\n\t\t\t\t<div className=\"game\" onClick={onOffersAddShowModal}>\n\t\t\t\t\t<div>platform</div>\n\t\t\t\t\t<div className=\"game-img\">+</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n}\n\nconst mapStateToProps = state => ({})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersAddShowModal(user) {\n\t\tdispatch(offersAddShowModal(user))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAdd)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheDeleteUserGameRequest} from '../actions/user-cache'\nimport GameTile from './game-tile'\n\nfunction UserGame({gameId, ownerId, authUserId, onOffersDeleteRequest}) {\n\tconst deleteButton = (authUserId === ownerId\n\t\t? <button className=\"offer-delete\"\n\t\t\t\t\tonClick={() => onOffersDeleteRequest(ownerId, gameId)}>\n\t\t\t\t\t\t&times;\n\t\t\t</button> \n\t\t: '')\n\treturn (\n\t\t\t<div className=\"offer\">\n\t\t\t\t<GameTile gameId={gameId}/>\n\t\t\t\t{deleteButton}\n\t\t\t</div>\n\t\t)\n}\nconst mapStateToProps = ({auth}) => ({\n\tauthUserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersDeleteRequest(userId, offerId) {\n\t\tdispatch(userCacheDeleteUserGameRequest(userId, offerId, false))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(UserGame)","import React from 'react'\nimport UserGame from './user-game'\n\nfunction UserGameList({gameIds, ownerId}) {\n\t\n\tif(gameIds && Object.values(gameIds > 0)) { //List not empty\n\t\tconst renderedOffers = []\n\t\t\tfor(let gameId of gameIds) {\n\t\t\trenderedOffers.push(<UserGame gameId={gameId} key={gameId} ownerId={ownerId}/>)\n\t\t}\n\t\treturn renderedOffers\n\t}\n\treturn <h3>Game list is empty...</h3>\n}\n\nexport default UserGameList","import React, {useEffect} from 'react'\nimport { connect } from 'react-redux'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache' \nimport {PATH_PAGE_OFFERS} from '../constants/paths'\nimport OffersAdd from '../components/offers-add'\nimport UserGameList from '../components/user-game-list'\n\nfunction PageOffers({history, match, authData, wait, user, onUserCacheFetchUserByIdRequest}) {\n\tuseEffect(() => {\n\t\tif(authData && match.params.userId) {\n\t\t\tonUserCacheFetchUserByIdRequest(match.params.userId)\n\t\t} else if (authData && !match.params.userId) {\n\t\t\thistory.push(PATH_PAGE_OFFERS.replace(':userId', authData.uid))\n\t\t}\n\t}, [authData, onUserCacheFetchUserByIdRequest, match.params.userId, history])\n\t\n\tif(wait) {\n\t\treturn (<div>Wait...</div>)\n\t} else if (user) {\n\t\tconst isSelf = match.params.userId === (authData && authData.uid)\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{isSelf && <OffersAdd />}\n\t\t\t\t<UserGameList gameIds={user.offerIds} ownerId={match.params.userId}/>\n\t\t\t</div>\n\t\t)\n\t} else {\n\t\treturn false\n\t}\n}\n\nconst mapStateToProps = ({auth, userCache}, {match}) => ({\n\tauthData: auth.authData,\n\twait: userCache.userByIdWait,\n\tuser: userCache.users[match.params.userId]\n\n})\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchUserByIdRequest(userId) {\n\t\treturn dispatch(userCacheFetchUserByIdRequest(userId))\n\t} \n})\nexport default connect(mapStateToProps, mapDispatchToProps)(PageOffers)","import React from 'react'\nimport LoginButton from './login-button'\n\nfunction AskAuthenticate() {\n\treturn (\n\t\t<div>Please Authenticate <LoginButton /></div>\n\t)\n}\n\nexport default AskAuthenticate","import {\n\tUSER_UPDATE_UNSAVED,\n\tUSER_UPDATE_SAVED\n} from '../constants/action-types'\n\nimport {\n\tuserCacheUserUpdate,\n\tuserCacheUserCreate\n} from './user-cache'\n//Actions\nexport function userUpdateUnsaved(user) {\n\treturn {\n\t\ttype: USER_UPDATE_UNSAVED,\n\t\tpayload: {user}\n\t}\n}\nexport function userUpdateSaved(user) {\n\treturn {\n\t\ttype: USER_UPDATE_SAVED,\n\t\tpayload: {user}\n\t}\n}\n//Tunks\n/**\n * Saves user to database\n * @param {String} userId\n * @param {Object} updatedUser\n */\nexport function userUpdateSaveRequest(userId, updatedUser) {\n\treturn dispatch => {\n\t\tconst successCallback = updatedUser => dispatch(userUpdateSaved(updatedUser))\n\t\tdispatch(userCacheUserUpdate(userId, updatedUser, successCallback))\n\t}\n}\n/**\n * Creates user to database\n * @param {String} userId\n * @param {Object} user\n */\nexport function userUpdateCreateRequest(userId, user) {\n\treturn dispatch => {\n\t\tconst successCallback = user => dispatch(userUpdateSaved(user))\n\t\tdispatch(userCacheUserCreate(userId, user, successCallback))\n\t}\n}","import React from 'react';\nimport {connect} from 'react-redux'\nimport {userUpdateUnsaved} from '../actions/user-update'\nfunction ProfileForm({userId, user, updatedUser, isSelf, wait, onNameUpdate}) {\n\tfunction onNameChange(e) {\n\t\tonNameUpdate(user, e.target.value)\n\t}\n\tlet name = ''\n\tif(user && user.name) {\n\t\tname = user.name\n\t}\n\tif(wait) {\n\t\treturn <div>wait...</div>\n\t} else if(isSelf) {\n\t\tif(typeof(updatedUser && updatedUser.name) === 'string') {\n\t\t\tname = updatedUser.name\n\t\t}\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<input\n\t\t\t\t type=\"text\" placeholder=\"name\" value={name} onChange={onNameChange}/>\n\t\t\t</div>\n\t\t)\n\t} else {\n\t\treturn <label> name: {name}</label>\n\t}\n}\n\nconst mapStateToProps = ({userCache, auth, userUpdate}, {userId}) => ({\n\tuser: userCache.users[userId],\n\tupdatedUser: userUpdate.user,\n\tisSelf: auth.authData.uid === userId,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonNameUpdate(user, name) {\n\t\tdispatch(userUpdateUnsaved({\n\t\t\t...user,\n\t\t\tname\n\t\t}))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileForm)","import React from 'react'\n\nfunction ProfileFooter() {\n\treturn <div>Profile footer here</div>\n}\n\nexport default ProfileFooter","import React from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tuserUpdateSaveRequest,\n\tuserUpdateCreateRequest\n} from '../actions/user-update'\nfunction ProfilePanel({userId, isRegistration = false, updatedUser, onProfileUserSaveRequest, onProfileUserCreateRequest}) {\n\tfunction onSave() {\n\t\tif(isRegistration) {\n\t\t\treturn onProfileUserCreateRequest(userId, updatedUser)\n\t\t}\n\t\tonProfileUserSaveRequest(userId, updatedUser)\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<button onClick={onSave}>\n\t\t\t\tSave\n\t\t\t</button>\n\t\t</div>\n\t)\n}\nconst mapStateToProps = ({userCache, auth, userUpdate}, {userId}) => ({\n\tuser: userCache.users[userId],\n\tupdatedUser: userUpdate.user,\n\tisSelf: auth.authData.uid === userId,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonProfileUserSaveRequest(userId, updatedUser) {\n\t\tdispatch(userUpdateSaveRequest(userId, updatedUser))\n\t},\n\tonProfileUserCreateRequest(userId, user) {\n\t\tdispatch(userUpdateCreateRequest(userId, user))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfilePanel)","import React from 'react'\nimport {connect} from 'react-redux'\nimport { Map, TileLayer, Marker, Popup } from 'react-leaflet'\nimport '../styles/map.css'\nconst style = {\n\twidth: '500px',\n\theight: '500px'\n}\nfunction getLocationAndPlaceLabel(user, updatedUser) {\n\tif(updatedUser && (typeof(updatedUser.longitude) === 'number') && (typeof(updatedUser.longitude) ===  'number')) {\n\t\treturn [[updatedUser.latitude, updatedUser.longitude], 'Selected locaction']\n\t}\n\tif(user && (typeof(user.longitude) ===  'number') && (typeof(user.longitude) ===  'number')) {\n\t\treturn [[user.latitude, user.longitude], 'Saved location']\n\t}\n\t//TODO Show selected city longitude\n\treturn [[55.7558, 37.6173], 'Unselected, please specify your location']\n}\nfunction ProfileMap ({user, updatedUser, isSelf, wait}) {\n\t//TODO wait for authorized user object. do not show this component when user is abscent.\n\tconst [location, place] = getLocationAndPlaceLabel(user, updatedUser)\n\treturn (<Map center={location} zoom={18} style={style} scrollWheelZoom={false}>\n\t\t\t<TileLayer\n\t\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n\t\t\t\turl=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n\t\t\t/>\n\t\t\t<Marker position={location}>\n\t\t\t\t<Popup>\n\t\t\t\t\t{place}\n\t\t\t\t</Popup>\n\t\t\t</Marker>\n\t\t</Map>)\n}\nconst mapStateToProps = ({userCache, auth, userUpdate}, {userId}) => ({\n\tuser: userCache.users[userId],\n\tupdatedUser: userUpdate.user,\n\tisSelf: auth.authData.uid === userId,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\n\nexport default connect(mapStateToProps)(ProfileMap)","import {\n\tADDRESS_LOOKUP_CACHE_FETCH,\n\tADDRESS_LOOKUP_CACHE_FETCH_WAIT,\n\tADDRESS_LOOKUP_CACHE_FETCH_ERROR,\n} from '../constants/action-types'\n//Actions\nfunction addressLookupCacheFetch(suggestions) {\n\treturn {\n\t\ttype: ADDRESS_LOOKUP_CACHE_FETCH,\n\t\tpayload: {suggestions}\n\t}\n}\nfunction addressLookupCacheFetchWait(lookupPhrase) {\n\treturn {\n\t\ttype: ADDRESS_LOOKUP_CACHE_FETCH_WAIT,\n\t\tpayload: {lookupPhrase}\n\t}\n}\nfunction addressLookupCacheFetchError(suggestionsFetchError) {\n\treturn {\n\t\ttype: ADDRESS_LOOKUP_CACHE_FETCH_ERROR,\n\t\tpayload: {suggestionsFetchError}\n\t}\n}\n//Thunks\nexport function addressLookupCacheFetchRequest(lookupPhrase) {\n\treturn async dispatch => {\n\t\tconst query = ('https://nominatim.openstreetmap.org?osm_ids=[N]&format=json&limit=5&q=' \n\t\t\t+ encodeURI(lookupPhrase))\n\t\tdispatch(addressLookupCacheFetchWait(lookupPhrase))\n\t\ttry {\n\t\t\tconst response = await fetch(query)\n\t\t\tconst suggestions = await response.json()\n\t\t\tdispatch(addressLookupCacheFetch(suggestions))\n\t\t} catch(suggestionsFetchError) {\n\t\t\tdispatch(addressLookupCacheFetchError(suggestionsFetchError))\n\t\t}\n\t}\n}","import React, {useState, useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {\n\taddressLookupCacheFetchRequest\n} from '../actions/address-lookup-cache'\n\nfunction AddressLookup ({user, updatedUser, isSelf, wait, onAddressLookup}) {\n\tconst [lookupPhrase, setLookupPhrase] = useState('')\n\tuseEffect(() => {\n\t\tif(typeof(updatedUser && updatedUser.place) === 'string') {\n\t\t\tsetLookupPhrase(updatedUser.place)\n\t\t} else if(user && user.place) {\n\t\t\tsetLookupPhrase(user.place)\n\t\t}\n\t},[updatedUser, user])\n\n\tfunction onLookupPhraseChange(e) {\n\t\tsetLookupPhrase(e.target.value)\n\t}\n\tasync function onSearch() {\n\t\tonAddressLookup(lookupPhrase)\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<input type=\"text\" value={lookupPhrase} onChange={onLookupPhraseChange}/>\n\t\t\t<button type=\"button\" onClick={onSearch}>Search</button>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({userCache, auth, userUpdate}, {userId}) => ({\n\tuser: userCache.users[userId],\n\tupdatedUser: userUpdate.user,\n\tisSelf: auth.authData.uid === userId,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonAddressLookup(lookupPhrase) {\n\t\tdispatch(addressLookupCacheFetchRequest(lookupPhrase))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressLookup)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {userUpdateUnsaved} from '../actions/user-update'\n\nfunction AddressSuggestion ({suggestion, user, onLocationUpdate}) {\n\tfunction onLocationClick() {\n\t\tonLocationUpdate(\n\t\t\tuser,\n\t\t\tsuggestion.display_name,\n\t\t\t+suggestion.lon,\n\t\t\t+suggestion.lat\n\t\t)\n\t}\n\treturn (\n\t\t<li onClick={onLocationClick}>{suggestion.display_name}</li>\n\t)\n}\n\nconst mapStateToProps = ({userUpdate}) => ({\n\tuser: userUpdate.user\n})\n\nconst mapDispatchToProps = dispatch => ({\n\tonLocationUpdate(user, place, longitude, latitude){\n\t\tdispatch(userUpdateUnsaved({\n\t\t\t...user,\n\t\t\tplace,\n\t\t\tlongitude,\n\t\t\tlatitude\n\t\t}))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressSuggestion)","import React from 'react'\nimport {connect} from 'react-redux'\nimport AddressSuggestion from './address-suggestion'\n\nfunction AddressSuggestions ({wait, suggestions}) {\n\tif(wait) {\n\t\treturn <div>Loading...</div>\n\t}\n\treturn <ul>{renderSuggestions(suggestions)}</ul>\n\n\tfunction renderSuggestions(suggestions) {\n\t\treturn suggestions.map(suggestion => (\n\t\t\t<AddressSuggestion key={suggestion.place_id} suggestion={suggestion} />\n\t\t\t))\n\t}\n}\n\nconst mapStateToProps = ({addressLookupCache}) => ({\n\twait: addressLookupCache.wait,\n\tsuggestions: addressLookupCache.suggestions\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddressSuggestions)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport ProfileForm from '../components/profile-form'\nimport ProfileFooter from '../components/profile-footer'\nimport ProfilePanel from '../components/profile-panel'\nimport ProfileMap from '../components/profile-map'\nimport AddressLookup from '../components/address-lookup'\nimport AddressSuggestions from '../components/address-suggestions'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache'\n\nfunction PageProfile({match, authData, onUserCacheFetchUserByIdRequest}) {\n\tconst userId = match.params.uid\n\tuseEffect(() => {\n\t\tif(authData) {\n\t\t\tonUserCacheFetchUserByIdRequest(userId)\n\t\t}\n\t})\n\n\tif(!authData) {\n\t\treturn <AskAuthenticate />\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<ProfileForm userId={userId}/>\n\t\t\t<AddressLookup userId={userId}/>\n\t\t\t<AddressSuggestions />\n\t\t\t<ProfileMap userId={userId}/>\n\t\t\t<ProfilePanel userId={userId}/>\n\t\t\t<ProfileFooter />\n\t\t</div>\n\t)\n\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tauthData: auth.authData,\n})\n\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchUserByIdRequest(userId) {\n\t\tdispatch(userCacheFetchUserByIdRequest(userId))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(PageProfile)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport ProfileForm from '../components/profile-form'\nimport ProfilePanel from '../components/profile-panel'\nimport {userUpdateUnsaved} from '../actions/user-update'\nimport {PATH_PAGE_PROFILE} from '../constants/paths'\n\nfunction Registration({history, registeredUser, authData, updatedUser, onProfileUserUnregistered}) {\n\tuseEffect(() => {\n\t\tif(authData && registeredUser) {\n\t\t\thistory.push(PATH_PAGE_PROFILE.replace(':uid', authData.uid))\n\t\t}\n\t\tif(authData && !updatedUser) { //user authenticated\n\t\t\tonProfileUserUnregistered(authData)\n\t\t}\n\t}, [authData, updatedUser, onProfileUserUnregistered, history, registeredUser])\n\tif(!authData) {\n\t\treturn <AskAuthenticate />\n\t} else {\n\t\treturn (\n\t\t<div>\n\t\t\t<ProfileForm userId={authData.uid}/>\n\t\t\t<ProfilePanel userId={authData.uid} isRegistration={true}/>\n\t\t</div>\n\t)\n\t}\n}\n\nconst mapStateToProps = ({userCache, auth, userUpdate}) => ({\n\tregisteredUser: auth.authData && userCache.users[auth.authData.uid],\n\tauthData: auth.authData,\n\tupdatedUser: userUpdate.user,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonProfileUserUnregistered(authData) {\n\t\tconst userUnregistered = {\n\t\t\tname: authData.displayName\n\t\t}\n\t\tdispatch(userUpdateUnsaved(userUnregistered))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(Registration) ","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tCHAT_CACHE_FETCH_BY_PARTICIPANT, //TODO rename all actions to user FETCH_BY_SOMTH\n\tCHAT_CACHE_WAIT_BY_PARTICIPANT,\n\tCHAT_CACHE_ERROR_BY_PARTICIPANT,\n\tCHAT_CACHE_ADD_PUSH,\n\tCHAT_CACHE_ADD_WAIT,\n\tCHAT_CACHE_ADD_ERROR\n} from '../constants/action-types'\nimport {\n\tCOLLECTION_CHATS\n} from '../constants/collection-names'\n//Actions\nfunction chatCacheFetchByParticipant(participantId, chats) {\n\treturn {\n\t\ttype: CHAT_CACHE_FETCH_BY_PARTICIPANT,\n\t\tpayload: {participantId, chats}\n\t}\n}\nfunction chatCacheWaitByParticipant(participantId) {\n\treturn {\n\t\ttype: CHAT_CACHE_WAIT_BY_PARTICIPANT,\n\t\tpayload: {participantId}\n\t}\n}\nfunction chatCacheErrorByParticipant(participantId, chatsByParticipantError) {\n\treturn {\n\t\ttype: CHAT_CACHE_ERROR_BY_PARTICIPANT,\n\t\tpayload: {participantId, chatsByParticipantError}\n\t}\n}\nfunction chatCacheAddPush(chatId, chat) {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_PUSH,\n\t\tpayload: {chatId, chat}\n\t}\n}\nfunction chatCacheAddWait() {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_WAIT\n\t}\n}\nfunction chatCacheAddError(addError) {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_ERROR,\n\t\tpayload: {addError}\n\t}\n}\n//Thunks\n/**\n * Fetches all chats for specified User\n * @param {String} participantId user id of any participant in chat\n */\nexport function chatCacheFetchByParticipantRequest(participantId) {\n\treturn async dispatch => {\n\t\t//TODO triggered multiple times\n\t\tconst query = firebase.firestore().collection(COLLECTION_CHATS)\n\t\t\t.where('participantIds', 'array-contains', participantId)\n\t\tdispatch(chatCacheWaitByParticipant(participantId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst chats = querySnapshot.docs.reduce((chats, doc) => {\n\t\t\t\tchats[doc.id] = doc.data()\n\t\t\t\treturn chats\n\t\t\t}, {})\n\t\t\tdispatch(chatCacheFetchByParticipant(participantId, chats))\n\t\t} catch(chatsByParticipantError) {\n\t\t\tdispatch(chatCacheErrorByParticipant(participantId, chatsByParticipantError))\n\t\t}\n\t}\n}\n/**\n * Creates new chat in chats collection\n * @param {Array} participantIds\n */\nexport function chatCacheAddRequest(participantIds, successCallback) {\n\treturn async dispatch => {\n\t\tconst chat = {participantIds}\n\t\tdispatch(chatCacheAddWait())\n\t\ttry {\n\t\t\tconst chatRef = await firebase.firestore()\n\t\t\t\t.collection(COLLECTION_CHATS).add(chat)\n\t\t\tdispatch(chatCacheAddPush(chatRef.id, chat))\n\t\t\tif(typeof(successCallback) === 'function') {\n\t\t\t\tsuccessCallback(chatRef.id)\n\t\t\t}\n\t\t} catch(addError) {\n\t\t\tdispatch(chatCacheAddError(addError))\n\t\t}\n\t}\n}","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tCLAUSE_CACHE_ADD_PUSH,\n\tCLAUSE_CACHE_ADD_WAIT,\n\tCLAUSE_CACHE_ADD_ERROR,\n\tCLAUSE_CACHE_FETCH_BY_CHAT,\n\tCLAUSE_CACHE_WAIT_BY_CHAT,\n\tCLAUSE_CACHE_ERROR_BY_CHAT,\n\tCLAUSE_CACHE_UPDATE_STATUS,\n\tCLAUSE_CACHE_UPDATE_WAIT,\n\tCLAUSE_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\nimport {\n\tCOLLECTION_CLAUSES\n} from '../constants/collection-names'\nimport {\n\tCLAUSE_STATUS_SUGGESTED,\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\n//Actions\nfunction clauseCacheAddPush(clauseId, clause) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_PUSH,\n\t\tpayload: {clauseId, clause}\n\t}\n}\nfunction clauseCacheAddWait() {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_WAIT\n\t}\n}\nfunction clauseCacheAddError(clauseId, addError) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_ERROR,\n\t\tpayload: {addError}\n\t}\n}\nfunction clauseCacheFetchByChat(chatId, clauses) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_FETCH_BY_CHAT,\n\t\tpayload: {chatId, clauses}\n\t}\n}\nfunction clauseCacheWaitByChat(chatId) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_WAIT_BY_CHAT,\n\t\tpayload: {chatId}\n\t}\n}\nfunction clauseCacheErrorByChat(chatId, clausesByChatError) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ERROR_BY_CHAT,\n\t\tpayload: {\n\t\t\tchatId,\n\t\t\tclausesByChatError\n\t\t}\n\t}\n}\nfunction clauseCacheUpdate(clauseId, clause) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_UPDATE_STATUS,\n\t\tpayload: {\n\t\t\tclauseId,\n\t\t\tclause\n\t\t}\n\t}\n}\nfunction clauseCacheUpdateWait() {\n\treturn {type: CLAUSE_CACHE_UPDATE_WAIT}\n}\nfunction clauseCacheUpdateError(updateError){\n\treturn {type: CLAUSE_CACHE_UPDATE_ERROR}\n}\n//Thunks\n/**\n * Creates clause in db with specified chatId\n * @params {String} chatId\n * @params {String} suggesterId basicly the authenticated user\n * @params {String} respondentId Owner of the offer/demand\n * @params {String} gameId\n * @params {Boolean} isDemand specifies if user is submitting a demand or an offer\n * @params {Function} successCallback\n */\nexport function clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId,\n\t\t\t\t\t\t\t\t\t\tgameId, isDemand, successCallback) {\n\treturn async dispatch => {\n\t\tconst clause = {\n\t\t\tchatId,\n\t\t\townerId,\n\t\t\tsuggesterId,\n\t\t\trespondentId,\n\t\t\tgameId,\n\t\t\tstatus: CLAUSE_STATUS_SUGGESTED,\n\t\t\tisDemand,\n\t\t\tdate: new Date()\n\t\t}\n\t\tdispatch(clauseCacheAddWait())\n\t\ttry {\n\t\t\tconst clauseRef = await firebase.firestore()\n\t\t\t\t.collection(COLLECTION_CLAUSES).add(clause)\n\t\t\tdispatch(clauseCacheAddPush(clauseRef.id, clause))\n\t\t\tif(typeof(successCallback) === 'function') {\n\t\t\t\tsuccessCallback(clauseRef.id)\n\t\t\t}\n\t\t} catch(addError) {\n\t\t\tdispatch(clauseCacheAddError(addError))\n\t\t}\n\t}\n}\n/**\n * Fetches active (suggested and accepted) clauses for specified chat\n * @param chatId {String} chat\n */\nexport function clauseCacheFetchActiveByChatRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_CLAUSES)\n\t\t\t.where('chatId','==', chatId)\n\t\t\t.where('status', 'in', [CLAUSE_STATUS_SUGGESTED, CLAUSE_STATUS_ACCEPTED])\n\t\tdispatch(clauseCacheWaitByChat(chatId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst clauses = querySnapshot.docs.reduce((clauses, doc) => {\n\t\t\t\tclauses[doc.id] = doc.data()\n\t\t\t\treturn clauses\n\t\t\t}, {})\n\t\t\tdispatch(clauseCacheFetchByChat(chatId, clauses))\n\t\t} catch (clausesByChatError) {\n\t\t\tdispatch(clauseCacheErrorByChat(chatId, clausesByChatError))\n\t\t}\n\t}\n}\n/**\n * Changes status for specified clause\n * @param clauseId {String}\n * @param clause {Object} updated clause\n */\nexport function clauseCacheUpdateStatusRequest(clauseId, clause) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore().collection(COLLECTION_CLAUSES)\n\t\t\t.doc(clauseId)\n\t\tdispatch(clauseCacheUpdateWait())\n\t\ttry {\n\t\t\tawait ref.update({\n\t\t\t\tstatus: clause.status\n\t\t\t})\n\t\t\tdispatch(clauseCacheUpdate(clauseId, clause))\n\t\t} catch(updateError) {\n\t\t\tdispatch(clauseCacheUpdateError(updateError))\n\t\t}\n\n\t}\n}","export const CLAUSE_STATUS_SUGGESTED = 'CLAUSE_STATUS_SUGGESTED'\nexport const CLAUSE_STATUS_ACCEPTED = 'CLAUSE_STATUS_ACCEPTED'\nexport const CLAUSE_STATUS_REJECTED = 'CLAUSE_STATUS_REJECTED'\nexport const CLAUSE_STATUS_COMPLETED = 'CLAUSE_STATUS_COMPLETED'","import React, {useEffect, useState} from 'react'\nimport { Redirect } from 'react-router-dom';\nimport {connect} from 'react-redux'\nimport {\n\tchatCacheFetchByParticipantRequest,\n\tchatCacheAddRequest\n} from '../actions/chat-cache'\nimport {\n\tclauseCacheAddRequest\n} from '../actions/clause-cache'\nimport {\n\tPATH_PAGE_CHAT\n} from '../constants/paths'\n\nfunction SubmitToOffer ({ownerId, gameId, authenticatedUserId, fetched, waitFetch, dealChatId,\n\tonChatCacheFetchByParticipantRequest, onChatAndClauseAddRequest, onClauseAddRequest}) {\n\tuseEffect(() => {\n\t\tif(!waitFetch && !fetched) {\n\t\t\tonChatCacheFetchByParticipantRequest(authenticatedUserId) /*TODO fetch somwhere else.\n\t\t\tREDUX updates state (waitFetch, fetched) only after all of this components mounts,\n\t\t\tso each of them triggers this Fetch*/\n\t\t}\n\t}, [authenticatedUserId, fetched, waitFetch, onChatCacheFetchByParticipantRequest])\n\n\tconst [redirectUrl, toggleRedirect] = useState('')\n\n\tfunction onSubmitToOffer() {\n\t\tif(!dealChatId) {\n\t\t\t// TODO User can not create chat with self\n\t\t\tonChatAndClauseAddRequest(ownerId, authenticatedUserId, ownerId, gameId, false, toggleRedirect)\t\t\t\n\t\t} else {\n\t\t\tonClauseAddRequest(dealChatId, ownerId, authenticatedUserId, ownerId, gameId, false, toggleRedirect)\n\t\t}\n\t}\n\tif (redirectUrl) {\n\t\treturn <Redirect to={redirectUrl} />\n\t} else if(!authenticatedUserId) {\n\t\treturn <span>Please authenticate</span>\n\t} else if(waitFetch) {\n\t\treturn <span>loading...</span>\n\t} else if(fetched) {\n\t\treturn <button onClick={onSubmitToOffer}>get</button>\n\t} else {\n\t\treturn false\n\t}\n}\n\nconst mapStateToProps = ({auth, chatCache}, {ownerId}) => {\n\tconst authenticatedUserId = auth.authData && auth.authData.uid\n\t\n\tlet dealChatId = null //Chat beetwen the authenticated user and owner of the game\n\tfor(let chatId in chatCache.chats) {\n\t\tlet chat = chatCache.chats[chatId]\n\t\tif(Array.isArray(chat.participantIds)\n\t\t\t&& (chat.participantIds.indexOf(authenticatedUserId) >= 0)\n\t\t\t&& (chat.participantIds.indexOf(ownerId) >= 0)) {\n\t\t\tdealChatId = chatId\n\t\t\tbreak\n\t\t}\n\t} \n\treturn {\n\t\tauthenticatedUserId,\n\t\tfetched: chatCache.chatsByParticipantFetched[authenticatedUserId],\n\t\twaitFetch: chatCache.chatsByParticipantWait[authenticatedUserId],\n\t\tdealChatId\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonChatCacheFetchByParticipantRequest(participantId) {\n\t\tdispatch(chatCacheFetchByParticipantRequest(participantId))\n\t},\n\tonChatAndClauseAddRequest(ownerId, suggesterId, respondentId, gameId, isDemand, toggleRedirect) {\n\t\tfunction onChatCreatedCallback(chatId) {\n\t\t\tfunction onClauseCreatedCallback(){\n\t\t\t\ttoggleRedirect(PATH_PAGE_CHAT.replace(':chatId', chatId))\n\t\t\t}\n\t\t\tdispatch(clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, onClauseCreatedCallback))\n\t\t}\n\t\tdispatch(chatCacheAddRequest([suggesterId, respondentId], onChatCreatedCallback))\n\t},\n\tonClauseAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, toggleRedirect) {\n\t\tfunction onClauseCreatedCallback(){\n\t\t\ttoggleRedirect(PATH_PAGE_CHAT.replace(':chatId', chatId))\n\t\t}\n\t\tdispatch(clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, onClauseCreatedCallback))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SubmitToOffer)","import React from 'react'\nimport {connect} from 'react-redux'\nimport SubmitToOffer from './submit-to-offer'\nfunction GameOffer ({gameId, userId, ownerId, user}) {\n\tif(userId === ownerId){\n\t\treturn <div>User: {user.name} <small>my offer</small></div>\n\t}\n\treturn <div>User: {user.name} <SubmitToOffer ownerId={ownerId} gameId={gameId}/></div>\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nexport default connect(mapStateToProps)(GameOffer)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheFetchByOfferRequest} from '../actions/user-cache'\nimport GameOffer from './game-offer'\n\nfunction GameOffers ({gameId, users, wait, error, fetched, onUserCacheFetchByOfferRequest}) {\n\tuseEffect(()=> {\n\t\tif(!wait && !fetched) {\n\t\t\tonUserCacheFetchByOfferRequest(gameId)\n\t\t}\n\t}, [gameId, wait, fetched, onUserCacheFetchByOfferRequest])\n\n\tlet renderedOffers = []\n\tfor (let userId in users) {\n\t\trenderedOffers.push(<GameOffer \n\t\t\tgameId={gameId}\n\t\t\tuser={users[userId]}\n\t\t\townerId={userId}\n\t\t\tkey={userId}/>)\n\t}\n\treturn renderedOffers\n}\n\nconst mapStateToProps = ({userCache}, {gameId}) => {\n\tlet users = {}\n\tfor(let userId in userCache.users) {\n\t\tif(userCache.users[userId].offerIds && userCache.users[userId].offerIds.indexOf(gameId) >= 0) {\n\t\t\tusers[userId] = userCache.users[userId]\n\t\t}\n\t}\n\t\n\treturn {\n\t\tusers,\n\t\twait: userCache.usersByOfferWait[gameId],\n\t\terror: userCache.usersByOfferError[gameId],\n\t\tfetched: userCache.usersByOfferFetched[gameId]\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchByOfferRequest(gameId) {\n\t\tdispatch(userCacheFetchByOfferRequest(gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GameOffers)","import React from 'react'\nimport GameTile from '../components/game-tile'\nimport GameOffers from '../components/game-offers'\nfunction PageGame ({match}) {\n\treturn (\n\t\t<div>\n\t\t\t<GameTile gameId={match.params.gameId}/>\n\t\t\t<GameOffers gameId={match.params.gameId}/>\n\t\t</div>\n\t)\n}\n\nexport default PageGame","import React from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport {PATH_PAGE_CHAT} from '../constants/paths'\nfunction Chat ({chatId, chat, userId}) {\n\tconst path = PATH_PAGE_CHAT.replace(':chatId', chatId)\n\treturn (\n\t\t<div>\n\t\t\t<Link to={path}>{chatId}</Link>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({auth}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tuserId\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport Chat from '../components/chat'\nimport {chatCacheFetchByParticipantRequest} from '../actions/chat-cache'\nfunction PageChats ({history, match, userId, wait, error, fetched, chats, fetchChats}) {\n\tuseEffect(() => {\n\t\tif(userId && !wait && !error && !fetched) {\n\t\t\tfetchChats(userId)\n\t\t}\n\t})\n\tif(error) {\n\t\treturn <div>{error.toString()}</div> //Todo universal error handler\n\t}\n\tif(wait) {\n\t\treturn <div>Wait...</div> //TODO universal wait handler\n\t}\n\tconst userChats = filterChatsByParticipant(chats, userId)\n\treturn renderChats(userChats)\n}\nfunction renderChats(userChats) {\n\tlet renderedChats = []\n\tfor (let chatId in userChats) {\n\t\trenderedChats.push(<Chat key={chatId} chatId={chatId} chat={userChats[chatId]}/>)\n\t}\n\treturn renderedChats\n}\nfunction filterChatsByParticipant(chats, userId) {\n\tlet filteredChats = {}\n\tfor(let chatId in chats) {\n\t\tif( chats[chatId] \n\t\t\t&& Array.isArray(chats[chatId].participantIds) \n\t\t\t&& (chats[chatId].participantIds.indexOf(userId) >= 0)) {\n\t\t\tfilteredChats[chatId] = chats[chatId]\n\t\t}\n\t}\n\treturn filteredChats\n}\nconst mapStateToProps = ({auth, chatCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tuserId,\n\t\twait:  chatCache.chatsByParticipantWait[userId],\n\t\terror: chatCache.chatsByParticipantError[userId],\n\t\tfetched: chatCache.chatsByParticipantFetched[userId],\n\t\tchats: chatCache.chats\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tfetchChats(userId) {\n\t\tdispatch(chatCacheFetchByParticipantRequest(userId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageChats)","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tMESSAGE_CACHE_FETCH,\n\tMESSAGE_CACHE_FETCH_WAIT,\n\tMESSAGE_CACHE_FETCH_ERROR,\n\tMESSAGE_CACHE_UPDATE,\n\tMESSAGE_CACHE_UPDATE_CONFIRM,\n\tMESSAGE_CACHE_SUBSCRITION\n} from '../constants/action-types'\nimport {COLLECTION_MESSAGES} from '../constants/collection-names'\n//Actions\nfunction messageCacheFetch(messages) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH,\n\t\tpayload: {\n\t\t\tmessages\n\t\t}\n\t}\n}\nfunction messageCacheFetchWait() {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH_WAIT\n\t}\n}\nfunction messageCacheFetchError(fetchError) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH_ERROR,\n\t\tpayload: {\n\t\t\tfetchError\n\t\t}\n\t}\n}\nfunction messageCacheUpdate(outdatedMessageId, updatedMessage) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_UPDATE,\n\t\tpayload: {\n\t\t\toutdatedMessageId,\n\t\t\tupdatedMessage\n\t\t}\n\t}\n}\nfunction messageCacheUpdateConfirm(confirmedMessageId) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_UPDATE_CONFIRM,\n\t\tpayload: {\n\t\t\tconfirmedMessageId\n\t\t}\n\t}\n}\nfunction messageCacheSubscribe(messagesUnsubscribe) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_SUBSCRITION,\n\t\tpayload: {\n\t\t\tmessagesUnsubscribe\n\t\t}\n\t}\n}\nexport function messageCacheUnsubscribe(messagesUnsubscribe) {\n\tmessagesUnsubscribe()\n\treturn {\n\t\ttype: MESSAGE_CACHE_SUBSCRITION,\n\t\tpayload: {\n\t\t\tmessagesUnsubscribe: null\n\t\t}\n\t}\n}\n//Thunks\n/**\n * Fetches last 100 messages for specified chat\n * @param {String} chatId \n */\nexport function messageCacheFetchRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_MESSAGES)\n\t\t\t.where('chatId','==', chatId)\n\t\t\t.orderBy('sendDate')\n\t\t\t.limit(100)\n\t\tdispatch(messageCacheFetchWait())\n\t\ttry {\n\t\t\tconst queyrSnapshot = await  query.get()\n\t\t\tconst messages = queyrSnapshot.docs.map(doc => ({\n\t\t\t\t...doc.data(),\n\t\t\t\tid: doc.id,\n\t\t\t\tisUpdating: doc.metadata.hasPendingWrites\n\t\t\t}))\n\t\t\tdispatch(messageCacheFetch(messages))\n\t\t} catch(fetchError) {\n\t\t\tdispatch(messageCacheFetchError(fetchError))\n\t\t\tthrow fetchError\n\t\t}\n\t}\n}\n/**\n * Adds message to specified chat.\n * After sending message should be updated via subscription messageCacheSubscribeRequest()\n * @param {String} chatId\n * @param {String} text Message body\n * @param {String} authorId User can add messages as self\n */\nexport function messageCacheSendMessageRequest(chatId, text, authorId) {\n\treturn async dispatch => {\n\t\tconst messageRef = firebase.firestore().collection(COLLECTION_MESSAGES ).doc()\n\t\tconst message = {\n\t\t\tchatId,\n\t\t\ttext,\n\t\t\tauthorId,\n\t\t\tsendDate: firebase.firestore.FieldValue.serverTimestamp(),\n\t\t\tupdateDate: firebase.firestore.FieldValue.serverTimestamp()\n\t\t}\n\t\ttry {\n\t\t\tawait messageRef.set(message)\n\t\t\tdispatch(messageCacheUpdateConfirm(messageRef.id))\n\t\t} catch (sendError) {\n\t\t\tdispatch(messageCacheUpdate(messageRef.id, {\n\t\t\t\tid: messageRef.id,\n\t\t\t\t...message,\n\t\t\t\tsendError\n\t\t\t})) //TODO save to local storage, check date value\n\t\t\tthrow sendError\n\t\t}\n\t}\n}\n/**\n * Sets subscription for specified chat.\n * Updates single message each time it appers updated in database.\n * Dont forget to unsubscribe on chat leave!\n * @param {String} chatId\n */\nexport function messageCacheSubscribeRequest(chatId) {\n\treturn dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_MESSAGES)\n\t\t\t\t.where('chatId', '==', chatId)\n\t\t\t\t.where('updateDate', '>', new Date())\n\t\tconst messagesUnsubscribe = query.onSnapshot(\n\t\t\t\tquerySnapshot => {\n\t\t\t\t\tquerySnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tdispatch(messageCacheUpdate(\n\t\t\t\t\t\t\t\tchange.doc.id,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: change.doc.id,\n\t\t\t\t\t\t\t\t\t...change.doc.data(),\n\t\t\t\t\t\t\t\t\tisUpdating: change.doc.metadata.hasPendingWrites\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tupdateError => {\n\t\t\t\t\tthrow updateError\n\t\t\t\t}\n\t\t\t)\n\t\tdispatch(messageCacheSubscribe(messagesUnsubscribe))\n\t}\n}","import React from 'react'\nimport {connect} from 'react-redux'\n\nfunction Message ({message}) {\n\treturn (\n\t\t<div>{message.text} {getStatusSign(message)}</div>\n\t)\n}\nfunction getStatusSign(message) {\n\tif(message.isUpdating) {\n\t\treturn String.fromCharCode(8987)\n\t}\n\treturn String.fromCharCode(10003)\n}\nconst mapStateToProps = ({statePart}) => ({\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Message)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Message from './message'\nfunction MessageList ({chatId, messages}) {\n\treturn messages.map(message => (\n\t\t<Message key={message.id} message={message} />\n\t\t))\n}\nconst mapStateToProps = ({messageCache}) => ({\n\tmessages: messageCache.messages\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessageList)","import React, {useRef} from 'react'\nimport {connect} from 'react-redux'\nimport {messageCacheSendMessageRequest} from '../actions/message-cache'\nfunction MessageInput ({chatId, userId, onSendMessage}) {\n\tconst inputEl = useRef()\n\tfunction onClick() {\n\t\tonSendMessage(chatId, inputEl.current.value, userId)\n\t\tinputEl.current.value=''\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<input type=\"text\" ref={inputEl} placeholder=\"Type your message here\"/>\n\t\t\t<button type=\"button\" onClick={onClick}>Send</button>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = dispatch => ({\n\tonSendMessage(text, chatId, authorId) {\n\t\tdispatch(messageCacheSendMessageRequest(text, chatId, authorId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessageInput)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport {PATH_PAGE_DEAL} from '../constants/paths.js'\nimport {clauseCacheFetchActiveByChatRequest} from '../actions/clause-cache'\nimport {\n\tmessageCacheFetchRequest,\n\tmessageCacheSubscribeRequest,\n\tmessageCacheUnsubscribe\n} from '../actions/message-cache'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport MessageList from '../components/message-list'\nimport MessageInput from '../components/message-input'\nfunction PageChat ({match, userId, onClauseFetchRequest, onMessagesFetchRequest, onMessagesSubscribe}) {\n\tuseEffect(() => {\n\t\tif(userId && match.params.chatId) {\n\t\t\tonClauseFetchRequest(match.params.chatId)\n\t\t\tonMessagesFetchRequest(match.params.chatId)\n\t\t\tonMessagesSubscribe(match.params.chatId)\n\t\t}\n\t}, [userId, match.params.chatId, onClauseFetchRequest, onMessagesFetchRequest, onMessagesSubscribe])\n\tif(!userId) {\n\t\treturn <AskAuthenticate />\n\t}\n\tconst path = PATH_PAGE_DEAL.replace(':chatId', match.params.chatId)\n\treturn (<div>\n\t\t<Link to={path}>Deal</Link>\n\t\t<MessageList chatId={match.params.chatId}/>\n\t\t<MessageInput chatId={match.params.chatId}/>\n\t</div>)\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = dispatch => ({\n\tonClauseFetchRequest(chatId) {\n\t\tdispatch(clauseCacheFetchActiveByChatRequest(chatId))\n\t},\n\tonMessagesFetchRequest(chatId) {\n\t\tdispatch(messageCacheFetchRequest(chatId))\n\t},\n\tonMessagesSubscribe(chatId) {\n\t\tdispatch(messageCacheSubscribeRequest(chatId))\n\t},\n\tonMessagesUnsubscribe() {\n\t\tdispatch(messageCacheUnsubscribe())\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageChat)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\n\nfunction DealBalance ({chatClausesArray, games, userId}) {\n\treturn <div>Price accepted: {getBalance(chatClausesArray, games, userId, CLAUSE_STATUS_ACCEPTED)}</div>\n}\nfunction getBalance(clausesArray, games, userId, clauseStatus) {\n\treturn clausesArray.reduce((balance, clause) => {\n\t\tif(clause.status !== clauseStatus) {\n\t\t\treturn balance\n\t\t}\n\t\t//TODO IMPORTANT, send error to server money evaluation!\n\t\t//must contain all games\n\t\tconst gamePrice = +(games[clause.gameId].unpackedPrice)\n\t\tif(userId === clause.ownerId) {\n\t\t\treturn balance + gamePrice\n\t\t}\n\t\treturn balance - gamePrice\n\n\t}, 0)\n}\n\nconst mapStateToProps = ({auth, gameCache}) => ({\n\tuserId: auth.authData && auth.authData.uid,\n\tgames: gameCache.games\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DealBalance)","import React from 'react'\nimport {connect} from 'react-redux'\nimport GameTile from './game-tile'\nimport {\n\tCLAUSE_STATUS_REJECTED,\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\nimport {clauseCacheUpdateStatusRequest} from '../actions/clause-cache'\nfunction Clause ({clauseId, clause, userId, acceptClause, rejectClause}) {\n\treturn (\n\t\t<div>\n\t\t\t<GameTile gameId={clause.gameId} />\n\t\t\t{\n\t\t\t\t((clause.respondentId === userId && (clause.status !== CLAUSE_STATUS_ACCEPTED))\n\t\t\t\t\t&& <button onClick={acceptClause}>accept</button>)\n\t\t\t}\n\t\t\t<button onClick={rejectClause}>reject</button>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = (dispatch, {clauseId, clause}) => ({\n\tacceptClause() {\n\t\tdispatch(clauseCacheUpdateStatusRequest(clauseId, {\n\t\t\t...clause,\n\t\t\tstatus: CLAUSE_STATUS_ACCEPTED\n\t\t}))\n\t},\n\trejectClause() {\n\t\tdispatch(clauseCacheUpdateStatusRequest(clauseId, {\n\t\t\t...clause,\n\t\t\tstatus: CLAUSE_STATUS_REJECTED\n\t\t}))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Clause)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Clause from './clause'\n\nfunction DealClauses ({chatClauses}) {\n\tlet renderedClauses = []\n\tfor (let clauseId in chatClauses) {\n\t\tconst renderedClause = <Clause\tkey={clauseId} \n\t\t\t\t\t\t\t\t\t\tclauseId={clauseId}\n\t\t\t\t\t\t\t\t\t\tclause={chatClauses[clauseId]}/> \n\t\trenderedClauses.push(renderedClause)\n\t}\n\treturn renderedClauses\n}\nconst mapStateToProps = ({clauseCache}, {chatId}) => {\n\tlet chatClauses = {}\n\tfor(let clauseId in clauseCache.clauses) {\n\t\tif(chatId && clauseCache.clauses[clauseId] \n\t\t\t&& clauseCache.clauses[clauseId].chatId === chatId) {\n\t\t\tchatClauses[clauseId] = clauseCache.clauses[clauseId]\n\t\t}\n\t}\n\t//TODO check why this mapStateToProps evaluated multiple times\n\treturn {\n\t\tchatClauses\n\t}\n}\n\nexport default connect(mapStateToProps)(DealClauses)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport DealBalance from './deal-balance'\nimport DealClauses from './deal-clauses'\nimport {gameCacheFetchMissingGamesRequest} from '../actions/game-cache'\nfunction Deal ({\n\tchatId,\n\tchatClausesArray,\n\tgames,\n\tgamesByIdWait,\n\tgamesFetchErrors,\n\tisGamesFetched,\n\tisGamesWait,\n\thasAllRequiredGames,\n\tfetchGames\n}) {\n\tuseEffect(()=> {\n\t\tconst gameIds = chatClausesArray.map(clause => clause.gameId)\n\t\tfetchGames(gameIds, games, gamesByIdWait)\n\t})\n\tif(isGamesWait || !isGamesFetched) {\n\t\treturn <div>Wait...</div>\n\t}\n\tif(!hasAllRequiredGames) {\n\t\t//TODO ERROR DISPLAYER\n\t\treturn (<div>\n\t\t\tError fetching Games\n\t\t\t<pre>{JSON.stringify(gamesFetchErrors)}</pre>\n\t\t</div>)\n\t}\n\treturn (<div>\n\t\t<DealClauses chatId={chatId}/>\n\t\t<DealBalance chatClausesArray={chatClausesArray}/>\n\t</div>)\n}\n\nconst mapStateToProps = ({clauseCache, gameCache}, {chatId}) => {\n\tconst chatClausesArray = Object.values(clauseCache.clauses).filter(clause => clause.chatId = chatId)\n\tconst gamesFetchErrors = chatClausesArray.reduce((gamesFetchErrors, clause) => {\n\t\tif(gameCache.gamesByIdError[clause.gameId]) {\n\t\t\treturn [...gamesFetchErrors, gameCache.gamesByIdError[clause.gameId]]\n\t\t}\n\t\treturn gamesFetchErrors\n\t}, [])\n\tconst isGamesFetched = chatClausesArray.every(clause => gameCache.gamesByIdFetched[clause.gameId])\n\tconst isGamesWait = chatClausesArray.some(clause => gameCache.gamesByIdWait[clause.gameId])\n\tconst hasAllRequiredGames = chatClausesArray.every(clause => gameCache.games[clause.gameId])\n\n\treturn {\n\t\tchatClausesArray,\n\t\tgames: gameCache.games,\n\t\tgamesByIdWait: gameCache.gamesByIdWait,\n\t\tgamesFetchErrors,\n\t\tisGamesFetched,\n\t\tisGamesWait,\n\t\thasAllRequiredGames\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tfetchGames(gameIds, games, gamesByIdWait) {\n\t\tdispatch(gameCacheFetchMissingGamesRequest(gameIds, games, gamesByIdWait))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Deal)","/**\n * Shows all active clauses for chat Id with controls\n * displays total balance\n */\nimport React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {clauseCacheFetchActiveByChatRequest} from '../actions/clause-cache'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport Deal from '../components/deal'\n\nfunction PageDeal ({match, userId, clausesByChatWait, onClauseFetchRequest}) {\n\tconst chatId = match.params.chatId\n\tuseEffect(() => {\n\t\tif(userId && match.params.chatId) {\n\t\t\tonClauseFetchRequest(match.params.chatId)\n\t\t}\n\t}, [userId, match.params.chatId, onClauseFetchRequest])\n\t\n\tif(!userId) {\n\t\treturn <AskAuthenticate />\n\t}\n\tif(clausesByChatWait[chatId] !== false) { //TODO check if explicit wait = false is correct, at first it is undefined\n\t\treturn <div>Wait...</div>\n\t}\n\treturn <Deal chatId={chatId} />\n}\n\nconst mapStateToProps = ({auth, clauseCache}) => ({\n\tuserId: auth.authData && auth.authData.uid,\n\tclausesByChatWait: clauseCache.clausesByChatWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonClauseFetchRequest(chatId) {\n\t\tdispatch(clauseCacheFetchActiveByChatRequest(chatId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageDeal)","import React from 'react'\nexport default function NotFound () {\n\treturn <h2>Page not found</h2>\n}","import React from 'react'\nimport { createStore, applyMiddleware, combineReducers } from 'redux'\nimport thunk from 'redux-thunk'\nimport { Provider } from 'react-redux';\nimport { composeWithDevTools } from \"redux-devtools-extension\";\nimport { BrowserRouter, Switch, Route} from 'react-router-dom'\n\n//reducers\nimport offersAdd from './reducers/offers-add'\nimport auth from './reducers/auth'\nimport gameFinder from './reducers/game-finder'\nimport gameCache from './reducers/game-cache'\nimport offerFinder from './reducers/offer-finder'\nimport userCache from './reducers/user-cache'\nimport chatCache from './reducers/chat-cache'\nimport clauseCache from './reducers/clause-cache'\nimport addressLookupCache from './reducers/address-lookup-cache'\nimport userUpdate from './reducers/user-update'\nimport messageCache from './reducers/message-cache'\n\n//initial components\nimport Header from './components/header'\nimport Modals from './components/modals'\n\n//pages components\nimport PageSearch from './pages/page-search'\nimport PageOffers from './pages/page-offers'\nimport PageProfile from './pages/page-profile'\nimport PageRegistration from './pages/page-registration'\nimport PageGame from './pages/page-game'\nimport PageChats from './pages/page-chats'\nimport PageChat from './pages/page-chat'\nimport PageDeal from './pages/page-deal'\nimport PageNotFound from './pages/page-not-found'\n\n//paths\nimport {\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_PROFILE,\n\tPATH_PAGE_OFFERS,\n\tPATH_PAGE_REGISTRATION,\n\tPATH_PAGE_GAME,\n\tPATH_PAGE_CHATS,\n\tPATH_PAGE_CHAT,\n\tPATH_PAGE_DEAL\n} from './constants/paths'\n\n//INIT STORE\nconst rootReducer = combineReducers({\n    offersAdd,\n    auth,\n    gameFinder,\n    gameCache,\n    offerFinder,\n    userCache,\n    chatCache,\n    clauseCache,\n    addressLookupCache,\n    userUpdate,\n    messageCache\n})\n\nconst store = createStore(\n\trootReducer,\n    undefined,\n    composeWithDevTools(applyMiddleware(thunk))\n);\n\n//entry component\nexport default function App() {\n\treturn (\n\t\t<Provider store={store}>\n\t\t\t<BrowserRouter>\n\t\t\t\t<Route component={Header} />\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path=\"/\" component={PageOffers} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_SEARCH} component={PageSearch} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_OFFERS} component={PageOffers} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_PROFILE} component={PageProfile} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_REGISTRATION} component={PageRegistration} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_GAME} component={PageGame} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_CHATS} component={PageChats} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_CHAT} component={PageChat} />\n\t\t\t\t\t<Route exact path={PATH_PAGE_DEAL} component={PageDeal} />\n\t\t\t\t\t<Route component={PageNotFound} />\n\t\t\t\t</Switch>\n\t\t\t\t<Modals/>\n\t\t\t</BrowserRouter>\n\t\t</Provider>\n\t)\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './app';\nimport firebase from 'firebase/app';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css'\n\nconst firebaseConfig = {\n\tapiKey: \"AIzaSyAbxWCNCtF7lm-fmwg00zbAY11aMWPomz0\",\n\tauthDomain: \"unpacked-dev.firebaseapp.com\",\n\tdatabaseURL: \"https://unpacked-dev.firebaseio.com\",\n\tprojectId: \"unpacked-dev\",\n\tstorageBucket: \"unpacked-dev.appspot.com\",\n\tmessagingSenderId: \"1063122406998\",\n\tappId: \"1:1063122406998:web:615fd045afd6407f\"\n};\nfirebase.initializeApp(firebaseConfig)\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}