(this["webpackJsonpunpacked-dev"]=this["webpackJsonpunpacked-dev"]||[]).push([[0],{61:function(e,t,a){e.exports=a(87)},86:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(28),u=a.n(c),o=a(25),i=a(48),s=a(5),l=a(15),d=a(14),f=a(1),p={user:null,modalShown:!1,wait:!1,addError:""},h={authModalShown:!1,subscribed:!1,authData:null,logoutError:"",wait:!1},m={searchPhrase:"",searchKey:"",pendingPromise:null,gamesFetchError:null},b=a(6),E={gamesByIdWait:{},gamesByIdFetched:{},gamesByIdError:{},games:{}},g={offersForGameWait:{},offersForGameFetched:{},offers:{},offersFetchErrors:{}},O={usersByOfferWait:{},usersByOfferFetched:{},usersByOfferError:{},userByIdWait:!1,userByIdError:null,userUpdateWait:!1,userUpdateError:"",users:{}},v={chatsByParticipantWait:{},chatsByParticipantFetched:{},chatsByParticipantError:{},chatsByIdWait:{},chatsByIdFetched:{},chatsByIdError:{},chats:{},chatsLastMessages:{},chatsNames:{},chatAddWait:!1,chatAddError:null};function j(e,t){var a={};for(var n in e)a[n]=t(e[n],n,e);return a}var y={clauses:{},clauseAddWait:!1,clauseAddError:null,clausesByChatWait:{},clausesByChatFetched:{},clausesByChatError:{},clausesUpdateWait:!1,clausesUpdateError:null},C={lookupPhrase:"",suggestions:[],suggestionsFetchWait:!1,suggestionsFetchError:null,suggestionsFetched:!1},I={user:null,isSaved:!0},_=a(22),A={messages:[],messagesFetching:!1,messagesFetched:!1,messagesFetchError:null,messagesUnsubscribe:null},x=Object(o.c)({offersAdd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OFFERS_ADD_SHOW_MODAL":return Object(f.a)(Object(f.a)({},e),{},{modalShown:!0,user:t.payload.user});case"OFFERS_ADD_HIDE_MODAL":return Object(f.a)(Object(f.a)({},e),{},{modalShown:!1,user:null});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_SHOW_MODAL":return Object(f.a)(Object(f.a)({},e),{},{authModalShown:!0});case"AUTH_HIDE_MODAL":return Object(f.a)(Object(f.a)({},e),{},{authModalShown:!1});case"AUTH_SUBSCRIBE":return Object(f.a)(Object(f.a)({},e),{},{subscribed:!0});case"AUTH_LOGIN":return Object(f.a)(Object(f.a)({},e),{},{authModalShown:!1,authData:t.payload.authData});case"AUTH_LOGOUT":return Object(f.a)(Object(f.a)({},e),{},{authData:null,wait:!1});case"AUTH_LOGOUT_WAIT":return Object(f.a)(Object(f.a)({},e),{},{wait:!0,logoutError:""});case"AUTH_LOGOUT_ERROR":return Object(f.a)(Object(f.a)({},e),{},{logoutError:t.payload.logoutError});default:return e}},gameFinder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GAME_FINDER_SEARCH_PHRASE":return Object(f.a)(Object(f.a)({},e),{},{searchPhrase:t.payload.searchPhrase});case"GAME_FINDER_FETCH":return e.pendingPromise===t.payload.pendingPromise?Object(f.a)(Object(f.a)({},e),{},{pendingPromise:null}):e;case"GAME_FINDER_FETCH_WAIT":return Object(f.a)(Object(f.a)({},e),{},{searchKey:t.payload.searchKey,pendingPromise:t.payload.pendingPromise,gamesFetchError:""});case"GAME_FINDER_FETCH_ERROR":return e.pendingPromise===t.payload.pendingPromise?Object(f.a)(Object(f.a)({},e),{},{pendingPromise:null,games:{},gamesFetchError:t.payload.gamesFetchError}):e;case"GAME_FINDER_FETCH_CANCEL":return Object(f.a)(Object(f.a)({},e),{},{pendingPromise:null});default:return e}},gameCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GAME_CACHE_FETCH_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{gamesByIdWait:Object(f.a)(Object(f.a)({},e.gamesByIdWait),{},Object(b.a)({},t.payload.gameId,!1)),gamesByIdFetched:Object(f.a)(Object(f.a)({},e.gamesByIdFetched),{},Object(b.a)({},t.payload.gameId,!0)),games:Object(f.a)(Object(f.a)({},e.games),{},Object(b.a)({},t.payload.gameId,t.payload.game))});case"GAME_CACHE_WAIT_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{gamesByIdWait:Object(f.a)(Object(f.a)({},e.gamesByIdWait),{},Object(b.a)({},t.payload.gameId,!0)),gamesByIdFetched:Object(f.a)(Object(f.a)({},e.gamesByIdFetched),{},Object(b.a)({},t.payload.gameId,!1)),gamesByIdError:Object(f.a)(Object(f.a)({},e.gamesByIdError),{},Object(b.a)({},t.payload.gameId,null))});case"GAME_CACHE_ERROR_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{gamesByIdWait:Object(f.a)(Object(f.a)({},e.gamesByIdWait),{},Object(b.a)({},t.payload.gameId,!1)),gamesByIdFetched:Object(f.a)(Object(f.a)({},e.gamesByIdFetched),{},Object(b.a)({},t.payload.gameId,!0)),gamesByIdError:Object(f.a)(Object(f.a)({},e.gamesByIdError),{},Object(b.a)({},t.payload.gameId,t.payload.gameByIdError))});default:return e}},offerFinder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OFFER_FINDER_FETCH":var a={};for(var n in e.offers)e.offers[n].gameId!==t.payload.gameId&&(a[n]=e.offers[n]);return Object(f.a)(Object(f.a)({},e),{},{offersForGameWait:Object(f.a)(Object(f.a)({},e.offersForGameWait),{},Object(b.a)({},t.payload.gameId,!1)),offersForGameFetched:Object(f.a)(Object(f.a)({},e.offersForGameFetched),{},Object(b.a)({},t.payload.gameId,!0)),offers:Object(f.a)(Object(f.a)({},a),t.payload.offersToAdd)});case"OFFER_FINDER_WAIT":return Object(f.a)(Object(f.a)({},e),{},{offersForGameWait:Object(f.a)(Object(f.a)({},e.offersForGameWait),{},Object(b.a)({},t.payload.gameId,!0)),offersForGameFetched:Object(f.a)(Object(f.a)({},e.offersForGameFetched),{},Object(b.a)({},t.payload.gameId,!1)),offersFetchErrors:Object(f.a)(Object(f.a)({},e.offersFetchErrors),{},Object(b.a)({},t.payload.gameId,""))});case"OFFER_FINDER_ERROR":return Object(f.a)(Object(f.a)({},e),{},{offersForGameWait:Object(f.a)(Object(f.a)({},e.offersForGameWait),{},Object(b.a)({},t.payload.gameId,!1)),offersForGameFetched:Object(f.a)(Object(f.a)({},e.offersForGameFetched),{},Object(b.a)({},t.payload.gameId,!0)),offersFetchErrors:Object(f.a)(Object(f.a)({},e.offersFetchErrors),{},Object(b.a)({},t.payload.gameId,t.payload.offersFetchError))});default:return e}},userCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_CACHE_FETCH_BY_OFFER":return Object(f.a)(Object(f.a)({},e),{},{usersByOfferWait:Object(f.a)(Object(f.a)({},e.usersByOfferWait),{},Object(b.a)({},t.payload.gameId,!1)),usersByOfferFetched:Object(f.a)(Object(f.a)({},e.usersByOfferFetched),{},Object(b.a)({},t.payload.gameId,!0)),users:Object(f.a)(Object(f.a)({},e.users),t.payload.users)});case"USER_CACHE_WAIT_BY_OFFER":return Object(f.a)(Object(f.a)({},e),{},{usersByOfferWait:Object(f.a)(Object(f.a)({},e.usersByOfferWait),{},Object(b.a)({},t.payload.gameId,!0)),usersByOfferFetched:Object(f.a)(Object(f.a)({},e.usersByOfferFetched),{},Object(b.a)({},t.payload.gameId,!1)),usersByOfferError:Object(f.a)(Object(f.a)({},e.usersByOfferError),{},Object(b.a)({},t.payload.gameId,null))});case"USER_CACHE_ERROR_BY_OFFER":return Object(f.a)(Object(f.a)({},e),{},{usersByOfferWait:Object(f.a)(Object(f.a)({},e.usersByOfferWait),{},Object(b.a)({},t.payload.gameId,!1)),usersByOfferFetched:Object(f.a)(Object(f.a)({},e.usersByOfferFetched),{},Object(b.a)({},t.payload.gameId,!0)),usersByOfferError:Object(f.a)(Object(f.a)({},e.usersByOfferError),{},Object(b.a)({},t.payload.gameId,t.payload.usersByOfferError))});case"USER_CACHE_FETCH_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{userByIdWait:!1,users:Object(f.a)(Object(f.a)({},e.users),{},Object(b.a)({},t.payload.userId,t.payload.user))});case"USER_CACHE_WAIT_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{userByIdWait:!0,userByIdError:null});case"USER_CACHE_ERROR_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{userByIdWait:!1,userByIdError:t.payload.userByIdError});case"USER_CACHE_UPDATE":return Object(f.a)(Object(f.a)({},e),{},{userUpdateWait:!1,users:Object(f.a)(Object(f.a)({},e.users),{},Object(b.a)({},t.payload.userId,t.payload.user))});case"USER_CACHE_UPDATE_WAIT":return Object(f.a)(Object(f.a)({},e),{},{userUpdateWait:!0,userUpdateError:!1});case"USER_CACHE_UPDATE_ERROR":return Object(f.a)(Object(f.a)({},e),{},{userUpdateWait:!1,userUpdateError:t.payload.userUpdateError});default:return e}},chatCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHAT_CACHE_FETCH_BY_PARTICIPANT":return Object(f.a)(Object(f.a)({},e),{},{chatsByParticipantWait:Object(f.a)(Object(f.a)({},e.chatsByParticipantWait),{},Object(b.a)({},t.payload.participantId,!1)),chatsByParticipantFetched:Object(f.a)(Object(f.a)({},e.chatsByParticipantFetched),{},Object(b.a)({},t.payload.participantId,!0)),chats:Object(f.a)(Object(f.a)({},e.chats),t.payload.chats),chatsByIdFetched:Object(f.a)(Object(f.a)({},e.chatsByIdFetched),j(t.payload.chats,(function(){return!0})))});case"CHAT_CACHE_WAIT_BY_PARTICIPANT":return Object(f.a)(Object(f.a)({},e),{},{chatsByParticipantWait:Object(f.a)(Object(f.a)({},e.chatsByParticipantWait),{},Object(b.a)({},t.payload.participantId,!0)),chatsByParticipantFetched:Object(f.a)(Object(f.a)({},e.chatsByParticipantFetched),{},Object(b.a)({},t.payload.participantId,!1)),chatsByParticipantError:Object(f.a)(Object(f.a)({},e.chatsByParticipantError),{},Object(b.a)({},t.payload.participantId,null))});case"CHAT_CACHE_ERROR_BY_PARTICIPANT":return Object(f.a)(Object(f.a)({},e),{},{chatsByParticipantWait:Object(f.a)(Object(f.a)({},e.chatsByParticipantWait),{},Object(b.a)({},t.payload.participantId,!1)),chatsByParticipantFetched:Object(f.a)(Object(f.a)({},e.chatsByParticipantFetched),{},Object(b.a)({},t.payload.participantId,!0)),chatsByParticipantError:Object(f.a)(Object(f.a)({},e.chatsByParticipantError),{},Object(b.a)({},t.payload.participantId,t.payload.chatsByParticipantError))});case"CHAT_CACHE_ADD_PUSH":return Object(f.a)(Object(f.a)({},e),{},{chats:Object(f.a)(Object(f.a)({},e.chats),{},Object(b.a)({},t.payload.chatId,t.payload.chat)),chatAddWait:!1});case"CHAT_CACHE_ADD_WAIT":return Object(f.a)(Object(f.a)({},e),{},{chatAddWait:!1,chatAddError:null});case"CHAT_CACHE_ADD_ERROR":return Object(f.a)(Object(f.a)({},e),{},{chatAddWait:!1,chatAddError:t.payload.addError});case"CHAT_CACHE_LAST_MESSAGE_FETCH":return Object(f.a)(Object(f.a)({},e),{},{chatsLastMessages:Object(f.a)(Object(f.a)({},e.chatsLastMessages),{},Object(b.a)({},t.payload.chatId,t.payload.message))});case"CHAT_CACHE_FETCH_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{chats:Object(f.a)(Object(f.a)({},e.chats),{},Object(b.a)({},t.payload.chatId,t.payload.chat)),chatsByIdWait:Object(f.a)(Object(f.a)({},e.chatsByIdWait),{},Object(b.a)({},t.payload.chatId,!1)),chatsByIdFetched:Object(f.a)(Object(f.a)({},e.chatsByIdFetched),{},Object(b.a)({},t.payload.chatId,!0))});case"CHAT_CACHE_WAIT_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{chatsByIdWait:Object(f.a)(Object(f.a)({},e.chatsByIdWait),{},Object(b.a)({},t.payload.chatId,!0)),chatsByIdFetched:Object(f.a)(Object(f.a)({},e.chatsByIdFetched),{},Object(b.a)({},t.payload.chatId,!1)),chatsByIdError:Object(f.a)(Object(f.a)({},e.chatsByIdError),{},Object(b.a)({},t.payload.chatId,null))});case"CHAT_CACHE_ERROR_BY_ID":return Object(f.a)(Object(f.a)({},e),{},{chatsByIdWait:Object(f.a)(Object(f.a)({},e.chatsByIdWait),{},Object(b.a)({},t.payload.chatId,!1)),chatsByIdFetched:Object(f.a)(Object(f.a)({},e.chatsByIdFetched),{},Object(b.a)({},t.payload.chatId,!0)),chatsByIdError:Object(f.a)(Object(f.a)({},e.chatsByIdError),{},Object(b.a)({},t.payload.chatId,t.payload.fetchError))});default:return e}},clauseCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLAUSE_CACHE_ADD_PUSH":return Object(f.a)(Object(f.a)({},e),{},{clauses:Object(f.a)(Object(f.a)({},e.clauses),{},Object(b.a)({},t.payload.clauseId,t.payload.clause)),clauseAddWait:!1});case"CLAUSE_CACHE_ADD_WAIT":return Object(f.a)(Object(f.a)({},e),{},{clauseAddWait:!0,clauseAddError:null});case"CLAUSE_CACHE_ADD_ERROR":return Object(f.a)(Object(f.a)({},e),{},{clauseAddWait:!1,clauseAddError:t.payload.addError});case"CLAUSE_CACHE_FETCH_BY_CHAT":return Object(f.a)(Object(f.a)({},e),{},{clauses:Object(f.a)(Object(f.a)({},e.clauses),t.payload.clauses),clausesByChatWait:Object(f.a)(Object(f.a)({},e.clausesByChatWait),{},Object(b.a)({},t.payload.chatId,!1)),clausesByChatFetched:Object(f.a)(Object(f.a)({},e.clausesByChatFetched),{},Object(b.a)({},t.payload.chatId,!0))});case"CLAUSE_CACHE_WAIT_BY_CHAT":return Object(f.a)(Object(f.a)({},e),{},{clausesByChatWait:Object(f.a)(Object(f.a)({},e.clausesByChatWait),{},Object(b.a)({},t.payload.chatId,!0)),clausesByChatFetched:Object(f.a)(Object(f.a)({},e.clausesByChatFetched),{},Object(b.a)({},t.payload.chatId,!1)),clausesByChatError:Object(f.a)(Object(f.a)({},e.clausesByChatError),{},Object(b.a)({},t.payload.chatId,null))});case"CLAUSE_CACHE_ERROR_BY_CHAT":return Object(f.a)(Object(f.a)({},e),{},{clausesByChatWait:Object(f.a)(Object(f.a)({},e.clausesByChatWait),{},Object(b.a)({},t.payload.chatId,!1)),clausesByChatFetched:Object(f.a)(Object(f.a)({},e.clausesByChatFetched),{},Object(b.a)({},t.payload.chatId,!0)),clausesByChatError:Object(f.a)(Object(f.a)({},e.clausesByChatError),{},Object(b.a)({},t.payload.chatId,t.payload.clausesByChatError))});case"CLAUSE_CACHE_UPDATE_STATUS":return Object(f.a)(Object(f.a)({},e),{},{clauses:Object(f.a)(Object(f.a)({},e.clauses),{},Object(b.a)({},t.payload.clauseId,t.payload.clause)),clausesUpdateWait:!1});case"CLAUSE_CACHE_UPDATE_WAIT":return Object(f.a)(Object(f.a)({},e),{},{clausesUpdateWait:!0,clausesUpdateError:null});case"CLAUSE_CACHE_UPDATE_ERROR":return Object(f.a)(Object(f.a)({},e),{},{clausesUpdateWait:!1,clausesUpdateError:t.payload.updateError});default:return e}},addressLookupCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADDRESS_LOOKUP_CACHE_FETCH":return Object(f.a)(Object(f.a)({},e),{},{suggestions:t.payload.suggestions,suggestionsFetchWait:!1,suggestionsFetched:!0});case"ADDRESS_LOOKUP_CACHE_FETCH_WAIT":return Object(f.a)(Object(f.a)({},e),{},{lookupPhrase:t.payload.lookupPhrase,suggestionsFetchWait:!0,suggestionsFetched:!1});case"ADDRESS_LOOKUP_CACHE_FETCH_ERROR":return Object(f.a)(Object(f.a)({},e),{},{suggestionsFetchWait:!1,suggestionsFetched:!0,suggestionsFetchError:t.payload.suggestionsFetchError});default:return e}},userUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_UPDATE_UNSAVED":return Object(f.a)(Object(f.a)({},e),{},{user:t.payload.user,isSaved:!1});case"USER_UPDATE_SAVED":return Object(f.a)(Object(f.a)({},e),{},{user:t.payload.user,isSaved:!0});default:return e}},messageCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGE_CACHE_FETCH":return Object(f.a)(Object(f.a)({},e),{},{messages:t.payload.messages,messagesFetchFetching:!1,messagesFetched:!0});case"MESSAGE_CACHE_FETCH_WAIT":return Object(f.a)(Object(f.a)({},e),{},{messagesFetchFetching:!0,messagesFetched:!1,messagesFetchError:null});case"MESSAGE_CACHE_FETCH_ERROR":return Object(f.a)(Object(f.a)({},e),{},{messagesFetchFetching:!1,messagesFetched:!0,messagesFetchError:t.payload.fetchError});case"MESSAGE_CACHE_UPDATE":var a=t.payload.outdatedMessageId?e.messages.findIndex((function(e){return e.id===t.payload.outdatedMessageId})):-1;return a>=0?Object(f.a)(Object(f.a)({},e),{},{messages:[].concat(Object(_.a)(e.messages.slice(0,a)),[t.payload.updatedMessage],Object(_.a)(e.messages.slice(a+1)))}):Object(f.a)(Object(f.a)({},e),{},{messages:[].concat(Object(_.a)(e.messages),[t.payload.updatedMessage])});case"MESSAGE_CACHE_UPDATE_CONFIRM":return Object(f.a)(Object(f.a)({},e),{},{messages:e.messages.map((function(e){return e.id===t.payload.confirmedMessageId?Object(f.a)(Object(f.a)({},e),{},{isUpdating:!1}):e}))});case"MESSAGE_CACHE_SUBSCRITION":return Object(f.a)(Object(f.a)({},e),{},{messagesUnsubscribe:t.payload.messagesUnsubscribe});default:return e}}}),F=a(18),w=a(2),D=a(3),B=a(7),U=a.n(B),S=a(11),R=a(4),T=a.n(R);a(39),a(27);function k(e,t){return{type:"USER_CACHE_FETCH_BY_OFFER",payload:{gameId:e,users:t}}}function H(e){return{type:"USER_CACHE_WAIT_BY_OFFER",payload:{gameId:e}}}function W(e,t){return{type:"USER_CACHE_ERROR_BY_OFFER",payload:{gameId:e}}}function P(e,t){return{type:"USER_CACHE_FETCH_BY_ID",payload:{userId:e,user:t}}}function M(e,t){return{type:"USER_CACHE_UPDATE",payload:{userId:e,user:t}}}function L(e){return{type:"USER_CACHE_UPDATE_ERROR",payload:{userUpdateError:e}}}function G(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("users").where("offerIds","array-contains",e),a(H(e)),t.prev=2,t.next=5,n.get();case 5:r=t.sent,c=r.docs.reduce((function(e,t){return e[t.id]=t.data(),e}),{}),a(k(e,c)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),a(W(e,t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}function N(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("users").doc(e),a({type:"USER_CACHE_WAIT_BY_ID"}),t.prev=2,t.next=5,n.get();case 5:r=t.sent,a(P(e,r.data()||null)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),a({type:"USER_CACHE_ERROR_BY_ID",payload:{userByIdError:t.t0}});case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}var Y=Object(s.b)(null,{authShowModal:function(){return{type:"AUTH_SHOW_MODAL"}}})((function(e){var t=e.authShowModal;return r.a.createElement("button",{className:"link",onClick:t},"Login")}));var q=Object(s.b)((function(e){var t=e.auth,a=e.userCache,n=t.authData&&t.authData.uid;return{authData:t.authData,unregistered:null===a.users[n],user:a.users[n]}}))((function(e){var t=e.authData,a=e.unregistered,n=e.user,c=void 0===n?null:n,u=c&&c.name||t.displayName,o=a?"/registration":"/profile/:uid".replace(":uid",t.uid);return r.a.createElement(l.b,{to:o},u)}));var z={authRequestSubscribe:function(){return function(e){T.a.auth().onAuthStateChanged((function(t){t?(e(function(e){return{type:"AUTH_LOGIN",payload:{authData:e}}}(t)),e(N(t.uid))):e({type:"AUTH_LOGOUT"})})),e({type:"AUTH_SUBSCRIBE"})}},authRequestLogout:function(){return function(){var e=Object(S.a)(U.a.mark((function e(t){return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"AUTH_LOGOUT_WAIT"}),e.prev=1,e.next=4,T.a.auth().signOut();case 4:t({type:"AUTH_LOGOUT"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t({type:"AUTH_LOGOUT_ERROR",payload:{logoutError:e.t0}});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}},V=Object(s.b)((function(e){var t=e.auth,a=e.userCache,n=t.authData&&t.authData.uid;return{subscribed:t.subscribed,authData:t.authData,unregistered:null===a.users[n],wait:t.wait||a.userByIdWait}}),z)((function(e){var t=e.subscribed,a=e.authData,c=e.unregistered,u=e.wait,o=e.authRequestSubscribe,i=e.authRequestLogout;Object(n.useEffect)((function(){t||o()}),[t,o]);var s=Object(d.g)("/registration");return u?"Loading...":c&&(null===a||void 0===a?void 0:a.uid)&&!s?r.a.createElement(d.a,{to:"/registration"}):!c&&(null===a||void 0===a?void 0:a.uid)&&s?r.a.createElement(d.a,{to:"/profile/:uid".replace(":uid",a.uid)}):a?r.a.createElement(n.Fragment,null,r.a.createElement(q,null),r.a.createElement("button",{onClick:i},"Logout")):r.a.createElement(Y,null)}));var K=Object(s.b)((function(e){var t;return{userId:null===(t=e.auth.authData)||void 0===t?void 0:t.uid}}))((function(e){var t=e.userId;return r.a.createElement(n.Fragment,null,r.a.createElement("nav",null,r.a.createElement(l.b,{to:"/search"},"Find games"),t&&r.a.createElement(l.b,{to:"/offers/:userId".replace(":userId",t)},"My games"),r.a.createElement(l.b,{to:"/chats"},"Deals")),r.a.createElement("nav",null,r.a.createElement(V,null)))}));var J=function(){var e="";return Object(d.g)("/profile/:uid")&&(e="Profile"),Object(d.g)("/search")&&(e="Find games"),Object(d.g)("/offers/:userId")&&(e="Offers"),Object(d.g)("/registration")&&(e="Registration"),Object(d.g)("/game/:gameId")&&(e="Find games"),Object(d.g)("/chats")&&(e="Deals"),Object(d.g)("/chats/:chatId")&&(e="Deals"),e};function X(){var e=Object(w.a)(["\n\tcursor: pointer;\n\theight: 50px;\n\twidth: 60px;\n\tuser-select: none;\n\tbackground: none;\n\tcolor: inherit;\n\tborder: none;\n\tpadding: 0;\n\tfont: inherit;\n\toutline: inherit;\n\t@media (min-width: 768px) {\n\t\tdisplay: none;\n\t}\n"]);return X=function(){return e},e}var Z=D.a.button(X());var $=function(e){return r.a.createElement(Z,Object.assign({},e,{type:"button"}),r.a.createElement("svg",{width:"20",height:"14",viewBox:"0 0 20 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("line",{x1:"1",y1:"1",x2:"19",y2:"1",stroke:"white",strokeWidth:"2",strokeLinecap:"round"}),r.a.createElement("line",{x1:"1",y1:"7",x2:"19",y2:"7",stroke:"white",strokeWidth:"2",strokeLinecap:"round"}),r.a.createElement("line",{x1:"1",y1:"13",x2:"19",y2:"13",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})))};function Q(){var e=Object(w.a)(["\n\tmargin: 0;\n\tpadding: 0;\n\tline-height: 50px;\n\tfont-size: inherit;\n\tfont-weight: normal;\n\ttext-transform: uppercase;\n\t@media(min-width: 768px) {\n\t\tdisplay: none;\n\t}\n"]);return Q=function(){return e},e}function ee(){var e=Object(w.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tflex-grow: 1;\n\t@media(max-width: 767px) {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tflex-direction: column;\n\t\ttop: 50px;\n\t\tright: 0;\n\t\tpadding: 0 10px;\n\t\tbackground-color: #13131D;\n\t\topacity: .9;\n\t\t","\n\t\t> nav {\n\t\t\tdisplay: flex;\n\t\t\talign-items: flex-end;\n\t\t\tflex-direction: column;\n\t\t}\n\t}\n"]);return ee=function(){return e},e}function te(){var e=Object(w.a)(["\n\tline-height: 50px;\n\twidth: 60px;\n"]);return te=function(){return e},e}function ae(){var e=Object(w.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tposition: relative;\n"]);return ae=function(){return e},e}var ne=D.a.header(ae()),re=D.a.div(te()),ce=D.a.div(ee(),(function(e){return!e.isToggled&&"\n\t\t\t\tdisplay: none;\n\t\t\t"})),ue=D.a.h1(Q());var oe=function(){var e=Object(n.useState)(!1),t=Object(F.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){function e(){c(!1)}return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[c]),r.a.createElement(ne,null,r.a.createElement(re,null,"U-D"),r.a.createElement(ce,{isToggled:a},r.a.createElement(K,null)),r.a.createElement(ue,null,r.a.createElement(J,null)),r.a.createElement($,{onClick:function(e){e.stopPropagation(),c(!a)}}))},ie=a(53),se=a(54),le=a(59),de=a(58),fe=a(55),pe=a.n(fe),he=a(40);function me(){var e=Object(w.a)(["\n\tdisplay: inline-block;\n\tmargin: 2rem;\n"]);return me=function(){return e},e}function be(){var e=Object(w.a)(["\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\toverflow: auto;\n\tbackground-color: rgba(0, 0, 0, 0.8);\n\ttext-align: center;\n"]);return be=function(){return e},e}var Ee=D.a.div(be()),ge=D.a.div(me());var Oe=function(e){var t=e.closeCallback,a=e.children;return Object(n.useEffect)((function(){return window.scrollY&&(document.body.style.top="-".concat(window.scrollY,"px")),document.body.style.width="100%",document.body.style.position="fixed",function(){var e=document.body.style.top;e&&(window.scrollTo(0,parseFloat(e.replace("-","").replace("px",""))),document.body.style.top=""),document.body.style.width="",document.body.style.position=""}})),Object(n.useEffect)((function(){function e(e){"Escape"===e.key&&t&&t(e)}return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}})),r.a.createElement(Ee,{onClick:function(e){t&&e.target===e.currentTarget&&t(e)}},r.a.createElement(ge,null,a))};function ve(){var e=Object(w.a)(["\n\tcolor: unset;\n\t& input {\n\t\tcolor: unset;\n\t}\n"]);return ve=function(){return e},e}var je={signInFlow:"popup",signInOptions:[T.a.auth.GoogleAuthProvider.PROVIDER_ID,T.a.auth.EmailAuthProvider.PROVIDER_ID],credentialHelper:he.auth.CredentialHelper.NONE,callbacks:{signInSuccessWithAuthResult:function(){return!1}}},ye=D.a.div(ve());var Ce=Object(s.b)(null,{authHideModal:function(){return{type:"AUTH_HIDE_MODAL"}}})((function(e){var t=e.authHideModal;return r.a.createElement(Oe,{closeCallback:t},r.a.createElement(ye,null,r.a.createElement(pe.a,{uiConfig:je,firebaseAuth:T.a.auth()})))}));function Ie(e,t){return{type:"GAME_CACHE_FETCH_BY_ID",payload:{gameId:e,game:t}}}function _e(e){return{type:"GAME_CACHE_WAIT_BY_ID",payload:{gameId:e}}}function Ae(e,t){return{type:"GAME_CACHE_ERROR_BY_ID",payload:{gameId:e,gameByIdError:t}}}function xe(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("games").doc(e),a(_e(e)),t.prev=2,t.next=5,n.get();case 5:if((r=t.sent).exists){t.next=8;break}throw new Error("Could not find game for gameId: "+e);case 8:a(Ie(e,r.data())),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),a(Ae(e,t.t0));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}function Fe(e){return{type:"GAME_FINDER_FETCH",payload:{pendingPromise:e}}}function we(e,t){return{type:"GAME_FINDER_FETCH_WAIT",payload:{searchKey:e,pendingPromise:t}}}function De(e,t){return{type:"GAME_FINDER_FETCH_ERROR",payload:{gamesFetchError:e,pendingPromise:t}}}function Be(){var e=Object(w.a)(["\n\tmin-width: 50px;\n\tbackground: none;\n\tcolor: black;\n\tbackground-color: #FDE74C;\n\tborder: none;\n"]);return Be=function(){return e},e}function Ue(){var e=Object(w.a)(["\n\tflex-grow: 1;\n\tbackground: none;\n\tborder: none;\n\toutline: none;\n\t::placeholder {\n\t\tcolor: #454651;;\n\t}\n"]);return Ue=function(){return e},e}function Se(){var e=Object(w.a)(["\n\twidth: 30px;\n\t> * {\n\t\tvertical-align: middle;\n\t}\n"]);return Se=function(){return e},e}function Re(){var e=Object(w.a)(["\n\tdisplay: flex;\n\theight: 50px;\n\tline-height: 50px;\n\tmargin: 16px 0;\n\tpadding-left: 15px;\n\tbackground-color: #191A24;\n\t","\n\tposition: relative;\n"]);return Re=function(){return e},e}var Te=D.a.form(Re(),(function(e){return e.readonly&&"\n\t\tpadding-left: 0;\n\t\tbackground: none;\n\t"})),ke=D.a.span(Se()),He=D.a.input(Ue()),We=D.a.button(Be());function Pe(e){var t=e.icon;return t?r.a.createElement(ke,null,t):null}function Me(e){var t=e.submitLabel,a=e.readonly;return!t||a?null:r.a.createElement(We,{type:"submit"},t)}var Le=function(e){var t=e.value,a=e.onChange,n=e.onSubmit,c=void 0===n?function(e){return e.preventDefault()}:n,u=e.submitLabel,o=void 0===u?null:u,i=e.icon,s=void 0===i?null:i,l=e.placeholder,d=void 0===l?"type in value":l,f=e.readonly;return r.a.createElement(Te,{onSubmit:function(e){e.preventDefault(),c&&!f&&c(t)},readonly:f},r.a.createElement(Pe,{icon:s}),r.a.createElement(He,{type:"text",value:t,onChange:function(e){return a(e.target.value)},placeholder:d,readonly:f}),r.a.createElement(Me,{submitLabel:o,readonly:f}))},Ge=function(){return r.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{cx:"7.91625",cy:"7.91625",r:"6.91625",stroke:"currentColor",strokeWidth:"2"}),r.a.createElement("line",{x1:"12.8382",y1:"13.5681",x2:"17.8559",y2:"18.5858",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))};var Ne=Object(s.b)((function(e){var t=e.gameFinder;return{searchPhrase:t.searchPhrase,searchKey:t.searchKey}}),(function(e){return{onGameFinderSearchPhrase:function(t){e(function(e){return{type:"GAME_FINDER_SEARCH_PHRASE",payload:{searchPhrase:e}}}(t))},onGameFinderFetchRequest:function(t){e(function(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=T.a.firestore().collection("games").where("searchKeys","array-contains",e),(r=n.get()).then((function(e){var t=e.docs.reduce((function(e,t){return e[t.id]=t.data(),e}),{});for(var n in a(Fe(r)),t)a(Ie(n,t[n]))}),(function(e){a(De(e,r))})),a(we(e,r));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},onGameFinderFetchCancel:function(){e({type:"GAME_FINDER_FETCH_CANCEL"})}}}))((function(e){var t=e.searchPhrase,a=e.searchKey,n=e.onGameFinderSearchPhrase,c=e.onGameFinderFetchRequest,u=e.onGameFinderFetchCancel;return r.a.createElement(Le,{value:t,placeholder:"start typing game name",onChange:function(e){var t=e.toLowerCase().trim().substring(0,2);t.length<2&&a?u():2===t.length&&t!==a&&c(t),n(e)},icon:r.a.createElement(Ge,null)})})),Ye=a(31);function qe(){var e=Object(w.a)(["\n\tmargin: auto;\n"]);return qe=function(){return e},e}function ze(){var e=Object(w.a)(["\n\tdisplay: inline-flex;\n\theight: 100%;\n\twidth: 100%;\n"]);return ze=function(){return e},e}var Ve=D.a.span(ze()),Ke=D.a.span(qe());var Je=function(){return r.a.createElement(Ve,null,r.a.createElement(Ke,null,"Loading..."))};function Xe(){var e=Object(w.a)(["\n\tpadding: 10px;\t\n"]);return Xe=function(){return e},e}function Ze(){var e=Object(w.a)(["\n\tdisplay: inline-flex;\n\theight: 100%;\n\twidth: 100%;\n"]);return Ze=function(){return e},e}var $e=D.a.span(Ze()),Qe=D.a.pre(Xe());var et=function(e){var t=e.error,a=t&&t.toString&&t.toString()||t||"Error happened";return r.a.createElement($e,null,r.a.createElement(Qe,null,a))};var tt=Object(s.b)((function(e,t){var a=e.gameCache,n=t.gameId;return{game:a.games[n],wait:a.gamesByIdWait[n],error:a.gamesByIdError[n]}}),(function(e){return{fetchById:function(t){e(xe(t))}}}))((function(e){var t=e.gameId,a=e.Component,c=e.CompoenentWait,u=void 0===c?Je:c,o=e.ComponentError,i=void 0===o?et:o,s=e.game,l=e.fetchWait,d=e.fetchError,f=e.fetchById,p=Object(Ye.a)(e,["gameId","Component","CompoenentWait","ComponentError","game","fetchWait","fetchError","fetchById"]);return Object(n.useEffect)((function(){s||l||d||f(t)}),[t,s,l,d,f]),d?r.a.createElement(i,{gameId:t,error:d}):s?r.a.createElement(a,Object.assign({gameId:t,game:s},p)):r.a.createElement(u,{gameId:t})}));function at(){var e=Object(w.a)(["\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n"]);return at=function(){return e},e}function nt(){var e=Object(w.a)(["\n\tdisplay: block;\n\tborder-top: 1px solid white;\n\tbackground-color: black;\n\tpadding-bottom: 10%;\n\twidth: 100%;\n\ttext-align: center;\n"]);return nt=function(){return e},e}function rt(){var e=Object(w.a)(["\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tflex-shrink: 0;\n\tbackground-color: #154ea3;\n\tborder #3b64b1 solid 2px;\n\tborder-radius: 3px;\n\tcolor: white;\n\ttext-align: left;\n\tfont-size: 12px;\n\theight: 88px;\n\twidth: 66px;\n\t","\n"]);return rt=function(){return e},e}var ct=D.a.div(rt(),(function(e){return e.isBig&&"\n\t\theight: 264px;\n\t\twidth: 198px;\n\t\tborder-width: 4px;\n\t\tborder-radius: 6px;\n\t\tfont-size: 16px;\n\t"})),ut=D.a.img(nt()),ot=D.a.div(at());var it=function(e){var t=e.game,a=e.isBig,n=e.onClick;return r.a.createElement(ct,{isBig:a,onClick:n},r.a.createElement("div",null,t.platform),t.pic&&r.a.createElement(ut,{src:t.pic,alt:t.name}),t.icon&&r.a.createElement(ot,null,t.icon))};var st=Object(s.b)((function(e){var t=e.auth,a=e.userCache;return{userId:t.authData&&t.authData.uid,user:a[t.authData&&t.authData.uid]}}),(function(e){return{onUserCacheAddUserGameRequest:function(t,a,n){e(function(e,t,a){return function(){var n=Object(S.a)(U.a.mark((function n(r){var c,u,o,i;return U.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=T.a.firestore().collection("users").doc(e),r({type:"USER_CACHE_UPDATE_WAIT"}),n.prev=2,n.next=5,c.get();case 5:if(u=n.sent,(o=u.data())[i=a?"demandIds":"offerIds"]&&!(o[i].indexOf(t)<0)){n.next=13;break}return n.next=11,c.update(Object(b.a)({},i,T.a.firestore.FieldValue.arrayUnion(t)));case 11:o[i]=o[i]||[],o[i].push(t);case 13:r(M(e,o)),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(2),r(L(n.t0));case 19:case"end":return n.stop()}}),n,null,[[2,16]])})));return function(e){return n.apply(this,arguments)}}()}(t,a,n)),e({type:"OFFERS_ADD_HIDE_MODAL"})}}}))((function(e){var t=e.gameId,a=e.userId,n=e.onUserCacheAddUserGameRequest;return r.a.createElement("div",{className:"offers-add-suggestion"},r.a.createElement(tt,{gameId:t,Component:it,onClick:function(){n(a,t,!1)}}))}));var lt=Object(s.b)((function(e){var t=e.gameCache,a={},n=e.gameFinder.searchPhrase.toLowerCase();for(var r in t.games){var c=t.games[r];c.tags.some((function(e){return 0===e.toLowerCase().indexOf(n)}))&&(a[r]=c)}return{games:a}}))((function(e){var t=e.games,a=[];for(var n in t)a.push(r.a.createElement(st,{gameId:n,game:t[n],key:n}));return a})),dt={backgroundColor:"white",minHeight:"400px",width:"700px",padding:"12px",textAlign:"initial"};var ft=Object(s.b)((function(e){return{}}),(function(e){return{onOffersAddHideModal:function(){e({type:"OFFERS_ADD_HIDE_MODAL"})}}}))((function(e){var t=e.onOffersAddHideModal;return r.a.createElement(Oe,{renderCallback:function(){return r.a.createElement("div",{style:dt},r.a.createElement("h3",null,"Offer a game"),r.a.createElement("select",null,r.a.createElement("option",null,"PS4"),r.a.createElement("option",null,"XBOX")),r.a.createElement(Ne,null),r.a.createElement("div",null,r.a.createElement(lt,null)))},closeCallback:t})})),pt=function(e){Object(le.a)(a,e);var t=Object(de.a)(a);function a(){return Object(ie.a)(this,a),t.apply(this,arguments)}return Object(se.a)(a,[{key:"render",value:function(){return this.props.authModalShown?r.a.createElement(Ce,null):this.props.offersAddModalShown?r.a.createElement(ft,null):null}}]),a}(r.a.PureComponent),ht=Object(s.b)((function(e){var t=e.auth,a=e.offersAdd;return{authModalShown:t.authModalShown,offersAddModalShown:a.modalShown}}))(pt);function mt(e,t){return{type:"CHAT_CACHE_FETCH_BY_PARTICIPANT",payload:{participantId:e,chats:t}}}function bt(e){return{type:"CHAT_CACHE_WAIT_BY_PARTICIPANT",payload:{participantId:e}}}function Et(e,t){return{type:"CHAT_CACHE_ERROR_BY_PARTICIPANT",payload:{participantId:e,chatsByParticipantError:t}}}function gt(e,t){return{type:"CHAT_CACHE_ADD_PUSH",payload:{chatId:e,chat:t}}}function Ot(e){return{type:"CHAT_CACHE_LAST_MESSAGE_FETCH",payload:{chatId:e.chatId,message:e}}}function vt(e,t){return{type:"CHAT_CACHE_FETCH_BY_ID",payload:{chatId:e,chat:t}}}function jt(e){return{type:"CHAT_CACHE_WAIT_BY_ID",payload:{chatId:e}}}function yt(e,t){return{type:"CHAT_CACHE_ERROR_BY_ID",payload:{chatId:e,fetchError:t}}}function Ct(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("chats").where("participantIds","array-contains",e),a(bt(e)),t.prev=2,t.next=5,n.get();case 5:r=t.sent,c=r.docs.reduce((function(e,t){return e[t.id]=t.data(),e}),{}),a(mt(e,c)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),a(Et(e,t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}function It(e){return{type:"MESSAGE_CACHE_FETCH",payload:{messages:e}}}function _t(e,t){return{type:"MESSAGE_CACHE_UPDATE",payload:{outdatedMessageId:e,updatedMessage:t}}}var At=Object(s.b)((function(e){var t=e.auth,a=e.messageCache;return{userId:t.authData&&t.authData.uid,messagesUnsubscribe:a.messagesUnsubscribe}}),(function(e){return{onMessagesSubscribe:function(t){e(function(e){return function(t){var a=T.a.firestore().collection("messages").where("recipientId","==",e).where("updateDate",">",new Date).onSnapshot((function(e){e.docChanges().forEach((function(e){var a=e.doc.data();t(_t(e.doc.id,Object(f.a)(Object(f.a)({id:e.doc.id},a),{},{sendDate:a.sendDate.toDate(),updateDate:a.updateDate.toDate(),isUpdating:e.doc.metadata.hasPendingWrites}))),t(Ot(e.doc.data()))}))}),(function(e){throw e}));t(function(e){return{type:"MESSAGE_CACHE_SUBSCRITION",payload:{messagesUnsubscribe:e}}}(a))}}(t))},onMessagesUnsubscribe:function(t){e(function(e){return e(),{type:"MESSAGE_CACHE_SUBSCRITION",payload:{messagesUnsubscribe:null}}}(t))}}}))((function(e){var t=e.userId,a=e.messagesUnsubscribe,r=e.onMessagesSubscribe,c=e.onMessagesUnsubscribe;return Object(n.useEffect)((function(){t&&!a&&r(t),!t&&a&&c(a)})),null}));function xt(){var e=Object(w.a)(["\n\tmargin-top: 12px;\n\tline-height: 12px;\n\tcolor:#5F606C;\n\ttext-transform: none;\n"]);return xt=function(){return e},e}function Ft(){var e=Object(w.a)(["\n\tmargin: 20px;\n\tpadding: 12px 0;\n\tborder-top: 1px solid #454651;\n\tfont-size: 12px;\n\tline-height: 24px;\n\ttext-align: center;\n\ttext-transform: uppercase;\n\tgrid-row-start: 3;\n  \tgrid-row-end: 4;\n"]);return Ft=function(){return e},e}var wt=D.a.footer(Ft()),Dt=D.a.div(xt());var Bt=function(){return r.a.createElement(wt,null,r.a.createElement("div",null,r.a.createElement(l.b,{to:"/search"},"Find games")),r.a.createElement("div",null,r.a.createElement(l.b,{to:"/chats"},"Deals")),r.a.createElement(Dt,null,"Unpacked 2020. All rights reserved."))};var Ut=Object(s.b)((function(e,t){var a=e.userCache,n=t.gameId;return{userCount:Object.values(a.users).filter((function(e){return e&&e.offerIds&&e.offerIds.indexOf(n)>=0})).length,wait:a.usersByOfferWait[n],error:a.usersByOfferError[n],fetched:a.usersByOfferFetched[n]}}),(function(e){return{onUserCacheFetchByOfferRequest:function(t){e(G(t))}}}))((function(e){var t=e.gameId,a=e.userCount,c=e.wait,u=e.error,o=e.fetched,i=e.onUserCacheFetchByOfferRequest;return Object(n.useEffect)((function(){c||o||i(t)}),[t,c,o,i]),c?r.a.createElement("span",null,"Wait ..."):u?r.a.createElement("span",null,u.toString()):!!o&&a}));function St(){var e=Object(w.a)(["\n\tcolor: white;\n\tflex-grow: 1;\n"]);return St=function(){return e},e}function Rt(){var e=Object(w.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex-grow: 1;\n\tcolor: #5F606C;\n\tpadding-left: 20px;\n"]);return Rt=function(){return e},e}function Tt(){var e=Object(w.a)(["\n\tborder: 1px solid #5F606C;\n\theight: 88px;\n\tmargin: 10px 0;\n\tpadding: 20px;\n\tdisplay: flex;\n"]);return Tt=function(){return e},e}var kt=D.a.div(Tt()),Ht=D.a.div(Rt()),Wt=D.a.div(St());function Pt(e){var t=e.gameId,a=e.game;return r.a.createElement(n.Fragment,null,r.a.createElement(it,{game:a}),r.a.createElement(Ht,null,r.a.createElement(Wt,null,a.name),r.a.createElement("div",null,a.platform),r.a.createElement("div",null,"Offers found: ",r.a.createElement(Ut,{gameId:t}))))}var Mt=function(e){var t=e.gameId;return r.a.createElement(l.b,{to:"/game/:gameId".replace(":gameId",t)},r.a.createElement(kt,null,r.a.createElement(tt,{gameId:t,Component:Pt})))};var Lt=function(e){var t=e.games,a=[];for(var n in t)a.push(r.a.createElement(Mt,{gameId:n,game:t[n],key:n}));return a};function Gt(){var e=Object(w.a)(["\n\tpadding: 0 20px;\n"]);return Gt=function(){return e},e}var Nt=D.a.div(Gt());var Yt=Object(s.b)((function(e){var t=e.gameCache,a={},n=e.gameFinder.searchPhrase.toLowerCase();for(var r in t.games){var c=t.games[r];c.tags.some((function(e){return 0===e.toLowerCase().indexOf(n)}))&&(a[r]=c)}return{games:a}}))((function(e){var t=e.games;return r.a.createElement(n.Fragment,null,r.a.createElement(Nt,null,r.a.createElement(Ne,null),r.a.createElement(Lt,{games:t})),r.a.createElement(Bt,null))}));var qt=Object(s.b)((function(e){return{}}),(function(e){return{onOffersAddShowModal:function(t){e(function(e){return{type:"OFFERS_ADD_SHOW_MODAL",payload:{user:e}}}(t))}}}))((function(e){var t=e.onOffersAddShowModal;return r.a.createElement(it,{game:{platform:"platform",name:"Add game",icon:"+"},onClick:t})})),zt=a(57);var Vt=Object(s.b)((function(e){var t=e.auth;return{authUserId:t.authData&&t.authData.uid}}),(function(e){return{onOffersDeleteRequest:function(t,a){e(function(e,t,a){return function(){var n=Object(S.a)(U.a.mark((function n(r){var c,u,o,i;return U.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=T.a.firestore().collection("users").doc(e),r({type:"USER_CACHE_UPDATE_WAIT"}),n.prev=2,n.next=5,c.get();case 5:if(u=n.sent,!((o=u.data())[i=a?"demandIds":"offerIds"]&&o[i].indexOf(t)>=0)){n.next=12;break}return n.next=11,c.update(Object(b.a)({},i,T.a.firestore.FieldValue.arrayRemove(t)));case 11:o[i]=o[i].filter((function(e){return e!==t}));case 12:r(M(e,o)),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(2),r(L(n.t0));case 18:case"end":return n.stop()}}),n,null,[[2,15]])})));return function(e){return n.apply(this,arguments)}}()}(t,a,!1))}}}))((function(e){var t=e.gameId,a=e.ownerId,n=e.authUserId,c=e.onOffersDeleteRequest,u=n===a?r.a.createElement("button",{className:"offer-delete",onClick:function(){return c(a,t)}},"\xd7"):"";return r.a.createElement("div",{className:"offer"},r.a.createElement(tt,{gameId:t,Component:it,isBig:!0}),u)}));var Kt=function(e){var t=e.gameIds,a=e.ownerId;if(t&&Object.values(t>0)){var n,c=[],u=Object(zt.a)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;c.push(r.a.createElement(Vt,{gameId:o,key:o,ownerId:a}))}}catch(i){u.e(i)}finally{u.f()}return c}return r.a.createElement("h3",null,"Game list is empty...")};var Jt=Object(s.b)((function(e,t){var a=e.auth,n=e.userCache,r=t.match;return{authData:a.authData,wait:n.userByIdWait,user:n.users[r.params.userId]}}),(function(e){return{onUserCacheFetchUserByIdRequest:function(t){return e(N(t))}}}))((function(e){var t=e.history,a=e.match,c=e.authData,u=e.wait,o=e.user,i=e.onUserCacheFetchUserByIdRequest;if(Object(n.useEffect)((function(){c&&a.params.userId?i(a.params.userId):c&&!a.params.userId&&t.push("/offers/:userId".replace(":userId",c.uid))}),[c,i,a.params.userId,t]),u)return r.a.createElement("div",null,"Wait...");if(o){var s=a.params.userId===(null===c||void 0===c?void 0:c.uid);return r.a.createElement("div",null,s&&r.a.createElement(qt,null),r.a.createElement(Kt,{gameIds:o.offerIds,ownerId:a.params.userId}))}return!1}));function Xt(e){return{type:"USER_UPDATE_UNSAVED",payload:{user:e}}}function Zt(e){return{type:"USER_UPDATE_SAVED",payload:{user:e}}}var $t=function(){return r.a.createElement("div",null,"Please Authenticate ",r.a.createElement(Y,null))};function Qt(){var e=Object(w.a)(["\n\tcolor: #5F606C;\n\t","\n\tfont-size: 12px;\n\t","\n\ttext-transform: uppercase;\n"]);return Qt=function(){return e},e}var ea=D.a.label(Qt(),(function(e){return e.bright&&"color: #fff;"}),(function(e){return e.bright&&"font-size: 16px;"}));function ta(){var e=Object(w.a)(["\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  background: ",";\n  ","\n  color: ",";\n  transition: all 150ms;\n\n  ",":focus + & {\n    box-shadow: 0 0 0 3px #292B36;\n  }\n\n  "," {\n    visibility: ","\n  }\n"]);return ta=function(){return e},e}function aa(){var e=Object(w.a)(["\n  border: 0;\n  clip: rect(0 0 0 0);\n  clippath: inset(50%);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"]);return aa=function(){return e},e}function na(){var e=Object(w.a)(["\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 2px;\n"]);return na=function(){return e},e}function ra(){var e=Object(w.a)(["\n  display: inline-block;\n  vertical-align: middle;\n  margin: 15px 0;\n"]);return ra=function(){return e},e}var ca=D.a.div(ra()),ua=D.a.svg(na()),oa=D.a.input(aa()),ia=D.a.div(ta(),(function(e){return e.checked?"#FDE74C":" #21222B"}),(function(e){var t=e.readonly,a=e.checked;return t&&a&&"background: none;"}),(function(e){return e.readonly?"#FDE74C":"#000"}),oa,ua,(function(e){return e.checked?"visible":"hidden"})),sa=function(e){var t=e.className,a=e.checked,n=e.readonly,c=Object(Ye.a)(e,["className","checked","readonly"]);return r.a.createElement(ca,{className:t},r.a.createElement(oa,Object.assign({type:"checkbox",checked:a,disabled:n},c)),r.a.createElement(ia,{checked:a,readonly:n},r.a.createElement(ua,{viewBox:"0 0 24 24"},r.a.createElement("polyline",{points:"20 6 9 17 4 12"}))))},la=a(90),da=a(91),fa=a(16),pa=a.n(fa),ha=a(88),ma=a(89);function ba(e){var t=e.position,a=e.contents;return r.a.createElement(ha.a,{position:t},r.a.createElement(ma.a,{className:"point-popup"},a))}function Ea(){var e=Object(w.a)(["\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n\topacity: 0.99;\n"]);return Ea=function(){return e},e}var ga=D.a.div(Ea());function Oa(e){var t=e.points,a=e.style;if(!t.length||!a)return null;var n=t[0].position,c=t.length>1?function(e){var t=e.map((function(e){return pa.a.marker(e.position)}));return new pa.a.featureGroup(t).getBounds()}(t):null;return r.a.createElement(la.a,{style:a,center:n,zoom:14,scrollWheelZoom:!1,bounds:c,boundsOptions:{padding:[10,10]}},r.a.createElement(da.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.a.createElement(va,{points:t}))}function va(e){return e.points.map((function(e){return r.a.createElement(ba,Object.assign({key:e.id},e))}))}var ja=function(e){var t=e.points,a=void 0===t?[]:t,c=Object(n.useState)(null),u=Object(F.a)(c,2),o=u[0],i=u[1],s=Object(n.useRef)(null),l=Object(n.useCallback)((function(e){e&&i({width:e.offsetWidth,height:e.offsetHeight,position:"absolute"})}),[]),d=Object(n.useCallback)((function(e){l(e),s.current=e}),[l]);return Object(n.useEffect)((function(){var e=function(){l(s.current)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[s,l]),r.a.createElement(ga,{ref:d},r.a.createElement(Oa,{style:o,points:a}))};function ya(){var e=Object(w.a)(["\n\tcursor: pointer;\n\tline-height: 50px;\n\tpadding: 0 15px;\n\t&:hover {\n\t\tbackground-color: grey;\n\t}\n"]);return ya=function(){return e},e}function Ca(){var e=Object(w.a)(["\n\tposition: absolute;\n\tbackground-color: #13131D;\n\twidth: 100%;\n\tcolor: white;\n\topacity: .9;\n\tz-index: 1;\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0 20px;\n\ttop: 50px; \n\tleft: -20px;\n"]);return Ca=function(){return e},e}var Ia=D.a.ul(Ca()),_a=D.a.li(ya());var Aa=function(e){var t=e.suggestions,a=e.onSelect;Object(n.useEffect)((function(){function e(){a(null)}return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[a]);var c=t.map((function(e){return r.a.createElement(_a,{key:e.place_id,suggestion:e,onClick:function(){return a(e)}},e.display_name)}));return r.a.createElement(Ia,null,c)};function xa(){var e=Object(w.a)(["\n\tposition: relative;\n"]);return xa=function(){return e},e}var Fa=D.a.div(xa());function wa(e){return Da.apply(this,arguments)}function Da(){return(Da=Object(S.a)(U.a.mark((function e(t){var a,n,r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://nominatim.openstreetmap.org?osm_ids=[N]&format=json&limit=5&q="+encodeURI(t),e.prev=1,e.next=4,fetch(a);case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",[r,t,null]);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",[[],t,e.t0]);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}var Ba={phrase:""};var Ua=function(e){var t=e.onLookup,a=e.address,c=void 0===a?"":a,u=e.readonly,o=Object(n.useState)(c),i=Object(F.a)(o,2),s=i[0],l=i[1],d=Object(n.useState)([]),f=Object(F.a)(d,2),p=f[0],h=f[1],m=Object(n.useState)(null),b=Object(F.a)(m,2),E=b[0],g=b[1];function O(){return(O=Object(S.a)(U.a.mark((function e(t){var a,n,r,c,u;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(null),Ba.phrase=t,e.next=4,wa(t);case 4:a=e.sent,n=Object(F.a)(a,3),r=n[0],c=n[1],u=n[2],c===Ba.phrase&&(h(r),g(u));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=!!p&&r.a.createElement(Aa,{suggestions:p,onSelect:function(e){h(null),e&&(l(e.display_name),t(e))}});return r.a.createElement(Fa,null,r.a.createElement(Le,{onSubmit:function(e){return O.apply(this,arguments)},value:s,readonly:u,placeholder:"Type in address",onChange:l,submitLabel:r.a.createElement(Ge,null)}),v,E)};function Sa(){var e=Object(w.a)(["\n\tpadding: 0 20px;\n"]);return Sa=function(){return e},e}function Ra(){var e=Object(w.a)(["\n\tposition: relative;\n\theight: 250px;\n\n"]);return Ra=function(){return e},e}var Ta=D.a.div(Ra()),ka=D.a.div(Sa());function Ha(e,t){var a;return(null===e||void 0===e||null===(a=e.platforms)||void 0===a?void 0:a.indexOf(t))>=0}var Wa={userUpdateUnsaved:Xt},Pa=Object(s.b)((function(e){return{updatedUser:e.userUpdate.user}}),Wa)((function(e){var t=e.updatedUser,a=e.userUpdateUnsaved,n=e.readonly;if(!t)return null;var c="number"===typeof t.latitude&&"number"===typeof t.longitude,u=c?t.name:"Moscow",o=c?[t.latitude,t.longitude]:[55.7558,37.6173];return r.a.createElement(ka,null,r.a.createElement(ea,null,"Nickame:",r.a.createElement(Le,{value:t.name||"",onChange:function(e){a(Object(f.a)(Object(f.a)({},t),{},{name:e}))},readonly:n})),r.a.createElement(ea,null,"Address",r.a.createElement(Ua,{address:t.place,onLookup:function(e){a(Object(f.a)(Object(f.a)({},t),{},{place:e.display_name,latitude:+e.lat,longitude:+e.lon}))}})),r.a.createElement(Ta,null,r.a.createElement(ja,{points:[{id:0,position:o,contents:u}]})),r.a.createElement(ea,null,"Platform:"),r.a.createElement("div",null,r.a.createElement(ea,{bright:!0},r.a.createElement(sa,{checked:Ha(t,"PS4"),onChange:function(){var e;Ha(t,e="PS4")?a(Object(f.a)(Object(f.a)({},t),{},{platforms:t.platforms.filter((function(t){return t!==e}))})):a(Object(f.a)(Object(f.a)({},t),{},{platforms:(null===t||void 0===t?void 0:t.platforms)?[].concat(Object(_.a)(t.platforms),[e]):[e]}))},readonly:n}),"\xa0\xa0","PS4")))}));function Ma(){var e=Object(w.a)(["\n\tbox-sizing: border-box;\n\tborder: 2px solid #FDE74C;\n\tcolor: white;\n\t","\n\tfont-weight: bold;\n\tbackground: none;\n\tline-height: 46px;\n\t",";\n\tflex-grow: 1;\n\tcursor: pointer;\n\tpadding: 0;\n"]);return Ma=function(){return e},e}var La=D.a.button(Ma(),(function(e){return e.reject&&"\n\t\tborder-color: #AD2031;\n\t\tcolor: #AD2031;\n\t"}),(function(e){return e.wide&&"width: 100%;"})),Ga=function(e){var t=e.children,a=Object(Ye.a)(e,["children"]);return r.a.createElement(La,a,t)};function Na(){var e=Object(w.a)(["\n\tpadding: 20px;\n"]);return Na=function(){return e},e}var Ya=D.a.div(Na());var qa={userUpdateSaveRequest:function(e,t){return function(a){a(function(e,t,a){return function(){var n=Object(S.a)(U.a.mark((function n(r){var c,u,o;return U.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=T.a.firestore().collection("users").doc(e),r({type:"USER_CACHE_UPDATE_WAIT"}),n.prev=2,n.next=5,c.get();case 5:return u=n.sent,o=Object(f.a)(Object(f.a)({},u.data()),t),n.next=9,c.update(o);case 9:r(M(e,o)),a(o),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),r(L(n.t0));case 16:case"end":return n.stop()}}),n,null,[[2,13]])})));return function(e){return n.apply(this,arguments)}}()}(e,t,(function(e){return a(Zt(e))})))}}},za=Object(s.b)((function(e,t){var a=e.userCache,n=e.auth,r=e.userUpdate,c=t.userId;return{user:a.users[c],updatedUser:r.user,isSelf:n.authData.uid===c,wait:a.userByIdWait||a.userUpdateWait}}),qa)((function(e){var t=e.userId,a=e.updatedUser,n=e.userUpdateSaveRequest;return r.a.createElement(Ya,null,r.a.createElement(Ga,{onClick:function(){return n(t,a)},wide:!0},"Save"))}));var Va={userCacheFetchUserByIdRequest:N,userUpdateSaved:Zt},Ka=Object(s.b)((function(e,t){var a=e.auth,n=e.userCache,r=t.match.params.uid;return{userId:r,authData:a.authData,savedUser:n.users[r],wait:n.userByIdWait||n.userUpdateWait}}),Va)((function(e){var t=e.userId,a=e.authData,c=e.savedUser,u=e.wait,o=e.userCacheFetchUserByIdRequest,i=e.userUpdateSaved;if(Object(n.useEffect)((function(){a&&!c&&o(t)}),[a,t,c,o]),Object(n.useEffect)((function(){c&&!u&&i(c)}),[c,u,i]),!a)return r.a.createElement($t,null);var s=t===(null===a||void 0===a?void 0:a.uid);return r.a.createElement(n.Fragment,null,r.a.createElement("div",null,r.a.createElement(Pa,{userId:t,readonly:!s}),r.a.createElement(za,{userId:t})),r.a.createElement(Bt,null))}));function Ja(){var e=Object(w.a)(["\n\tpadding: 20px;\n"]);return Ja=function(){return e},e}var Xa=D.a.div(Ja());var Za={userUpdateCreateRequest:function(e,t){return function(a){a(function(e,t,a){return function(){var n=Object(S.a)(U.a.mark((function n(r){var c;return U.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=T.a.firestore().collection("users").doc(e),r({type:"USER_CACHE_UPDATE_WAIT"}),n.prev=2,n.next=5,c.set(t);case 5:r(M(e,t)),a(t),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),r(L(n.t0));case 12:case"end":return n.stop()}}),n,null,[[2,9]])})));return function(e){return n.apply(this,arguments)}}()}(e,t,(function(e){return a(Zt(e))})))}}},$a=Object(s.b)((function(e){return{updatedUser:e.userUpdate.user}}),Za)((function(e){var t=e.userId,a=e.updatedUser,n=e.userUpdateCreateRequest;return r.a.createElement(Xa,null,r.a.createElement(Ga,{onClick:function(){return n(t,a)},wide:!0},"Register"))}));var Qa=Object(s.b)((function(e){var t=e.userCache,a=e.auth,n=e.userUpdate;return{authData:a.authData,updatedUser:n.user,wait:t.userByIdWait||t.userUpdateWait}}),(function(e){return{onProfileUserUnregistered:function(t){var a={name:t.displayName};e(Xt(a))}}}))((function(e){var t=e.authData,a=e.updatedUser,c=e.onProfileUserUnregistered;return Object(n.useEffect)((function(){t&&!a&&c(t)}),[t,a,c]),t?r.a.createElement(n.Fragment,null,r.a.createElement(Pa,{userId:t.uid}),r.a.createElement($a,{userId:t.uid})):r.a.createElement($t,null)}));function en(){var e=Object(w.a)(["\n\tdisplay: block;\n\tposition: relative;\n\tmargin: 1px 0;\n\t","\n\t","\n\tpadding: 0 20px;\n\tline-height: 50px;\n\t","\n\t","\n\t","\n\t"," \n"]);return en=function(){return e},e}var tn=D.a.span(en(),(function(e){return e.withBackground&&"background-color: #191A24;"}),(function(e){return e.bold&&"font-weight: bold;"}),(function(e){return e.left&&'padding-left: 50px;\n\t\t&:after {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tleft: 20px;\n\t\t\twidth: 14px;\n\t\t\theight: 14px;\n\t\t\tborder-left: 2px solid #FDE74C;\n\t\t\tborder-bottom: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t}'}),(function(e){return e.right&&'padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 14px;\n\t\t\theight: 14px;\n\t\t\tborder-top: 2px solid #FDE74C;\n\t\t\tborder-right: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t}'}),(function(e){return e.down&&'padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tborder-bottom: 2px solid #FDE74C;\n\t\t\tborder-right: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t\n\t\t}'}),(function(e){return e.up&&'padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: "";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tborder-top: 2px solid #FDE74C;\n\t\t\tborder-left: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t\n\t\t}'})),an=function(e){var t=e.to,a=e.children,n=e.left,c=e.right,u=e.down,o=e.up,i=e.withBackground,s=e.bold;return r.a.createElement(l.b,{to:t},r.a.createElement(tn,{left:n,right:c,down:u,up:o,withBackground:i,bold:s},a))};function nn(){var e=Object(w.a)(["\n\tpadding 10px 20px;\n\tfont-size: 12px;\n"]);return nn=function(){return e},e}function rn(){var e=Object(w.a)(["\n\tfont-size: 24px;\n\tpadding: 10px 20px;\n\tmargin: 0;\n\tmargin-top: 15px;\n"]);return rn=function(){return e},e}function cn(){var e=Object(w.a)(["\n\ttext-align: center;\n"]);return cn=function(){return e},e}var un=D.a.div(cn()),on=D.a.h2(rn()),sn=D.a.section(nn());function ln(e){var t,a=e.game;return r.a.createElement(n.Fragment,null,r.a.createElement(un,null,r.a.createElement(it,{game:a,isBig:!0})),r.a.createElement(on,null,a.name),r.a.createElement(sn,null,r.a.createElement(ea,null,"Platform: "),a.platform),!!(null===(t=a.generes)||void 0===t?void 0:t.length)&&r.a.createElement(sn,null,r.a.createElement(ea,null,"Genere: "),a.generes.join(", ")))}var dn=function(e){var t=e.gameId,a=Object(d.g)().url;return r.a.createElement("div",null,r.a.createElement(tt,{gameId:t,Component:ln}),r.a.createElement(an,{to:"".concat(a,"/").concat("list"),right:!0,withBackground:!0},"Offers list"),r.a.createElement(an,{to:"".concat(a,"/").concat("location"),right:!0,withBackground:!0},"Offers map"))};function fn(e,t){return{type:"CLAUSE_CACHE_ADD_PUSH",payload:{clauseId:e,clause:t}}}function pn(e,t){return{type:"CLAUSE_CACHE_FETCH_BY_CHAT",payload:{chatId:e,clauses:t}}}function hn(e){return{type:"CLAUSE_CACHE_WAIT_BY_CHAT",payload:{chatId:e}}}function mn(e,t){return{type:"CLAUSE_CACHE_ERROR_BY_CHAT",payload:{chatId:e,clausesByChatError:t}}}function bn(e,t){return{type:"CLAUSE_CACHE_UPDATE_STATUS",payload:{clauseId:e,clause:t}}}function En(e,t,a,n,r,c,u){return function(){var o=Object(S.a)(U.a.mark((function o(i){var s,l;return U.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return s={chatId:e,ownerId:t,suggesterId:a,respondentId:n,gameId:r,status:"CLAUSE_STATUS_SUGGESTED",isDemand:c,sendDate:T.a.firestore.FieldValue.serverTimestamp(),updateDate:T.a.firestore.FieldValue.serverTimestamp()},i({type:"CLAUSE_CACHE_ADD_WAIT"}),o.prev=2,o.next=5,T.a.firestore().collection("clauses").add(s);case 5:l=o.sent,i(fn(l.id,Object(f.a)(Object(f.a)({},s),{},{sendDate:new Date,updateDate:new Date}))),"function"===typeof u&&u(l.id),o.next=13;break;case 10:o.prev=10,o.t0=o.catch(2),i((o.t0,{type:"CLAUSE_CACHE_ADD_ERROR",payload:{addError:void 0}}));case 13:case"end":return o.stop()}}),o,null,[[2,10]])})));return function(e){return o.apply(this,arguments)}}()}function gn(e,t){return function(){var a=Object(S.a)(U.a.mark((function a(n){var r;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=T.a.firestore().collection("clauses").doc(e),n({type:"CLAUSE_CACHE_UPDATE_WAIT"}),a.prev=2,a.next=5,r.update({status:t.status,updateDate:T.a.firestore.FieldValue.serverTimestamp()});case 5:n(bn(e,t)),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(2),n({type:"CLAUSE_CACHE_UPDATE_ERROR",payload:a.t0});case 11:case"end":return a.stop()}}),a,null,[[2,8]])})));return function(e){return a.apply(this,arguments)}}()}var On=Object(s.b)((function(e,t){var a=e.auth,n=e.chatCache,r=t.ownerId,c=a.authData&&a.authData.uid,u=null;for(var o in n.chats){var i=n.chats[o];if(Array.isArray(i.participantIds)&&i.participantIds.indexOf(c)>=0&&i.participantIds.indexOf(r)>=0){u=o;break}}return{authenticatedUserId:c,fetched:n.chatsByParticipantFetched[c],waitFetch:n.chatsByParticipantWait[c],dealChatId:u}}),(function(e){return{onChatCacheFetchByParticipantRequest:function(t){e(Ct(t))},onChatAndClauseAddRequest:function(t,a,n,r,c,u){var o,i;e((o=[a,n],i=function(o){e(En(o,t,a,n,r,c,(function(){u("/chats/:chatId".replace(":chatId",o))})))},function(){var e=Object(S.a)(U.a.mark((function e(t){var a,n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={participantIds:o},t({type:"CHAT_CACHE_ADD_WAIT"}),e.prev=2,e.next=5,T.a.firestore().collection("chats").add(a);case 5:n=e.sent,t(gt(n.id,a)),"function"===typeof i&&i(n.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),t({type:"CHAT_CACHE_ADD_ERROR",payload:{addError:e.t0}});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()))},onClauseAddRequest:function(t,a,n,r,c,u,o){e(En(t,a,n,r,c,u,(function(){o("/chats/:chatId".replace(":chatId",t))})))}}}))((function(e){var t=e.ownerId,a=e.gameId,c=e.authenticatedUserId,u=e.fetched,o=e.waitFetch,i=e.dealChatId,s=e.onChatCacheFetchByParticipantRequest,l=e.onChatAndClauseAddRequest,f=e.onClauseAddRequest;Object(n.useEffect)((function(){o||u||s(c)}),[c,u,o,s]);var p=Object(n.useState)(""),h=Object(F.a)(p,2),m=h[0],b=h[1];return m?r.a.createElement(d.a,{to:m}):o?"loading...":!(!u||!c)&&r.a.createElement(Ga,{wide:!0,onClick:function(){i?f(i,t,c,t,a,!1,b):l(t,c,t,a,!1,b)}},"apply deal")}));function vn(){var e=Object(w.a)(["\n\tpadding: 10px;\n"]);return vn=function(){return e},e}function jn(){var e=Object(w.a)(["\n\tbackground-color: #21222B;\n\tpadding: 20px;\n\tbox-sizing: border-box;\n"]);return jn=function(){return e},e}function yn(){var e=Object(w.a)(["\n\tborder: 1px solid #5F606C;\n\tmargin: 10px;\n"]);return yn=function(){return e},e}var Cn=D.a.div(yn()),In=D.a.div(jn()),_n=D.a.div(vn());var An=Object(s.b)((function(e){var t=e.auth;return{userId:t.authData&&t.authData.uid}}))((function(e){var t=e.gameId,a=e.userId,n=e.ownerId,c=e.user;return a===n?r.a.createElement("div",null,"User: ",c.name," ",r.a.createElement("small",null,"my offer")):r.a.createElement(Cn,null,r.a.createElement(In,null,c.name),r.a.createElement(_n,null,r.a.createElement(On,{ownerId:n,gameId:t})))}));var xn=function(e){var t=e.gameId,a=e.users,n=[];for(var c in a)n.push(r.a.createElement(An,{gameId:t,user:a[c],ownerId:c,key:c}));return r.a.createElement("div",null,r.a.createElement(an,{to:"/game/:gameId".replace(":gameId",t),left:!0,bold:!0},"Offers list"),n)};function Fn(){var e=Object(w.a)(["\n\tmargin: 10px;\n"]);return Fn=function(){return e},e}var wn=D.a.div(Fn());function Dn(e,t){var a=[];for(var n in e)a.push({id:n,position:[e[n].latitude,e[n].longitude],contents:Bn(n,e[n],t)});return a}function Bn(e,t,a){return r.a.createElement(n.Fragment,null,r.a.createElement(wn,null,t.name),r.a.createElement(On,{ownerId:e,gameId:a}))}var Un=function(e){var t=e.users,a=e.gameId;return r.a.createElement("div",null,r.a.createElement(an,{to:"/game/:gameId".replace(":gameId",a),left:!0,bold:!0},"Offers map"),r.a.createElement(ja,{points:Dn(t,a)}))};var Sn=Object(s.b)((function(e,t){var a=e.userCache,n=e.auth,r=t.match.params.gameId,c=a.usersByOfferFetched[r],u=a.usersByOfferWait[r];return{gameId:r,authUserId:n.authData&&n.authData.uid,users:c&&!u?a.users:null,error:c&&!u?a.usersByOfferError[r]:null}}),(function(e,t){var a=t.match;return{userCacheFetchByOfferRequest:function(){return e(G(a.params.gameId))}}}))((function(e){var t=e.gameId,a=e.activeTab,c=e.authUserId,u=e.users,o=e.error,i=e.userCacheFetchByOfferRequest;if(Object(n.useEffect)((function(){!c||u||o||i()}),[c,u,o,i]),o)return r.a.createElement("div",null,o.toString());if(u){var s=function(e,t,a){var n={};for(var r in e)e[r].offerIds&&e[r].offerIds.indexOf(t)>=0&&r!==a&&(n[r]=e[r]);return n}(u,t,c);return r.a.createElement(n.Fragment,null,!a&&r.a.createElement(dn,{gameId:t}),"list"===a&&r.a.createElement(xn,{gameId:t,users:s}),"location"===a&&r.a.createElement(Un,{gameId:t,users:s}),r.a.createElement(Bt,null))}return r.a.createElement("div",null,"Wait...")}));function Rn(){var e=Object(w.a)(["\n\t","\n"]);return Rn=function(){return e},e}function Tn(){var e=Object(w.a)(["\n\t","\n"]);return Tn=function(){return e},e}var kn="\n\tdisplay: inline-block;\n\tflex-shrink: 0;\n\twidth: 32px;\n\theight: 32px;\n\tline-height: 32px;\n\ttext-align: center;\n\toverflow: hidden;\n\tborder-radius: 50%;\n\tbackground-color: #454651;\n",Hn=D.a.img(Tn(),kn),Wn=D.a.label(Rn(),kn);var Pn=function(e){var t=e.pic,a=e.name,n=a.split(/\s+/).reduce((function(e,t){return e+t.charAt(0).toUpperCase()}),"");return t?r.a.createElement(Hn,{src:t,title:a,alt:n}):r.a.createElement(Wn,{title:a},n)};function Mn(){var e=Object(w.a)(["\n\tmargin-left: 10px;\n"]);return Mn=function(){return e},e}function Ln(){var e=Object(w.a)(["\n\tdisplay: flex;\n\theight: 58px;\n\tline-height: 58px;\n\talign-items: center;\n\tmargin 10px 0;\n\tpadding 0 20px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\tborder 1px solid #454651;\n"]);return Ln=function(){return e},e}var Gn=D.a.div(Ln()),Nn=D.a.div(Mn());var Yn=Object(s.b)((function(e,t){var a=e.auth,n=e.chatCache,r=e.userCache,c=t.chatId,u=t.chat,o=a.authData&&a.authData.uid,i=n.chatsLastMessages[c],s=(u.participantIds||[]).filter((function(e){return e!==o}))[0],l=r.users[s];return{userId:o,lastMessage:i,companionId:s,companion:l}}),(function(e){return{fetchLastMessage:function(t){e(function(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("messages").where("chatId","==",e).orderBy("sendDate","desc"),t.prev=1,t.next=4,n.get();case 4:r=t.sent,c=r.docs[0],a(Ot(e,c&&c.data())),t.next=13;break;case 9:throw t.prev=9,t.t0=t.catch(1),a(Ot(e)),t.t0;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(t))},fetchCompanion:function(t){e(N(t))}}}))((function(e){var t=e.chatId,a=(e.chat,e.userId,e.lastMessage),c=e.companionId,u=e.companion,o=e.fetchLastMessage,i=e.fetchCompanion;Object(n.useEffect)((function(){void 0===a&&o(t),!u&&c&&i(c)}));var s="/chats/:chatId".replace(":chatId",t);return a&&a.text,r.a.createElement(l.b,{to:s},r.a.createElement(Gn,null,r.a.createElement(Pn,{pic:null===u||void 0===u?void 0:u.pic,name:(null===u||void 0===u?void 0:u.name)||""}),r.a.createElement(Nn,null,null===u||void 0===u?void 0:u.name)))}));function qn(){var e=Object(w.a)(["\n\tpadding: 0 20px;\n"]);return qn=function(){return e},e}var zn=D.a.div(qn());var Vn=Object(s.b)((function(e){var t=e.auth,a=e.chatCache,n=t.authData&&t.authData.uid;return{userId:n,wait:a.chatsByParticipantWait[n],error:a.chatsByParticipantError[n],fetched:a.chatsByParticipantFetched[n],chats:a.chats}}),(function(e){return{fetchChats:function(t){e(Ct(t))}}}))((function(e){e.history,e.match;var t=e.userId,a=e.wait,c=e.error,u=e.fetched,o=e.chats,i=e.fetchChats;if(Object(n.useEffect)((function(){!t||a||c||u||i(t)})),c)return console.log(c),r.a.createElement("div",null,c.toString());if(a)return r.a.createElement("div",null,"Wait...");var s=function(e,t){var a={};for(var n in e)e[n]&&Array.isArray(e[n].participantIds)&&e[n].participantIds.indexOf(t)>=0&&(a[n]=e[n]);return a}(o,t);return r.a.createElement(n.Fragment,null,r.a.createElement(zn,null,function(e){var t=[];for(var a in e)t.push(r.a.createElement(Yn,{key:a,chatId:a,chat:e[a]}));return t}(s)),r.a.createElement(Bt,null))}));function Kn(){var e=Object(w.a)(["\n\tdisplay: none;\n\tposition: absolute;\n\tbackground-color: inherit;\n\twidth: 100%;\n\ttop: 40px;\n\tleft: 0;\n\t","\n"]);return Kn=function(){return e},e}function Jn(){var e=Object(w.a)(['\n\tborder: none;\n\tcolor: #FDE74C;\n\tpadding-left: 20px;\n\tpadding-right: 50px;\n\ttext-align: left;\n\tbackground: none;\n\twidth: 100%;\n\tline-height: 40px;\n\tcursor: pointer;\n\t&:after {\n\t\tcontent: "";\n\t\tposition: absolute;\n\t\ttop: 10px;\n\t\tright: 20px;\n\t\twidth: 12px;\n\t\theight: 12px;\n\t\tborder-bottom: 2px solid #FDE74C;\n\t\tborder-right: 2px solid #FDE74C;\n\t\ttransform: rotate(45deg);\n\t}\n\t',"\n"]);return Jn=function(){return e},e}function Xn(){var e=Object(w.a)(["\n\tposition: relative;\n\tbackground-color: #191A24;\n"]);return Xn=function(){return e},e}var Zn=D.a.div(Xn()),$n=D.a.button(Jn(),(function(e){return e.toggled&&"&:after {\n\t\t\ttransform: rotate(225deg);\n\t\t}\n\t"})),Qn=D.a.div(Kn(),(function(e){return e.toggled&&"display: block"})),er=function(e){var t=e.title,a=e.toggled,n=e.onClick,c=e.children;return r.a.createElement(Zn,null,r.a.createElement($n,{toggled:a,onClick:n},t),r.a.createElement(Qn,{toggled:a},c))},tr=function(){return r.a.createElement("svg",{width:"17",height:"18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M1 3.6c0-.5.3-.9.8-1l5-1a1 1 0 0 1 1.2.9v13a1 1 0 0 1-1.2 1l-5-1.1a1 1 0 0 1-.8-1V3.6zM12 1v16M16 1v16",stroke:"#FDE74C",strokeWidth:"2",strokeLinecap:"round"}))};function ar(){var e=Object(w.a)(["\n\tcolor: #FDE74C;\n\tpadding: 20px;\n"]);return ar=function(){return e},e}var nr=D.a.div(ar());var rr=Object(s.b)((function(e){var t=e.auth,a=e.gameCache;return{userId:t.authData&&t.authData.uid,games:a.games}}),(function(e){return{}}))((function(e){var t=function(e,t,a,n){return e.reduce((function(e,r){if(r.status!==n)return e;var c=+t[r.gameId].unpackedPrice;return a===r.ownerId?e+c:e-c}),0)}(e.chatClausesArray,e.games,e.userId,"CLAUSE_STATUS_ACCEPTED");return r.a.createElement(nr,null,function(e){if(0===e)return null;if(e>0)return"You receive";if(e<0)return"You pay"}(t),": ",Math.abs(t))}));function cr(){var e=Object(w.a)(["\n\tmargin:0;\n\tpadding: 0;\n"]);return cr=function(){return e},e}function ur(){var e=Object(w.a)(["\n\tmargin: 0;\n\tpadding; 0;\n"]);return ur=function(){return e},e}function or(){var e=Object(w.a)(["\n\tpadding-left: 10px;\n\tline-height: 41px;\n"]);return or=function(){return e},e}function ir(){var e=Object(w.a)(["\n\tdisplay: flex;\n"]);return ir=function(){return e},e}function sr(){var e=Object(w.a)(["\n\tmargin-left: 10px;\n"]);return sr=function(){return e},e}function lr(){var e=Object(w.a)(["\n\tdisplay: flex;\n"]);return lr=function(){return e},e}function dr(){var e=Object(w.a)(["\n\tmargin: 0;\n\tline-height: 32px;\n\tword-break: break-word;\n"]);return dr=function(){return e},e}function fr(){var e=Object(w.a)(["\n\tdisplay: flex;\n\tmargin: 0 -10px\n"]);return fr=function(){return e},e}function pr(){var e=Object(w.a)(["\n\tpadding: 10px 20px;\n"]);return pr=function(){return e},e}var hr=D.a.div(pr()),mr=D.a.div(fr()),br=D.a.p(dr()),Er=D.a.div(lr()),gr=D.a.div(sr()),Or=D.a.div(ir()),vr=D.a.div(or()),jr=D.a.h4(ur()),yr=D.a.p(cr());function Cr(e){var t=e.userId,a=e.clause,n=e.acceptClause,c=e.rejectClause;return a.respondentId===t&&"CLAUSE_STATUS_ACCEPTED"!==a.status?r.a.createElement(mr,null,r.a.createElement(Ga,{onClick:n},"Accept"),r.a.createElement(Ga,{onClick:c,reject:!0},"Reject")):r.a.createElement(mr,null,r.a.createElement(Ga,{onClick:c,reject:!0},"Reject"))}function Ir(e){var t=e.gameId,a=e.game;return r.a.createElement(Or,null,r.a.createElement(it,{gameId:t,game:a}),r.a.createElement(vr,null,r.a.createElement(jr,null,a.name),r.a.createElement(yr,null,a.platform)))}var _r=Object(s.b)((function(e,t){var a=e.auth,n=e.userCache,r=t.clause;return{user:n.users[r.ownerId],userId:a.authData&&a.authData.uid}}),(function(e,t){var a=t.clauseId,n=t.clause;return{acceptClause:function(){e(gn(a,Object(f.a)(Object(f.a)({},n),{},{status:"CLAUSE_STATUS_ACCEPTED"})))},rejectClause:function(){e(gn(a,Object(f.a)(Object(f.a)({},n),{},{status:"CLAUSE_STATUS_REJECTED"})))}}}))((function(e){var t=e.clause,a=e.userId,n=e.user,c=e.acceptClause,u=e.rejectClause;return n?r.a.createElement(hr,null,r.a.createElement(Er,null,r.a.createElement(Pn,{pic:n.pic,name:n.name}),r.a.createElement(gr,null,r.a.createElement(br,null,"Is offering to you:"),r.a.createElement(tt,{gameId:t.gameId,Component:Ir}))),r.a.createElement(Cr,{userId:a,clause:t,acceptClause:c,rejectClause:u})):r.a.createElement(hr,null,"Loading... ",JSON.stringify(t))}));var Ar=Object(s.b)((function(e,t){var a=e.clauseCache,n=t.chatId,r={};for(var c in a.clauses)n&&a.clauses[c]&&a.clauses[c].chatId===n&&(r[c]=a.clauses[c]);return{chatClauses:r}}))((function(e){var t=e.chatClauses,a=[];for(var n in t){var c=r.a.createElement(_r,{key:n,clauseId:n,clause:t[n]});a.push(c)}return a}));var xr=Object(s.b)((function(e,t){var a=e.clauseCache,n=e.gameCache,r=t.chatId,c=Object.values(a.clauses).filter((function(e){return e.chatId=r})),u=c.reduce((function(e,t){return n.gamesByIdError[t.gameId]?[].concat(Object(_.a)(e),[n.gamesByIdError[t.gameId]]):e}),[]),o=c.every((function(e){return n.gamesByIdFetched[e.gameId]})),i=c.some((function(e){return n.gamesByIdWait[e.gameId]})),s=c.every((function(e){return n.games[e.gameId]}));return{chatClausesArray:c,games:n.games,gamesByIdWait:n.gamesByIdWait,gamesFetchErrors:u,isGamesFetched:o,isGamesWait:i,hasAllRequiredGames:s}}),(function(e){return{fetchGames:function(t,a,n){e(function(e,t,a){return function(){var n=Object(S.a)(U.a.mark((function n(r){return U.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.forEach((function(e){a[e]||t[e]||r(xe(e))}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,a,n))}}}))((function(e){var t=e.chatId,a=e.chatClausesArray,c=e.games,u=e.gamesByIdWait,o=e.gamesFetchErrors,i=e.isGamesFetched,s=e.isGamesWait,l=e.hasAllRequiredGames,d=e.fetchGames;return Object(n.useEffect)((function(){var e=a.map((function(e){return e.gameId}));d(e,c,u)})),s||!i?r.a.createElement("div",null,"Wait..."):l?r.a.createElement("div",null,r.a.createElement(Ar,{chatId:t}),r.a.createElement(rr,{chatClausesArray:a})):r.a.createElement("div",null,"Error fetching Games",r.a.createElement("pre",null,JSON.stringify(o)))}));function Fr(){var e=Object(w.a)(["\n\tmargin-left: 10px;\n\tmargin-top: 7px;\n\tword-break: break-word;\n"]);return Fr=function(){return e},e}function wr(){var e=Object(w.a)(["\n\tpadding: 10px 20px;\n\tdisplay: flex;\n"]);return wr=function(){return e},e}var Dr=D.a.div(wr()),Br=D.a.p(Fr());var Ur=Object(s.b)((function(e,t){var a=e.userCache,n=t.message;return{user:a.users[n.authorId]}}))((function(e){var t=e.message,a=e.user;return a?r.a.createElement(Dr,null,r.a.createElement(Pn,{pic:a.pic,name:a.name}),r.a.createElement(Br,null,t.text," ",function(e){if(e.isUpdating)return String.fromCharCode(8987);return String.fromCharCode(10003)}(t))):r.a.createElement(Dr,null,"Loading...")}));function Sr(e){var t=e.messages,a=e.clauses;return[].concat(Object(_.a)(t),Object(_.a)(function(e){var t=[];for(var a in e)t.push(Object(f.a)({id:a},e[a]));return t}(a))).sort((function(e,t){return e.sendDate-t.sendDate})).map((function(e){return e.gameId?r.a.createElement(_r,{key:e.id,clauseId:e.id,clause:e}):r.a.createElement(Ur,{key:e.id,message:e})}))}function Rr(){var e=Object(w.a)(["\n\theight: calc(100vh - 230px);\n\toverflow: auto;\n"]);return Rr=function(){return e},e}var Tr=D.a.div(Rr());var kr=Object(s.b)((function(e,t){var a=e.messageCache,n=e.clauseCache,r=t.chatId;return{messagesFetched:a.messagesFetched,messagesFetching:a.messagesFetching,messages:a.messages,clausesFetched:n.clausesByChatFetched[r],clausesFetching:n.clausesByChatWait[r],clauses:n.clauses}}),(function(e){return{onMessagesFetch:function(t){e(function(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("messages").where("chatId","==",e).orderBy("sendDate").limit(100),a({type:"MESSAGE_CACHE_FETCH_WAIT"}),t.prev=2,t.next=5,n.get();case 5:r=t.sent,c=r.docs.map((function(e){var t=e.data();return Object(f.a)(Object(f.a)({},t),{},{sendDate:t.sendDate.toDate(),updateDate:t.updateDate.toDate(),id:e.id,isUpdating:e.metadata.hasPendingWrites})})),a(It(c)),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(2),a({type:"MESSAGE_CACHE_FETCH_ERROR",payload:{fetchError:t.t0}}),t.t0;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}(t))},onClauseFetch:function(t){e(function(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("clauses").where("chatId","==",e).where("status","in",["CLAUSE_STATUS_SUGGESTED","CLAUSE_STATUS_ACCEPTED"]),a(hn(e)),t.prev=2,t.next=5,n.get();case 5:r=t.sent,c=r.docs.reduce((function(e,t){var a=t.data();return e[t.id]=Object(f.a)(Object(f.a)({},a),{},{sendDate:a.sendDate.toDate(),updateDate:a.updateDate.toDate()}),e}),{}),a(pn(e,c)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),a(mn(e,t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=e.chatId,a=e.messagesFetched,c=e.messagesFetching,u=e.messages,o=e.clausesFetched,i=e.clausesFetching,s=e.clauses,l=e.onMessagesFetch,d=e.onClauseFetch;return Object(n.useEffect)((function(){c||a||l(t)}),[t,a,c,l]),Object(n.useEffect)((function(){i||o||d(t)}),[t,o,i,d]),o||o?r.a.createElement(Tr,null,r.a.createElement(Sr,{messages:u,clauses:s})):r.a.createElement("div",null,"wait...")}));function Hr(){var e=Object(w.a)(["\n\tposition: fixed;\n\tbox-sizing: border-box;\n\twidth: 100%;\n\tpadding: 4px 20px;\n\tleft: 0;\n\tbottom: 0;\n"]);return Hr=function(){return e},e}var Wr=D.a.div(Hr());var Pr=Object(s.b)((function(e){var t=e.auth;return{userId:t.authData&&t.authData.uid}}),(function(e){return{onSendMessage:function(t,a,n,r){e(function(e,t,a,n){return function(){var r=Object(S.a)(U.a.mark((function r(c){var u,o;return U.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=T.a.firestore().collection("messages").doc(),o={chatId:e,text:t,authorId:a,recipientId:n,sendDate:T.a.firestore.FieldValue.serverTimestamp(),updateDate:T.a.firestore.FieldValue.serverTimestamp()},c(_t(null,Object(f.a)(Object(f.a)({id:u.id},o),{},{isUpdating:!0}))),r.prev=3,r.next=6,u.set(o);case 6:c({type:"MESSAGE_CACHE_UPDATE_CONFIRM",payload:{confirmedMessageId:u.id}}),r.next=13;break;case 9:throw r.prev=9,r.t0=r.catch(3),c(_t(u.id,Object(f.a)(Object(f.a)({id:u.id},o),{},{sendError:r.t0}))),r.t0;case 13:case"end":return r.stop()}}),r,null,[[3,9]])})));return function(e){return r.apply(this,arguments)}}()}(t,a,n,r))}}}))((function(e){var t=e.chatId,a=e.recipientId,c=e.userId,u=e.onSendMessage,o=Object(n.useState)(""),i=Object(F.a)(o,2),s=i[0],l=i[1];return r.a.createElement(Wr,null,r.a.createElement(Le,{value:s,placeholder:"Type your message here",onChange:l,onSubmit:function(){u(t,s,c,a),l("")}}))}));function Mr(){var e=Object(w.a)(["\n\tmargin-bottom: 82px;\n"]);return Mr=function(){return e},e}function Lr(){var e=Object(w.a)(["\n\tdisplay: inline-block;\n\tvertical-align: midle;\n\tfloat: right;\n"]);return Lr=function(){return e},e}var Gr=D.a.span(Lr()),Nr=D.a.div(Mr());var Yr=Object(s.b)((function(e,t){var a=e.auth,n=e.chatCache,r=e.userCache,c=t.match.params.chatId,u=a.authData&&a.authData.uid,o=n.chats[c],i=Array.isArray(o&&o.participantIds)?o.participantIds.find((function(e){return e!==u})):null;return{chatId:c,chat:o,userId:u,user:r.users[u],companionId:i,companion:r.users[i]}}),(function(e){return{onChatFetch:function(t){e(function(e){return function(){var t=Object(S.a)(U.a.mark((function t(a){var n,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T.a.firestore().collection("chats").doc(e),a(jt(e)),t.prev=2,t.next=5,n.get();case 5:r=t.sent,a(vt(e,r.data())),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),a(yt(e,t.t0));case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}(t))},onUserFetch:function(t){e(N(t))}}}))((function(e){var t=e.chatId,a=e.chat,c=e.userId,u=e.user,o=e.companionId,i=e.companion,s=e.onChatFetch,l=e.onUserFetch;Object(n.useEffect)((function(){c&&!u&&l(c),o&&!i&&l(o),!a&&t&&s(t)}),[c,u,t,a,o,i,s,l]);var d=Object(n.useState)(!1),f=Object(F.a)(d,2),p=f[0],h=f[1];return c?r.a.createElement(n.Fragment,null,r.a.createElement(Nr,null,r.a.createElement(an,{to:"/chats",left:!0,bold:!0},"Chat with ",null===i||void 0===i?void 0:i.name,r.a.createElement(Gr,null,r.a.createElement(tr,null))),r.a.createElement(er,{title:"Exchange details",toggled:p,onClick:function(){return h(!p)}},r.a.createElement(xr,{chatId:t})),r.a.createElement(kr,{chatId:t})),r.a.createElement(Pr,{chatId:t,recipientId:o})):r.a.createElement($t,null)}));function qr(){return r.a.createElement("h2",null,"Page not found")}var zr=Object(o.d)(x,void 0,Object(o.a)(i.a)),Vr=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(s.a,{store:zr},r.a.createElement(l.a,null,r.a.createElement(d.b,{component:oe}),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:Jt}),r.a.createElement(d.b,{exact:!0,path:"/search",component:Yt}),r.a.createElement(d.b,{exact:!0,path:"/offers/:userId",component:Jt}),r.a.createElement(d.b,{exact:!0,path:"/profile/:uid",component:Ka}),r.a.createElement(d.b,{exact:!0,path:"/registration",component:Qa}),r.a.createElement(d.b,{exact:!0,path:"/game/:gameId",component:Sn}),r.a.createElement(d.b,{exact:!0,path:"/game/:gameId/list",render:function(e){return r.a.createElement(Sn,Object.assign({},e,{activeTab:"list"}))}}),r.a.createElement(d.b,{exact:!0,path:"/game/:gameId/location",render:function(e){return r.a.createElement(Sn,Object.assign({},e,{activeTab:"location"}))}}),r.a.createElement(d.b,{exact:!0,path:"/chats",component:Vn}),r.a.createElement(d.b,{exact:!0,path:"/chats/:chatId",component:Yr}),r.a.createElement(d.b,{component:qr})),r.a.createElement(ht,null)),r.a.createElement(At,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(86);T.a.initializeApp({apiKey:"AIzaSyAbxWCNCtF7lm-fmwg00zbAY11aMWPomz0",authDomain:"unpacked-dev.firebaseapp.com",databaseURL:"https://unpacked-dev.firebaseio.com",projectId:"unpacked-dev",storageBucket:"unpacked-dev.appspot.com",messagingSenderId:"1063122406998",appId:"1:1063122406998:web:615fd045afd6407f"}),u.a.render(r.a.createElement(Vr,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[61,1,2]]]);
//# sourceMappingURL=main.0314aa8d.chunk.js.map