{"version":3,"sources":["reducers/offers-add.js","reducers/auth.js","reducers/game-finder.js","reducers/game-cache.js","reducers/offer-finder.js","reducers/user-cache.js","reducers/chat-cache.js","reducers/clause-cache.js","reducers/address-lookup-cache.js","reducers/user-update.js","reducers/message-cache.js","rootReducer.js","constants/action-types.js","actions/user-cache.js","constants/collection-names.js","components/LoginButton.js","actions/auth.js","components/HeaderProfileName.js","constants/paths.js","components/HeaderProfile.js","components/HeaderMenu.js","components/HeaderPage.js","components/Burger.js","components/Header.js","common/Modal.js","components/AuthModal.js","actions/game-cache.js","actions/game-finder.js","common/StyledInput.js","common/Icons/IconSearch.js","components/GameFinderInput.js","common/StyledWait.js","common/StyledError.js","containers/GameLoader.js","components/GameTile.js","components/offers-add-suggestion.js","actions/offers-add.js","components/GameFinderOffers.js","components/offers-add-modal.js","containers/Modals.js","actions/chat-cache.js","actions/message-cache.js","components/subscription-messages.js","components/Footer.js","components/OffersCounter.js","components/GameFinderResult.js","components/GameFinderResults.js","pages/PageSearch.js","components/OffersAdd.js","components/user-game.js","components/user-game-list.js","pages/PageOffers.js","actions/user-update.js","components/ask-authenticate.js","common/StyledLabel.js","common/StyledCheckbox.js","common/Map/MapMarker.js","common/Map/Map.js","components/AddressLookupSuggestions.js","components/AddressLookup.js","components/ProfileForm.js","constants/platform-types.js","common/StyledButton.js","components/ProfileControls.js","pages/PageProfile.js","components/RegistrationControls.js","pages/PageRegistration.js","common/StyledLink.js","components/GameInfo.js","actions/clause-cache.js","constants/clause-statuses.js","components/SubmitToOffer.js","components/GameOffer.js","components/GameOffers.js","components/GameLocations.js","pages/PageGame.js","common/Avatar.js","components/Chat.js","pages/PageChats.js","common/StyledSpoiler.js","common/Icons/IconList.js","components/DealBalance.js","components/clause.js","components/DealClauses.js","components/Deal.js","components/Message.js","components/MessagesListBody.js","components/MessageList.js","components/MessageInput.js","pages/PageChat.js","pages/PageNotFound.js","App.js","serviceWorker.js","index.js"],"names":["initialState","user","modalShown","wait","addError","authModalShown","subscribed","authData","logoutError","searchPhrase","searchKey","pendingPromise","gamesFetchError","gamesByIdWait","gamesByIdFetched","gamesByIdError","games","offersForGameWait","offersForGameFetched","offers","offersFetchErrors","usersByOfferWait","usersByOfferFetched","usersByOfferError","userByIdWait","userByIdError","userUpdateWait","userUpdateError","users","chatsByParticipantWait","chatsByParticipantFetched","chatsByParticipantError","chatsByIdWait","chatsByIdFetched","chatsByIdError","chats","chatsLastMessages","chatsNames","chatAddWait","chatAddError","objectMap","list","iteratee","mappedList","key","clauses","clauseAddWait","clauseAddError","clausesByChatWait","clausesByChatFetched","clausesByChatError","clausesUpdateWait","clausesUpdateError","lookupPhrase","suggestions","suggestionsFetchWait","suggestionsFetchError","suggestionsFetched","isSaved","messages","messagesFetching","messagesFetched","messagesFetchError","messagesUnsubscribe","combineReducers","offersAdd","state","action","type","payload","auth","gameFinder","gameCache","gameId","game","gameByIdError","offerFinder","filteredOffers","offerId","offersToAdd","offersFetchError","userCache","userId","chatCache","participantId","chatId","chat","message","fetchError","clauseCache","clauseId","clause","updateError","addressLookupCache","userUpdate","messageCache","messagesFetchFetching","messageIndex","outdatedMessageId","findIndex","id","slice","updatedMessage","map","confirmedMessageId","isUpdating","userCacheFetchByOffer","userCacheWaitByOffer","userCacheErrorByOffer","userCacheFetchById","userCacheUpdate","userCacheUpdateError","userCacheFetchByOfferRequest","dispatch","a","query","firebase","firestore","collection","where","get","querySnapshot","docs","reduce","doc","data","userCacheFetchUserByIdRequest","ref","connect","authShowModal","className","onClick","uid","unregistered","name","displayName","path","replace","to","mapDispatchToProps","authRequestSubscribe","onAuthStateChanged","authLogin","authRequestLogout","signOut","useEffect","isRegisterirng","useRouteMatch","HeaderPage","pageName","BurgerButton","styled","button","Burger","props","width","height","viewBox","fill","xmlns","x1","y1","x2","y2","stroke","strokeWidth","strokeLinecap","HeaderContainer","header","HeaderLogo","div","MenuContainer","isToggled","HeaderPageContainer","h1","Header","useState","toggle","closeMenu","window","addEventListener","removeEventListener","e","stopPropagation","ModalMask","ModalBody","Modal","closeCallback","children","scrollY","document","body","style","top","position","scrollTo","parseFloat","closeByEsc","target","currentTarget","uiConfig","signInFlow","signInOptions","GoogleAuthProvider","PROVIDER_ID","EmailAuthProvider","credentialHelper","firebaseui","CredentialHelper","NONE","callbacks","signInSuccessWithAuthResult","AuthModalContainer","authHideModal","firebaseAuth","gameCacheFetchById","gameCacheWaitById","gameCacheErrorById","gameCacheFetchByIdRequest","exists","Error","gameFinderFetch","gameFinderFetchWait","gameFinderFetchError","StyledInputContainer","form","readonly","StyledInputIconContainer","span","StyledInputElement","input","StyledInputButton","StyledInputIcon","icon","StyledInputSubmit","submitLabel","StyledInput","value","onChange","onSubmit","preventDefault","placeholder","cx","cy","r","onGameFinderSearchPhrase","gameFinderSearchPhrase","onGameFinderFetchRequest","gamesQuery","then","gameFinderFetchRequest","onGameFinderFetchCancel","currentSearchKey","toLowerCase","trim","substring","length","IconSearch","WaitContainer","WaitContents","StyledWait","ErrorContainer","ErrorContents","pre","StyledError","error","errorText","toString","fetchById","Component","CompoenentWait","ComponentError","fetchWait","Tile","isBig","GameImg","img","GameIcon","GameTile","platform","pic","src","alt","onUserCacheAddUserGameRequest","isDemand","updateField","indexOf","update","FieldValue","arrayUnion","push","userCacheAddUserGameRequest","filteredGames","tags","some","tag","rederedResults","onOffersAddHideModal","renderCallback","Modals","this","offersAddModalShown","React","PureComponent","chatCacheFetchByParticipant","chatCacheWaitByParticipant","chatCacheErrorByParticipant","chatCacheAddPush","chatCacheFetchLastMessage","chatCacheFetchById","chatCacheWaitById","chatCacheErrorById","chatCacheFetchByParticipantRequest","messageCacheFetch","messageCacheUpdate","onMessagesSubscribe","Date","onSnapshot","docChanges","forEach","change","fetchedMessage","sendDate","toDate","updateDate","metadata","hasPendingWrites","messageCacheSubscribe","messageCacheSubscribeRequest","onMessagesUnsubscribe","messageCacheUnsubscribe","FooterContainer","footer","FooterCopyryight","Footer","userCount","Object","values","filter","offerIds","fetched","onUserCacheFetchByOfferRequest","GameFinderResultContainer","GameInfo","GameInfoName","GameRow","GameFinderResult","GameFinderResults","PageContents","onOffersAddShowModal","offersAddShowModal","authUserId","onOffersDeleteRequest","arrayRemove","userGameId","userCacheDeleteUserGameRequest","ownerId","deleteButton","UserGameList","gameIds","renderedOffers","match","params","onUserCacheFetchUserByIdRequest","history","isSelf","userUpdateUnsaved","userUpdateSaved","AskAuthenticate","label","bright","CheckboxContainer","Icon","svg","HiddenCheckbox","StyledCheckboxDisplayer","checked","StyledCheckbox","disabled","points","MapMarker","contents","Marker","Popup","MapContainer","MapPane","center","bounds","markers","point","L","marker","featureGroup","getBounds","zoom","scrollWheelZoom","boundsOptions","padding","TileLayer","attribution","url","MapMarkers","Map","setStyle","containerRef","useRef","updateStyles","useCallback","containerEl","offsetWidth","offsetHeight","getContainerRef","current","onResizeUpdate","ListContainer","ul","ItemContainer","li","AddressLookupSuggestions","onSelect","closeSuggestions","addressLookupSuggestions","suggestion","place_id","display_name","AddressLookupContainer","getSuggestions","phrase","encodeURI","fetch","response","json","actualPhrase","AddressLookup","onLookup","address","setPhrase","setSuggestions","setError","fetchedSuggestions","fetchedPhrase","renderedSuggestions","ProfileFormContainer","checkHasPlatform","updatedUser","platformType","platforms","positionDefined","latitude","longitude","StyledLabel","place","lat","lon","userPlatfrom","StyledButton","reject","wide","ProfileControlsContainer","userUpdateSaveRequest","userUpdates","successCallback","userCacheUserUpdate","savedUser","RegistrationFooter","userUpdateCreateRequest","set","userCacheUserCreate","onProfileUserUnregistered","userUnregistered","StyledLinkContents","withBackground","bold","left","right","down","up","TileContainer","GameName","h2","Section","section","GameInfoDescription","generes","join","StyledLink","clauseCacheAddPush","clauseCacheFetchByChat","clauseCacheWaitByChat","clauseCacheErrorByChat","clauseCacheUpdate","clauseCacheAddRequest","suggesterId","respondentId","status","serverTimestamp","add","clauseRef","clauseCacheAddError","clauseCacheUpdateStatusRequest","authenticatedUserId","dealChatId","Array","isArray","participantIds","waitFetch","onChatCacheFetchByParticipantRequest","onChatAndClauseAddRequest","toggleRedirect","chatRef","onClauseAddRequest","redirectUrl","GameOfferContainer","GameOfferUser","SubmitToOfferContainer","GameOffers","UserNameContainer","getPointsForUsers","getContents","GameLocations","activeTab","usersWithOffer","getUsersWithOffer","styleAvatarShape","AvatarImg","AvatarInitials","Avatar","initials","split","namePart","charAt","toUpperCase","title","ChatContainer","ChatInfo","lastMessage","companionId","participant","companion","fetchLastMessage","orderBy","chatCacheFetchLastMessageRequest","fetchCompanion","undefined","text","fetchChats","console","log","userChats","filteredChats","filterChatsByParticipant","renderedChats","renderChats","StyledSpoilerContainer","StyledSpoilerButton","toggled","StyledSpoilerContents","d","DealBalanceContainer","evaluatedBalance","clausesArray","clauseStatus","balance","gamePrice","unpackedPrice","getBalance","chatClausesArray","getBalanceStatus","Math","abs","ClauseContainer","ClauseControlsContainer","ClauseMessage","p","ClauseBody","ClauseDescription","ClauseGameContainer","ClauseGameInfo","ClauseGameName","h4","ClauseGamePlatform","ClauseControls","acceptClause","rejectClause","ClauseGame","JSON","stringify","chatClauses","renderedClauses","renderedClause","gamesFetchErrors","isGamesFetched","every","isGamesWait","hasAllRequiredGames","fetchGames","gameCacheFetchMissingGamesRequest","MessageContainer","MessageText","authorId","String","fromCharCode","getStatusSign","MessagesListBody","listArray","objectToArrayWithIds","sort","b","communication","MessageListContainer","clausesFetched","clausesFetching","onMessagesFetch","limit","queyrSnapshot","messageCacheFetchRequest","onClauseFetch","fetchedClause","clauseCacheFetchActiveByChatRequest","MeassageInputContainer","onSendMessage","recipientId","messageRef","sendError","messageCacheSendMessageRequest","setMessage","IconContainer","find","onChatFetch","chatCacheFetcByIdRequest","onUserFetch","dealToggled","setDealToggled","IconList","StyledSpoiler","NotFound","store","createStore","rootReducer","applyMiddleware","thunk","component","exact","PageOffers","PageSearch","PageProfile","PageRegistration","PageGame","PATH_PAGE_GAME","render","routeProps","PageChats","PageChat","PageNotFound","Boolean","location","hostname","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","ReactDOM","App","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"sQAIMA,EAAe,CACpBC,KAAM,KACNC,YAAY,EACZC,MAAM,EACNC,SAAU,ICELJ,EAAe,CACjBK,gBAAgB,EAChBC,YAAY,EACfC,SAAU,KACVC,YAAa,GACbL,MAAM,GCPDH,EAAe,CACpBS,aAAc,GACdC,UAAW,GACXC,eAAgB,KAChBC,gBAAiB,M,OCNZZ,EAAe,CACpBa,cAAe,GACfC,iBAAkB,GAClBC,eAAgB,GAChBC,MAAO,ICJFhB,EAAe,CACpBiB,kBAAmB,GACnBC,qBAAsB,GACtBC,OAAQ,GACRC,kBAAmB,ICEdpB,EAAe,CACpBqB,iBAAkB,GAClBC,oBAAqB,GACrBC,kBAAmB,GACnBC,cAAc,EACdC,cAAe,KACfC,gBAAgB,EAChBC,gBAAiB,GACjBC,MAAO,ICPF5B,EAAe,CACpB6B,uBAAwB,GACxBC,0BAA2B,GAC3BC,wBAAyB,GACzBC,cAAe,GACfC,iBAAkB,GAClBC,eAAgB,GAChBC,MAAO,GACPC,kBAAmB,GACnBC,WAAY,GACZC,aAAa,EACbC,aAAc,MAsIf,SAASC,EAAUC,EAAMC,GACxB,IAAIC,EAAa,GACjB,IAAI,IAAIC,KAAOH,EACdE,EAAWC,GAAOF,EAASD,EAAKG,GAAMA,EAAKH,GAE5C,OAAOE,ECvJR,IAAM3C,EAAe,CACpB6C,QAAS,GAETC,eAAe,EACfC,eAAgB,KAChBC,kBAAmB,GACnBC,qBAAsB,GACtBC,mBAAoB,GACpBC,mBAAmB,EACnBC,mBAAoB,MCffpD,EAAe,CACpBqD,aAAc,GACdC,YAAa,GACbC,sBAAsB,EACtBC,sBAAuB,KACvBC,oBAAoB,GCFfzD,EAAe,CACpBC,KAAM,KACNyD,SAAS,G,QCFJ1D,EAAe,CACpB2D,SAAU,GACVC,kBAAkB,EAClBC,iBAAiB,EACjBC,mBAAoB,KACpBC,oBAAqB,MCAPC,cAAgB,CAC3BC,UXLW,WAAyC,IAA/BC,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACtD,OAAOA,EAAOC,MACb,IYImC,wBZJP,OAAO,2BAC/BF,GADwB,IAE3BhE,YAAY,EACZD,KAAMkE,EAAOE,QAAQpE,OAEtB,IYAmC,wBZAP,OAAO,2BAC/BiE,GADwB,IAE3BhE,YAAY,EACZD,KAAM,OAEP,QAAS,OAAOiE,IWNdI,KVEW,WAAyC,IAA/BJ,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACnD,OAAOA,EAAOC,MAChB,IWpB6B,kBXoBP,OAAO,2BAChBF,GADS,IAEZ7D,gBAAgB,IAEpB,IWvBuB,kBXuBD,OAAO,2BACtB6D,GADe,IAElB7D,gBAAgB,IAE1B,IW1B4B,iBX0BP,OAAO,2BACf6D,GADQ,IAEX5D,YAAY,IAEhB,IW7BkB,aX6BD,OAAO,2BAC1B4D,GADmB,IAEtB7D,gBAAgB,EAChBE,SAAU4D,EAAOE,QAAQ9D,WAEpB,IWjCmB,cXiCD,OAAO,2BAC3B2D,GADoB,IAEvB3D,SAAU,KACVJ,MAAM,IAEP,IWrC6B,mBXqCN,OAAO,2BAC1B+D,GADmB,IAEtB/D,MAAM,EACNK,YAAa,KAEd,IWzC+B,oBXyCP,OAAO,2BAC3B0D,GADoB,IAEvB1D,YAAa2D,EAAOE,QAAQ7D,cAEvB,QAAS,OAAO0D,IUlCpBK,WTFW,WAAwC,IAA/BL,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IUMuC,4BVNP,OAAO,2BACnCF,GAD4B,IAE/BzD,aAAc0D,EAAOE,QAAQ5D,eAE9B,IUG+B,oBVHP,OAAIyD,EAAMvD,iBAAmBwD,EAAOE,QAAQ1D,eAE5D,2BACHuD,GADJ,IAECvD,eAAgB,OAIVuD,EAER,IUNoC,yBVMP,OAAO,2BAChCA,GADyB,IAE5BxD,UAAWyD,EAAOE,QAAQ3D,UAC1BC,eAAgBwD,EAAOE,QAAQ1D,eAC/BC,gBAAiB,KAElB,IUXqC,0BVWP,OAAGsD,EAAMvD,iBAAmBwD,EAAOE,QAAQ1D,eACjE,2BACHuD,GADJ,IAECvD,eAAgB,KAChBK,MAAO,GACPJ,gBAAiBuD,EAAOE,QAAQzD,kBAI1BsD,EAER,IUrBsC,2BVqBP,OAAO,2BAClCA,GAD2B,IAE9BvD,eAAgB,OAEjB,QAAS,OAAOuD,ISlCdM,URLW,WAAwC,IAA/BN,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,ISIoC,yBTJP,OAAO,2BAChCF,GADyB,IAE5BrD,cAAc,2BACVqD,EAAMrD,eADG,kBAEXsD,EAAOE,QAAQI,QAAS,IAE1B3D,iBAAiB,2BACboD,EAAMpD,kBADM,kBAEdqD,EAAOE,QAAQI,QAAS,IAE1BzD,MAAM,2BACFkD,EAAMlD,OADL,kBAEHmD,EAAOE,QAAQI,OAASN,EAAOE,QAAQK,SAG1C,ISVmC,wBTUP,OAAO,2BAC/BR,GADwB,IAE3BrD,cAAc,2BACVqD,EAAMrD,eADG,kBAEXsD,EAAOE,QAAQI,QAAS,IAE1B3D,iBAAiB,2BACboD,EAAMpD,kBADM,kBAEdqD,EAAOE,QAAQI,QAAS,IAE1B1D,eAAe,2BACXmD,EAAMnD,gBADI,kBAEZoD,EAAOE,QAAQI,OAAS,SAG3B,ISxBoC,yBTwBP,OAAO,2BAChCP,GADyB,IAE5BrD,cAAc,2BACVqD,EAAMrD,eADG,kBAEXsD,EAAOE,QAAQI,QAAS,IAE1B3D,iBAAiB,2BACboD,EAAMpD,kBADM,kBAEdqD,EAAOE,QAAQI,QAAS,IAE1B1D,eAAe,2BACXmD,EAAMnD,gBADI,kBAEZoD,EAAOE,QAAQI,OAASN,EAAOE,QAAQM,kBAG1C,QAAS,OAAOT,IQzCdU,YPNW,WAAwC,IAA/BV,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IQcgC,qBRX/B,IAAIS,EAAiB,GACrB,IAAI,IAAIC,KAAWZ,EAAM/C,OACrB+C,EAAM/C,OAAO2D,GAASL,SAAWN,EAAOE,QAAQI,SAClDI,EAAeC,GAAWZ,EAAM/C,OAAO2D,IAGzC,OAAO,2BACHZ,GADJ,IAECjD,kBAAkB,2BACdiD,EAAMjD,mBADO,kBAEfkD,EAAOE,QAAQI,QAAS,IAE1BvD,qBAAqB,2BACjBgD,EAAMhD,sBADU,kBAElBiD,EAAOE,QAAQI,QAAS,IAE1BtD,OAAO,2BACH0D,GACAV,EAAOE,QAAQU,eAIrB,IQV+B,oBRUP,OAAO,2BAC3Bb,GADoB,IAEvBjD,kBAAkB,2BACdiD,EAAMjD,mBADO,kBAEfkD,EAAOE,QAAQI,QAAS,IAE1BvD,qBAAqB,2BACjBgD,EAAMhD,sBADU,kBAElBiD,EAAOE,QAAQI,QAAS,IAE1BrD,kBAAkB,2BACd8C,EAAM9C,mBADO,kBAEf+C,EAAOE,QAAQI,OAAS,OAG3B,IQxBgC,qBRwBP,OAAO,2BAC5BP,GADqB,IAExBjD,kBAAkB,2BACdiD,EAAMjD,mBADO,kBAEfkD,EAAOE,QAAQI,QAAS,IAE1BvD,qBAAqB,2BACjBgD,EAAMhD,sBADU,kBAElBiD,EAAOE,QAAQI,QAAS,IAE1BrD,kBAAkB,2BACd8C,EAAM9C,mBADO,kBAEf+C,EAAOE,QAAQI,OAASN,EAAOE,QAAQW,qBAG1C,QAAS,OAAOd,IOlDde,UNGW,WAAwC,IAA/Bf,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IOQuC,4BPRP,OAAO,2BACnCF,GAD4B,IAE/B7C,iBAAiB,2BACb6C,EAAM7C,kBADM,kBAEd8C,EAAOE,QAAQI,QAAS,IAE1BnD,oBAAoB,2BAChB4C,EAAM5C,qBADS,kBAEjB6C,EAAOE,QAAQI,QAAS,IAE1B7C,MAAM,2BACFsC,EAAMtC,OACNuC,EAAOE,QAAQzC,SAGpB,IONsC,2BPMP,OAAO,2BAClCsC,GAD2B,IAE9B7C,iBAAiB,2BACb6C,EAAM7C,kBADM,kBAEd8C,EAAOE,QAAQI,QAAS,IAE1BnD,oBAAoB,2BAChB4C,EAAM5C,qBADS,kBAEjB6C,EAAOE,QAAQI,QAAS,IAE1BlD,kBAAkB,2BACd2C,EAAM3C,mBADO,kBAEf4C,EAAOE,QAAQI,OAAS,SAG3B,IOpBuC,4BPoBP,OAAO,2BACnCP,GAD4B,IAE/B7C,iBAAiB,2BACb6C,EAAM7C,kBADM,kBAEd8C,EAAOE,QAAQI,QAAS,IAE1BnD,oBAAoB,2BAChB4C,EAAM5C,qBADS,kBAEjB6C,EAAOE,QAAQI,QAAS,IAE1BlD,kBAAkB,2BACd2C,EAAM3C,mBADO,kBAEf4C,EAAOE,QAAQI,OAASN,EAAOE,QAAQ9C,sBAG1C,IOlCoC,yBPkCP,OAAO,2BAChC2C,GADyB,IAE5B1C,cAAc,EACdI,MAAM,2BACFsC,EAAMtC,OADL,kBAEHuC,EAAOE,QAAQa,OAAQf,EAAOE,QAAQpE,SAGzC,IOzCmC,wBPyCP,OAAO,2BAC/BiE,GADwB,IAE3B1C,cAAc,EACdC,cAAe,OAEhB,IO7CoC,yBP6CP,OAAO,2BAChCyC,GADyB,IAE5B1C,cAAc,EACdC,cAAe0C,EAAOE,QAAQ5C,gBAE/B,IOjD+B,oBPiDP,OAAO,2BAC3ByC,GADoB,IAEvBxC,gBAAgB,EAChBE,MAAM,2BACFsC,EAAMtC,OADL,kBAEHuC,EAAOE,QAAQa,OAASf,EAAOE,QAAQpE,SAG1C,IOxDoC,yBPwDP,OAAO,2BAChCiE,GADyB,IAE5BxC,gBAAgB,EAChBC,iBAAiB,IAElB,IO5DqC,0BP4DP,OAAO,2BACjCuC,GAD0B,IAE7BxC,gBAAgB,EAChBC,gBAAiBwC,EAAOE,QAAQ1C,kBAEjC,QAAS,OAAOuC,IMrFdiB,ULMW,WAAwC,IAA/BjB,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IMkB6C,kCNlBP,OAAO,2BACzCF,GADkC,IAErCrC,uBAAuB,2BACnBqC,EAAMrC,wBADY,kBAEpBsC,EAAOE,QAAQe,eAAgB,IAEjCtD,0BAA0B,2BACtBoC,EAAMpC,2BADe,kBAEvBqC,EAAOE,QAAQe,eAAgB,IAEjCjD,MAAM,2BACF+B,EAAM/B,OACNgC,EAAOE,QAAQlC,OAEnBF,iBAAiB,2BACbiC,EAAMjC,kBACNO,EAAU2B,EAAOE,QAAQlC,OAAO,kBAAM,QAG3C,IMA4C,iCNAP,OAAO,2BACxC+B,GADiC,IAEpCrC,uBAAuB,2BACnBqC,EAAMrC,wBADY,kBAEpBsC,EAAOE,QAAQe,eAAgB,IAEjCtD,0BAA0B,2BACtBoC,EAAMpC,2BADe,kBAEvBqC,EAAOE,QAAQe,eAAgB,IAEjCrD,wBAAwB,2BACpBmC,EAAMnC,yBADa,kBAErBoC,EAAOE,QAAQe,cAAgB,SAGlC,IMd6C,kCNcP,OAAO,2BACzClB,GADkC,IAErCrC,uBAAuB,2BACnBqC,EAAMrC,wBADY,kBAEpBsC,EAAOE,QAAQe,eAAgB,IAEjCtD,0BAA0B,2BACtBoC,EAAMpC,2BADe,kBAEvBqC,EAAOE,QAAQe,eAAgB,IAEjCrD,wBAAwB,2BACpBmC,EAAMnC,yBADa,kBAErBoC,EAAOE,QAAQe,cAAgBjB,EAAOE,QAAQtC,4BAGjD,IM5BiC,sBN4BP,OAAO,2BAC7BmC,GADsB,IAEzB/B,MAAM,2BACF+B,EAAM/B,OADL,kBAEHgC,EAAOE,QAAQgB,OAASlB,EAAOE,QAAQiB,OAEzChD,aAAa,IAEd,IMnCiC,sBNmCP,OAAO,2BAC7B4B,GADsB,IAEzB5B,aAAa,EACbC,aAAc,OAEf,IMvCkC,uBNuCP,OAAO,2BAC9B2B,GADuB,IAE1B5B,aAAa,EACbC,aAAc4B,EAAOE,QAAQjE,WAE9B,IM3C2C,gCN2CP,OAAO,2BACvC8D,GADgC,IAEnC9B,kBAAkB,2BACd8B,EAAM9B,mBADO,kBAEf+B,EAAOE,QAAQgB,OAASlB,EAAOE,QAAQkB,YAG1C,IMjDoC,yBNiDP,OAAO,2BAChCrB,GADyB,IAE5B/B,MAAM,2BACF+B,EAAM/B,OADL,kBAEHgC,EAAOE,QAAQgB,OAASlB,EAAOE,QAAQiB,OAEzCtD,cAAc,2BACVkC,EAAMlC,eADG,kBAEXmC,EAAOE,QAAQgB,QAAS,IAE1BpD,iBAAiB,2BACbiC,EAAMjC,kBADM,kBAEdkC,EAAOE,QAAQgB,QAAS,MAG3B,IM/DmC,wBN+DP,OAAO,2BAC/BnB,GADwB,IAE3BlC,cAAc,2BACVkC,EAAMlC,eADG,kBAEXmC,EAAOE,QAAQgB,QAAS,IAE1BpD,iBAAiB,2BACbiC,EAAMjC,kBADM,kBAEdkC,EAAOE,QAAQgB,QAAS,IAE1BnD,eAAe,2BACXgC,EAAMhC,gBADI,kBAEZiC,EAAOE,QAAQgB,OAAS,SAG3B,IM7EoC,yBN6EP,OAAO,2BAChCnB,GADyB,IAE5BlC,cAAc,2BACVkC,EAAMlC,eADG,kBAEXmC,EAAOE,QAAQgB,QAAS,IAE1BpD,iBAAiB,2BACbiC,EAAMjC,kBADM,kBAEdkC,EAAOE,QAAQgB,QAAS,IAE1BnD,eAAe,2BACXgC,EAAMhC,gBADI,kBAEZiC,EAAOE,QAAQgB,OAASlB,EAAOE,QAAQmB,eAG1C,QAAS,OAAOtB,IK9HduB,YJEW,WAAwC,IAA/BvB,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IKgCmC,wBLhCP,OAAO,2BAC/BF,GADwB,IAE3BrB,QAAQ,2BACJqB,EAAMrB,SADH,kBAELsB,EAAOE,QAAQqB,SAAWvB,EAAOE,QAAQsB,SAE3C7C,eAAe,IAEhB,IKyBmC,wBLzBP,OAAO,2BAC/BoB,GADwB,IAE3BpB,eAAe,EACfC,eAAgB,OAEjB,IKqBoC,yBLrBP,OAAO,2BAChCmB,GADyB,IAE5BpB,eAAe,EACfC,eAAgBoB,EAAOE,QAAQjE,WAEhC,IKiBwC,6BLjBP,OAAO,2BACpC8D,GAD6B,IAEhCrB,QAAQ,2BACJqB,EAAMrB,SACNsB,EAAOE,QAAQxB,SAEnBG,kBAAkB,2BACdkB,EAAMlB,mBADO,kBAEfmB,EAAOE,QAAQgB,QAAS,IAE1BpC,qBAAqB,2BACjBiB,EAAMjB,sBADU,kBAElBkB,EAAOE,QAAQgB,QAAS,MAG3B,IKGuC,4BLHP,OAAO,2BACnCnB,GAD4B,IAE/BlB,kBAAkB,2BACdkB,EAAMlB,mBADO,kBAEfmB,EAAOE,QAAQgB,QAAS,IAE1BpC,qBAAqB,2BACjBiB,EAAMjB,sBADU,kBAElBkB,EAAOE,QAAQgB,QAAS,IAE1BnC,mBAAmB,2BACfgB,EAAMhB,oBADQ,kBAEhBiB,EAAOE,QAAQgB,OAAS,SAG3B,IKXwC,6BLWP,OAAO,2BACpCnB,GAD6B,IAEhClB,kBAAkB,2BACdkB,EAAMlB,mBADO,kBAEfmB,EAAOE,QAAQgB,QAAS,IAE1BpC,qBAAqB,2BACjBiB,EAAMjB,sBADU,kBAElBkB,EAAOE,QAAQgB,QAAS,IAE1BnC,mBAAmB,2BACfgB,EAAMhB,oBADQ,kBAEhBiB,EAAOE,QAAQgB,OAASlB,EAAOE,QAAQnB,uBAG1C,IKzBwC,6BLyBP,OAAO,2BACpCgB,GAD6B,IAEhCrB,QAAQ,2BACJqB,EAAMrB,SADH,kBAELsB,EAAOE,QAAQqB,SAAWvB,EAAOE,QAAQsB,SAE3CxC,mBAAmB,IAEpB,IKhCsC,2BLgCP,OAAO,2BAClCe,GAD2B,IAE9Bf,mBAAmB,EACnBC,mBAAoB,OAErB,IKpCuC,4BLoCP,OAAO,2BACnCc,GAD4B,IAE/Bf,mBAAmB,EACnBC,mBAAoBe,EAAOE,QAAQuB,cAEpC,QAAS,OAAO1B,IIpFd2B,mBHTW,WAAwC,IAA/B3B,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IIoDwC,6BJpDP,OAAO,2BACpCF,GAD6B,IAEhCZ,YAAaa,EAAOE,QAAQf,YAC5BC,sBAAsB,EACtBE,oBAAoB,IAErB,II+C6C,kCJ/CP,OAAO,2BACzCS,GADkC,IAErCb,aAAcc,EAAOE,QAAQhB,aAC7BE,sBAAsB,EACtBE,oBAAoB,IAGrB,IIyC8C,mCJzCP,OAAO,2BAC1CS,GADmC,IAEtCX,sBAAsB,EACtBE,oBAAoB,EACpBD,sBAAuBW,EAAOE,QAAQb,wBAEvC,QAAS,OAAOU,IGXd4B,WFVW,WAAyC,IAA/B5B,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACtD,OAAOA,EAAOC,MACb,IGwDiC,sBHxDP,OAAO,2BAC7BF,GADsB,IAEzBjE,KAAMkE,EAAOE,QAAQpE,KACrByD,SAAS,IAEV,IGoD+B,oBHpDP,OAAO,2BAC3BQ,GADoB,IAEvBjE,KAAMkE,EAAOE,QAAQpE,KACrByD,SAAS,IAEV,QAAS,OAAOQ,IEDd6B,aDRW,WAAwC,IAA/B7B,EAA8B,uDAAtBlE,EAAcmE,EAAQ,uCACrD,OAAOA,EAAOC,MACb,IEwDiC,sBFxDP,OAAO,2BAC7BF,GADsB,IAEzBP,SAAUQ,EAAOE,QAAQV,SACzBqC,uBAAuB,EACvBnC,iBAAiB,IAElB,IEmDsC,2BFnDP,OAAO,2BAClCK,GAD2B,IAE9B8B,uBAAuB,EACvBnC,iBAAiB,EACjBC,mBAAoB,OAErB,IE8CuC,4BF9CP,OAAO,2BACnCI,GAD4B,IAE/B8B,uBAAuB,EACvBnC,iBAAiB,EACjBC,mBAAoBK,EAAOE,QAAQmB,aAEpC,IEyCkC,uBFxCjC,IAAMS,EAAgB9B,EAAOE,QAAQ6B,kBAClChC,EAAMP,SAASwC,WAAU,SAAAZ,GAAO,OAAIA,EAAQa,KAAOjC,EAAOE,QAAQ6B,sBACjE,EACJ,OAAGD,GAAgB,EACX,2BACH/B,GADJ,IAECP,SAAS,GAAD,mBACJO,EAAMP,SAAS0C,MAAM,EAAGJ,IADpB,CAEP9B,EAAOE,QAAQiC,gBAFR,YAGJpC,EAAMP,SAAS0C,MAAMJ,EAAe,OAInC,2BACH/B,GADJ,IAECP,SAAS,GAAD,mBACJO,EAAMP,UADF,CAEPQ,EAAOE,QAAQiC,mBAIlB,IEoB0C,+BFpBP,OAAO,2BACtCpC,GAD+B,IAElCP,SAAUO,EAAMP,SAAS4C,KAAI,SAAAhB,GAC5B,OAAGA,EAAQa,KAAOjC,EAAOE,QAAQmC,mBACzB,2BACHjB,GADJ,IAECkB,YAAY,IAGPlB,OAGT,IESuC,4BFTP,OAAO,2BACnCrB,GAD4B,IAE/BH,oBAAqBI,EAAOE,QAAQN,sBAErC,QAAS,OAAOG,M,0EG5DlB,SAASwC,EAAsBjC,EAAQ7C,GACtC,MAAO,CACNwC,KDgBuC,4BCfvCC,QAAS,CAACI,SAAQ7C,UAGpB,SAAS+E,EAAqBlC,GAC7B,MAAO,CACNL,KDWsC,2BCVtCC,QAAS,CAACI,WAGZ,SAASmC,EAAsBnC,EAAQlD,GACtC,MAAO,CACN6C,KDMuC,4BCLvCC,QAAS,CAACI,WAGZ,SAASoC,EAAmB3B,EAAQjF,GACnC,MAAO,CACNmE,KDCoC,yBCApCC,QAAS,CAACa,SAAQjF,SAYpB,SAAS6G,EAAgB5B,EAAQjF,GAChC,MAAO,CACNmE,KDX+B,oBCY/BC,QAAS,CACRa,SACAjF,SAOH,SAAS8G,EAAqBpF,GAC7B,MAAO,CACNyC,KDrBqC,0BCsBrCC,QAAS,CAAC1C,oBAQL,SAASqF,EAA6BvC,GAC5C,8CAAO,WAAMwC,GAAN,mBAAAC,EAAA,6DACAC,EAAQC,IAASC,YACrBC,WC1E4B,SD2E5BC,MAAM,WAAY,iBAAkB9C,GACtCwC,EAASN,EAAqBlC,IAJxB,kBAMuB0C,EAAMK,MAN7B,OAMCC,EAND,OAOC7F,EAAQ6F,EAAcC,KAAKC,QAAO,SAAC/F,EAAOgG,GAE/C,OADAhG,EAAMgG,EAAIxB,IAAMwB,EAAIC,OACbjG,IACL,IACHqF,EAASP,EAAsBjC,EAAQ7C,IAXlC,kDAaLqF,EAASL,EAAsBnC,EAAD,OAbzB,0DAAP,sDAqBM,SAASqD,EAA8B5C,GAC7C,8CAAO,WAAM+B,GAAN,iBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACnBC,WChG4B,SDgGCM,IAAI1C,GACnC+B,EAzDM,CAAC7C,KDH4B,0BCyD7B,kBAKa2D,EAAIP,MALjB,OAKCI,EALD,OAMLX,EAASJ,EAAmB3B,EAAQ0C,EAAIC,QAAU,OAN7C,gDAQLZ,EA3DK,CACN7C,KDNoC,yBCOpCC,QAAS,CAAC5C,cAyDkB,QARtB,yDAAP,sDEvFcuG,kBAAQ,KAAM,CAACC,cCSvB,WACH,MAAO,CACH7D,KJlBuB,qBGOhB4D,EAHf,YAAuC,IAAjBC,EAAgB,EAAhBA,cACrB,OAAO,4BAAQC,UAAU,OAAOC,QAASF,GAAgB,YEa1D,IASeD,eATS,SAAC,GAAuB,IAAtB1D,EAAqB,EAArBA,KAAMW,EAAe,EAAfA,UACzBC,EAASZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IAC9C,MAAO,CACN7H,SAAU+D,EAAK/D,SACf8H,aAA0C,OAA5BpD,EAAUrD,MAAMsD,GAC9BjF,KAAMgF,EAAUrD,MAAMsD,MAIT8C,EAnBf,YAAiE,IAArCzH,EAAoC,EAApCA,SAAU8H,EAA0B,EAA1BA,aAA0B,IAAZpI,YAAY,MAAP,KAAO,EACzDqI,EAAQrI,GAAQA,EAAKqI,MAAS/H,EAASgI,YACvCC,EAAQH,ECJuB,gBAHL,gBDSXI,QAAQ,OAAQlI,EAAS6H,KAC9C,OACC,kBAAC,IAAD,CAAMM,GAAIF,GAAOF,ME4BnB,IASMK,EAAqB,CAC1BC,qBHsBM,WACH,OAAO,SAAA3B,GAEHG,IAAS9C,OAAOuE,oBAAmB,SAAStI,GACrCA,GACC0G,EAhDhB,SAAmB1G,GACf,MAAO,CACH6D,KJ9BkB,aI+BlBC,QAAS,CAAC9D,aA6COuI,CAAUvI,IAC/B0G,EAASa,EAA8BvH,EAAS6H,OAEpCnB,EA5CL,CACH7C,KJnCmB,mBIkFnB6C,EA3DG,CACH7C,KJ1BsB,qBOmD7B2E,kBHOM,WACH,8CAAO,WAAM9B,GAAN,SAAAC,EAAA,6DACTD,EAnBM,CACN7C,KJvC6B,qBIwDpB,kBAGFgD,IAAS9C,OAAO0E,UAHd,OAIF/B,EA3BE,CACH7C,KJnCmB,gBIyDhB,gDAMR6C,EAnBK,CACN7C,KJ3C+B,oBI4C/BC,QAAS,CACR7D,YAgByB,EAAD,MANhB,yDAAP,wDGNWwH,eAbS,SAAC,GAAuB,IAAtB1D,EAAqB,EAArBA,KAAMW,EAAe,EAAfA,UACzBC,EAASZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IAC9C,MAAO,CACN9H,WAAYgE,EAAKhE,WACjBC,SAAU+D,EAAK/D,SACf8H,aAA0C,OAA5BpD,EAAUrD,MAAMsD,GAC9B/E,KAAMmE,EAAKnE,MAAQ8E,EAAUzD,gBAOSmH,EAAzBX,EA/Cf,YAOC,IANA1H,EAMD,EANCA,WACAC,EAKD,EALCA,SACA8H,EAID,EAJCA,aACAlI,EAGD,EAHCA,KACAyI,EAED,EAFCA,qBACAG,EACD,EADCA,kBAEAE,qBAAU,WACL3I,GACHsI,MAEC,CAACtI,EAAYsI,IAChB,IAAMM,EAAiBC,YDfc,iBCgBrC,OAAGhJ,EACK,aAELkI,IAAY,OAAI9H,QAAJ,IAAIA,OAAJ,EAAIA,EAAU6H,OAAQc,EAC7B,kBAAC,IAAD,CAAUR,GDpBmB,mBCsBjCL,IAAD,OAAiB9H,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAU6H,MAAOc,EAC7B,kBAAC,IAAD,CAAUR,GD1Bc,gBC0BQD,QAAQ,OAAQlI,EAAS6H,OAE9D7H,EAED,kBAAC,WAAD,KACC,kBAAC,EAAD,MACA,4BAAQ4H,QAASY,GAAjB,WAKI,kBAAC,EAAD,SCXR,IAGef,eAHS,SAAC,GAAD,YAAa,CACpC9C,OAAM,UADiB,EAAEZ,KACZ/D,gBAAP,aAAE,EAAe6H,OAETJ,EAvBf,YAA+B,IAAV9C,EAAS,EAATA,OACpB,OACC,kBAAC,WAAD,KACC,6BACC,kBAAC,IAAD,CAAMwD,GFTsB,WES5B,cAGCxD,GAAU,kBAAC,IAAD,CAAMwD,GFXW,kBEWUD,QAAQ,UAAWvD,IAA9C,YAGX,kBAAC,IAAD,CAAMwD,GFXqB,UEW3B,UAID,6BACC,kBAAC,EAAD,WCYWU,MAzBf,WACC,IAAIC,EAAW,GAsBf,OArBGF,YHV6B,mBGW/BE,EAAW,WAETF,YHZ4B,aGa9BE,EAAW,cAETF,YHd4B,qBGe9BE,EAAW,UAETF,YHhBkC,mBGiBpCE,EAAW,gBAETF,YHlB0B,mBGmB5BE,EAAW,cAETF,YHpB2B,YGqB7BE,EAAW,SAETF,YHtB0B,oBGuB5BE,EAAW,SAELA,G,yTChCR,IAAMC,EAAeC,IAAOC,OAAV,KA0BHC,MAXf,SAAgBC,GACf,OACC,kBAACJ,EAAD,iBAAkBI,EAAlB,CAAyBtF,KAAK,WAC7B,yBAAKuF,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,MAAM,8BACjE,0BAAMC,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,OAAO,QAAQC,YAAY,IAAIC,cAAc,UAChF,0BAAMN,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,OAAO,QAAQC,YAAY,IAAIC,cAAc,UAChF,0BAAMN,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,OAAO,QAAQC,YAAY,IAAIC,cAAc,a,k9BClBtF,IAAMC,GAAkBhB,IAAOiB,OAAV,MAKfC,GAAalB,IAAOmB,IAAV,MAIVC,GAAgBpB,IAAOmB,IAAV,MAchB,qBAAEE,WAAe,sCAWdC,GAAsBtB,IAAOuB,GAAV,KAsCVC,OA3Bf,WAAmB,IAAD,EACWC,oBAAS,GADpB,mBACVJ,EADU,KACCK,EADD,KAajB,OAXAhC,qBAAU,WACT,SAASiC,IACRD,GAAO,GAGR,OADAE,OAAOC,iBAAiB,QAASF,GAC1B,kBAAMC,OAAOE,oBAAoB,QAASH,MAC/C,CAACD,IAMH,kBAACV,GAAD,KACC,kBAACE,GAAD,YACA,kBAACE,GAAD,CAAeC,UAAWA,GACzB,kBAAC,EAAD,OAED,kBAACC,GAAD,KACC,kBAAC,EAAD,OAED,kBAAC,EAAD,CAAQ1C,QAbV,SAAuBmD,GACtBA,EAAEC,kBACFN,GAAQL,Q,uZC1DV,IAAMY,GAAYjC,IAAOmB,IAAV,MAUTe,GAAYlC,IAAOmB,IAAV,MAqDAgB,OAhDf,YAA2C,IAA3BC,EAA0B,EAA1BA,cAAeC,EAAW,EAAXA,SAyC9B,OAvCA3C,qBAAU,WAOT,OANGkC,OAAOU,UACTC,SAASC,KAAKC,MAAMC,IAApB,WAA8Bd,OAAOU,QAArC,OAEDC,SAASC,KAAKC,MAAMrC,MAAQ,OAC5BmC,SAASC,KAAKC,MAAME,SAAW,QAExB,WACN,IAAMD,EAAMH,SAASC,KAAKC,MAAMC,IAC7BA,IACFd,OAAOgB,SAAS,EAAGC,WAAWH,EAAIxD,QAAQ,IAAK,IAAIA,QAAQ,KAAM,MACjEqD,SAASC,KAAKC,MAAMC,IAAM,IAE3BH,SAASC,KAAKC,MAAMrC,MAAQ,GAC5BmC,SAASC,KAAKC,MAAME,SAAW,OAIjCjD,qBAAU,WACT,SAASoD,EAAWf,GACR,WAAVA,EAAE1I,KAAqB+I,GAAiBA,EAAcL,GAIxD,OAFAQ,SAASV,iBAAiB,QAASiB,GAE5B,WACNP,SAAST,oBAAoB,QAASgB,OAevC,kBAACb,GAAD,CAAWrD,QANZ,SAAmBmD,GACfK,GAAiBL,EAAEgB,SAAWhB,EAAEiB,eAClCZ,EAAcL,KAKd,kBAACG,GAAD,KAAYG,K,+HCnDf,IAAMY,GAAW,CAEbC,WAAY,QAEfC,cAAe,CACdtF,IAAS9C,KAAKqI,mBAAmBC,YACjCxF,IAAS9C,KAAKuI,kBAAkBD,aAEjCE,iBAAkBC,QAAgBC,iBAAiBC,KACnDC,UAAW,CACVC,4BADU,WAET,OAAO,KAIJC,GAAqB7D,IAAOmB,IAAV,MAiBT1C,mBAAQ,KAAM,CAACqF,cTrBvB,WACH,MAAO,CACHjJ,KJtBuB,qBayChB4D,EAVf,YAAqC,IAAjBqF,EAAgB,EAAhBA,cACnB,OACC,kBAAC,GAAD,CAAO1B,cAAe0B,GACrB,kBAACD,GAAD,KACC,kBAAC,KAAD,CAAoBZ,SAAUA,GAAUc,aAAclG,IAAS9C,cC3B5D,SAASiJ,GAAmB9I,EAAQC,GAC1C,MAAO,CACNN,KdQoC,yBcPpCC,QAAS,CACRI,SACAC,SAIH,SAAS8I,GAAkB/I,GAC1B,MAAO,CACNL,KdAmC,wBcCnCC,QAAS,CAACI,WAGZ,SAASgJ,GAAmBhJ,EAAQE,GACnC,MAAO,CACNP,KdLoC,yBcMpCC,QAAS,CAACI,SAAQE,kBAQZ,SAAS+I,GAA0BjJ,GACzC,8CAAO,WAAMwC,GAAN,iBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACnBC,WZpC2B,SYqC3BM,IAAInD,GACNwC,EAASuG,GAAkB/I,IAJrB,kBAMYsD,EAAIP,MANhB,WAMAI,EANA,QAOE+F,OAPF,sBAQC,IAAIC,MAAM,mCAAqCnJ,GARhD,OAULwC,EAASsG,GAAmB9I,EAAQmD,EAAIC,SAVnC,kDAYLZ,EAASwG,GAAmBhJ,EAAD,OAZtB,0DAAP,sDClBF,SAASoJ,GAAgBlN,GACxB,MAAO,CACNyD,KfI+B,oBeH/BC,QAAS,CAAC1D,mBAGZ,SAASmN,GAAoBpN,EAAWC,GACvC,MAAO,CACNyD,KfDoC,yBeEpCC,QAAS,CAAC3D,YAAWC,mBAGvB,SAASoN,GAAqBnN,EAAiBD,GAC9C,MAAO,CACNyD,KfNqC,0BeOrCC,QAAS,CAACzD,kBAAiBD,mB,8tBC/B7B,IAAMqN,GAAuBzE,IAAO0E,KAAV,MAOvB,qBAAEC,UAAsB,uDAMrBC,GAA2B5E,IAAO6E,KAAV,MAMxBC,GAAqB9E,IAAO+E,MAAV,MASlBC,GAAoBhF,IAAOC,OAAV,MAOvB,SAASgF,GAAT,GAAkC,IAARC,EAAO,EAAPA,KACzB,OAAIA,EAGG,kBAACN,GAAD,KAA2BM,GAF1B,KAIT,SAASC,GAAT,GAAqD,IAAzBC,EAAwB,EAAxBA,YAAaT,EAAW,EAAXA,SACxC,OAAIS,GAAeT,EACX,KAGP,kBAACK,GAAD,CAAmBnK,KAAK,UAAUuK,GA6BrBC,OA1Bf,YAQI,IAPHC,EAOE,EAPFA,MACAC,EAME,EANFA,SAME,IALFC,gBAKE,MALS,SAACzD,GAAD,OAAOA,EAAE0D,kBAKlB,MAJFL,mBAIE,MAJY,KAIZ,MAHFF,YAGE,MAHK,KAGL,MAFFQ,mBAEE,MAFY,gBAEZ,EADFf,EACE,EADFA,SAEA,OACC,kBAACF,GAAD,CAAsBe,SAAU,SAAAzD,GAC/BA,EAAE0D,iBACFD,IAAab,GAAYa,EAASF,IAE7BX,SAAUA,GACf,kBAACM,GAAD,CAAiBC,KAAMA,IACvB,kBAACJ,GAAD,CAAoBjK,KAAK,OACpByK,MAAOA,EACPC,SAAU,SAAAxD,GAAC,OAAIwD,EAASxD,EAAEgB,OAAOuC,QACjCI,YAAaA,EACbf,SAAUA,IACf,kBAACQ,GAAD,CAAmBC,YAAaA,EAAaT,SAAUA,MCvE3C,qBACd,yBAAKvE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,KAAK,OAAOC,MAAM,8BACjE,4BAAQmF,GAAG,UAAUC,GAAG,UAAUC,EAAE,UAAUhF,OAAO,eAAeC,YAAY,MAChF,0BAAML,GAAG,UAAUC,GAAG,UAAUC,GAAG,UAAUC,GAAG,UAAUC,OAAO,eAAeC,YAAY,IAAIC,cAAc,YC+BhH,IAgBetC,gBAhBS,SAAC,GAAD,IAAEzD,EAAF,EAAEA,WAAF,MAAmB,CAC1C9D,aAAc8D,EAAW9D,aACzBC,UAAW6D,EAAW7D,cAEI,SAACuG,GAAD,MAAe,CACzCoI,yBADyC,SAChB5O,GACxBwG,EH7BK,SAAgCxG,GACtC,MAAO,CACN2D,KfSuC,4BeRvCC,QAAS,CAAC5D,iBG0BD6O,CAAuB7O,KAEjC8O,yBAJyC,SAIhB7O,GACxBuG,EHCK,SAAgCvG,GAGtC,8CAAO,WAAMuG,GAAN,iBAAAC,EAAA,sDACAsI,EAAapI,IAASC,YAC1BC,WbhD4B,SaiD5BC,MAAM,aAAc,iBAAkB7G,IAClCC,EAAiB6O,EAAWhI,OACnBiI,MACd,SAAAhI,GACC,IAAMzG,EAAQyG,EAAcC,KAAKC,QAAO,SAAC3G,EAAO4G,GAE/C,OADA5G,EAAM4G,EAAIxB,IAAMwB,EAAIC,OACb7G,IACL,IAEH,IAAI,IAAIyD,KADRwC,EAAS4G,GAAgBlN,IACPK,EACjBiG,EAASsG,GAAmB9I,EAAQzD,EAAMyD,QAI5C,SAAA7D,GACCqG,EAAS8G,GAAqBnN,EAAiBD,OAGjDsG,EAAS6G,GAAoBpN,EAAWC,IArBlC,2CAAP,sDGJU+O,CAAuBhP,KAEjCiP,wBAPyC,WAQxC1I,EHVM,CAAC7C,KfV+B,iCkBwBzB4D,EA1Cf,YAMI,IALHvH,EAKE,EALFA,aACAC,EAIE,EAJFA,UACA2O,EAGE,EAHFA,yBACAE,EAEE,EAFFA,yBACAI,EACE,EADFA,wBAYA,OACC,kBAAC,GAAD,CAAad,MAAOpO,EAChBwO,YAAY,yBACZH,SAbL,SAA8BrO,GAC7B,IAAMmP,EAAmBnP,EAAaoP,cAAcC,OAAOC,UAAU,EAAE,GAEnEH,EAAiBI,OAAS,GAAMtP,EACnCiP,IACuC,IAA5BC,EAAiBI,QAAkBJ,IAAqBlP,GACnE6O,EAAyBK,GAE1BP,EAAyB5O,IAMrBgO,KAAM,kBAACwB,GAAD,W,sOC3BZ,IAAMC,GAAgB3G,IAAO6E,KAAV,MAKb+B,GAAe5G,IAAO6E,KAAV,MAMHgC,OAHf,WACC,OAAO,kBAACF,GAAD,KAAe,kBAACC,GAAD,qB,gOCTvB,IAAME,GAAiB9G,IAAO6E,KAAV,MAKdkC,GAAgB/G,IAAOgH,IAAV,MAWJC,OARf,YAA+B,IAATC,EAAQ,EAARA,MACfC,EAAaD,GAASA,EAAME,UAAYF,EAAME,YAAeF,GAAS,iBAC5E,OACC,kBAACJ,GAAD,KACC,kBAACC,GAAD,KAAgBI,KCenB,IAYe1I,gBAZS,SAAC,EAAD,OAAExD,EAAF,EAAEA,UAAaC,EAAf,EAAeA,OAAf,MAA4B,CACnDC,KAAMF,EAAUxD,MAAMyD,GACtBtE,KAAMqE,EAAU3D,cAAc4D,GAC9BgM,MAAOjM,EAAUzD,eAAe0D,OAGN,SAAAwC,GAAQ,MAAK,CACvC2J,UADuC,SAC7BnM,GACTwC,EAASyG,GAA0BjJ,QAItBuD,EArCf,YAUI,IATHvD,EASE,EATFA,OACAoM,EAQE,EARFA,UAQE,IAPFC,sBAOE,MAPeV,GAOf,MANFW,sBAME,MANeP,GAMf,EALF9L,EAKE,EALFA,KACAsM,EAIE,EAJFA,UACAxL,EAGE,EAHFA,WACAoL,EAEE,EAFFA,UACGlH,EACD,qHAMF,OALAT,qBAAU,WACLvE,GAASsM,GAAcxL,GAC1BoL,EAAUnM,KAET,CAACA,EAAQC,EAAMsM,EAAWxL,EAAYoL,IACtCpL,EACK,kBAACuL,EAAD,CAAgBtM,OAAQA,EAAQgM,MAAOjL,IAE5Cd,EACK,kBAACmM,EAAD,eAAWpM,OAAQA,EAAQC,KAAMA,GAAUgF,IAE5C,kBAACoH,EAAD,CAAgBrM,OAAQA,O,4rBCzBhC,IAAMwM,GAAO1H,IAAOmB,IAAV,MAYP,qBAAEwG,OAAgB,wHAQfC,GAAU5H,IAAO6H,IAAV,MAQPC,GAAW9H,IAAOmB,IAAV,MAeC4G,OATf,YAA2C,IAAxB5M,EAAuB,EAAvBA,KAAMwM,EAAiB,EAAjBA,MAAO/I,EAAU,EAAVA,QAC/B,OACC,kBAAC8I,GAAD,CAAMC,MAAOA,EAAO/I,QAASA,GAC5B,6BAAMzD,EAAK6M,UACV7M,EAAK8M,KAAO,kBAACL,GAAD,CAASM,IAAK/M,EAAK8M,IAAKE,IAAKhN,EAAK4D,OAC9C5D,EAAK+J,MAAQ,kBAAC4C,GAAD,KAAW3M,EAAK+J,QCvBjC,IAUezG,gBAVS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAMW,EAAR,EAAQA,UAAR,MAAwB,CAC/CC,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IACvCnI,KAAMgF,EAAUX,EAAK/D,UAAY+D,EAAK/D,SAAS6H,SAErB,SAAAnB,GAAQ,MAAK,CACvC0K,8BADuC,SACTzM,EAAQT,EAAQmN,GAC7C3K,EtBwFM,SAAqC/B,EAAQT,EAAQmN,GAC5D,8CAAO,WAAM3K,GAAN,qBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACnBC,WCnH4B,SDmHCM,IAAI1C,GACnC+B,EA1DM,CAAC7C,KDlB6B,2BCyE9B,kBAKa2D,EAAIP,MALjB,UAKCI,EALD,QAOD3H,EAAO2H,EAAIC,QACTgK,EAAcD,EAAW,YAAc,eACnB3R,EAAK4R,GAAaC,QAAQrN,GAAU,GATzD,kCAUEsD,EAAIgK,OAAJ,eACJF,EAAczK,IAASC,UAAU2K,WAAWC,WAAWxN,KAXrD,QAaJxE,EAAK4R,GAAe5R,EAAK4R,IAAgB,GACzC5R,EAAK4R,GAAaK,KAAKzN,GAdnB,QAgBLwC,EAASH,EAAgB5B,EAAQjF,IAhB5B,kDAkBLgH,EAASF,EAAqB,EAAD,KAlBxB,0DAAP,sDsBzFUoL,CAA4BjN,EAAQT,EAAQmN,IACrD3K,ECZM,CACN7C,KxBGmC,8BuBWtB4D,EArBf,YAAgF,IAAjDvD,EAAgD,EAAhDA,OAAQS,EAAwC,EAAxCA,OAAQyM,EAAgC,EAAhCA,8BAI9C,OACC,yBAAKzJ,UAAU,yBACd,kBAAC,GAAD,CAAYzD,OAAQA,EAAQoM,UAAWS,GAAUnJ,QALnC,WACfwJ,EAA8BzM,EAAQT,GAAQ,UEMhD,IAiBeuD,gBAjBS,SAAC,GAA6B,IAA5BxD,EAA2B,EAA3BA,UACrB4N,EAAgB,GACd3R,EAF8C,EAAhB8D,WAEJ9D,aAAaoP,cAC7C,IAAK,IAAIpL,KAAUD,EAAUxD,MAAO,CACnC,IAAI0D,EAAOF,EAAUxD,MAAMyD,GACVC,EAAK2N,KAAKC,MAAK,SAACC,GAChC,OAAmD,IAA5CA,EAAI1C,cAAciC,QAAQrR,QAGjC2R,EAAc3N,GAAUC,GAG1B,MAAO,CACN1D,MAAOoR,KAIMpK,EA5Bf,YAAqC,IAAThH,EAAQ,EAARA,MACvBwR,EAAiB,GACrB,IAAK,IAAI/N,KAAUzD,EAClBwR,EAAeN,KAAK,kBAAC,GAAD,CACnBzN,OAAQA,EACRC,KAAM1D,EAAMyD,GACZ7B,IAAK6B,KAEP,OAAO+N,KCLFxG,GAAQ,CACb,gBAAmB,QACnB,UAAa,QACb,MAAS,QACT,QAAW,OACX,UAAa,WAuBd,IAMehE,gBANS,SAAA9D,GAAK,MAAK,MACP,SAAA+C,GAAQ,MAAK,CACvCwL,qBADuC,WAEtCxL,EFzBM,CACN7C,KxBGmC,8B0BwBtB4D,EA1Bf,YAAiD,IAAxByK,EAAuB,EAAvBA,qBAexB,OACC,kBAAC,GAAD,CAAOC,eAfe,kBACtB,yBAAK1G,MAAOA,IACX,4CACA,gCACC,uCACA,yCAED,kBAAC,GAAD,MACA,6BACC,kBAAC,GAAD,SAMqCL,cAAe8G,OCzBlDE,G,2KAEJ,OAAIC,KAAKlJ,MAAMrJ,eACP,kBAAC,GAAD,MACGuS,KAAKlJ,MAAMmJ,oBACd,kBAAC,GAAD,MAED,S,GAPYC,IAAMC,eAeZ/K,gBAJS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAML,EAAR,EAAQA,UAAR,MAAwB,CAC/C5D,eAAgBiE,EAAKjE,eACrBwS,oBAAqB5O,EAAU/D,cAEjB8H,CAAyB2K,ICFxC,SAASK,GAA4B5N,EAAejD,GACnD,MAAO,CACNiC,K5B0B6C,kC4BzB7CC,QAAS,CAACe,gBAAejD,UAG3B,SAAS8Q,GAA2B7N,GACnC,MAAO,CACNhB,K5BqB4C,iC4BpB5CC,QAAS,CAACe,kBAGZ,SAAS8N,GAA4B9N,EAAerD,GACnD,MAAO,CACNqC,K5BgB6C,kC4Bf7CC,QAAS,CAACe,gBAAerD,4BAG3B,SAASoR,GAAiB9N,EAAQC,GACjC,MAAO,CACNlB,K5BWiC,sB4BVjCC,QAAS,CAACgB,SAAQC,SAcb,SAAS8N,GAA0B7N,GACzC,MAAO,CACNnB,K5BH2C,gC4BI3CC,QAAS,CAACgB,OAAQE,EAAQF,OAAQE,YAGpC,SAAS8N,GAAmBhO,EAAQC,GACnC,MAAO,CACNlB,K5BRoC,yB4BSpCC,QAAS,CAACgB,SAAQC,SAGpB,SAASgO,GAAkBjO,GAC1B,MAAO,CACNjB,K5BbmC,wB4BcnCC,QAAS,CAACgB,WAGZ,SAASkO,GAAmBlO,EAAQG,GACnC,MAAO,CACNpB,K5BlBoC,yB4BmBpCC,QAAS,CAACgB,SAAQG,eAQb,SAASgO,GAAmCpO,GAClD,8CAAO,WAAM6B,GAAN,mBAAAC,EAAA,6DAEAC,EAAQC,IAASC,YAAYC,W1BnFL,S0BoF5BC,MAAM,iBAAkB,iBAAkBnC,GAC5C6B,EAASgM,GAA2B7N,IAJ9B,kBAMuB+B,EAAMK,MAN7B,OAMCC,EAND,OAOCtF,EAAQsF,EAAcC,KAAKC,QAAO,SAACxF,EAAOyF,GAE/C,OADAzF,EAAMyF,EAAIxB,IAAMwB,EAAIC,OACb1F,IACL,IACH8E,EAAS+L,GAA4B5N,EAAejD,IAX/C,kDAaL8E,EAASiM,GAA4B9N,EAAD,OAb/B,0DAAP,sDCvED,SAASqO,GAAkB9P,GAC1B,MAAO,CACNS,K7B4DiC,sB6B3DjCC,QAAS,CACRV,aAiBH,SAAS+P,GAAmBxN,EAAmBI,GAC9C,MAAO,CACNlC,K7B0CkC,uB6BzClCC,QAAS,CACR6B,oBACAI,mBCrBH,IAce0B,gBAdS,SAAC,GAA0B,IAAzB1D,EAAwB,EAAxBA,KAAMyB,EAAkB,EAAlBA,aAC/B,MAAO,CACPb,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IACvCrE,oBAAqBgC,EAAahC,wBAER,SAAAkD,GAAQ,MAAK,CACvC0M,oBADuC,SACnBzO,GACnB+B,EDoHK,SAAsC/B,GAC5C,OAAO,SAAA+B,GACN,IAGMlD,EAHQqD,IAASC,YAAYC,W3B1IF,Y2B2I9BC,MAAM,cAAe,KAAMrC,GAC3BqC,MAAM,aAAc,IAAK,IAAIqM,MACEC,YAChC,SAAApM,GACCA,EAAcqM,aAAaC,SAAQ,SAAAC,GAClC,IAAMC,EAAiBD,EAAOpM,IAAIC,OAClCZ,EAASyM,GACPM,EAAOpM,IAAIxB,GADc,YAAC,aAGzBA,GAAI4N,EAAOpM,IAAIxB,IACZ6N,GAJqB,IAKxBC,SAAUD,EAAeC,SAASC,SAClCC,WAAYH,EAAeG,WAAWD,SACtC1N,WAAYuN,EAAOpM,IAAIyM,SAASC,qBAInCrN,EAASmM,GAA0BY,EAAOpM,IAAIC,eAGhD,SAAAjC,GACC,MAAMA,KAGTqB,EArHF,SAA+BlD,GAC9B,MAAO,CACNK,K7B2BuC,4B6B1BvCC,QAAS,CACRN,wBAiHQwQ,CAAsBxQ,KC/ItByQ,CAA6BtP,KAEvCuP,sBAJuC,SAIjB1Q,GACrBkD,ED+BK,SAAiClD,GAEvC,OADAA,IACO,CACNK,K7BkBuC,4B6BjBvCC,QAAS,CACRN,oBAAqB,OCpCb2Q,CAAwB3Q,QAIpBiE,EAzBf,YAA2G,IAA3E9C,EAA0E,EAA1EA,OAAQnB,EAAkE,EAAlEA,oBAAqB4P,EAA6C,EAA7CA,oBAAqBc,EAAwB,EAAxBA,sBASjF,OARAxL,qBAAU,WACN/D,IAAWnB,GACb4P,EAAoBzO,IAEjBA,GAAUnB,GACb0Q,EAAsB1Q,MAGjB,Q,0bCTR,IAAM4Q,GAAkBpL,IAAOqL,OAAV,MAWfC,GAAmBtL,IAAOmB,IAAV,MAqBPoK,OAff,WACC,OACC,kBAACH,GAAD,KACC,6BACC,kBAAC,IAAD,CAAMjM,GzBxBsB,WyBwB5B,eAED,6BACC,kBAAC,IAAD,CAAMA,GzBvBqB,UyBuB3B,UAED,kBAACmM,GAAD,8CCZH,IAgBe7M,gBAhBS,SAAC,EAAD,GAA4B,IAA1B/C,EAAyB,EAAzBA,UAAaR,EAAY,EAAZA,OAGtC,MAAO,CACNsQ,UAHiBC,OAAOC,OAAOhQ,EAAUrD,OACxCsT,QAAO,SAAAjV,GAAI,OAAIA,GAAQA,EAAKkV,UAAYlV,EAAKkV,SAASrD,QAAQrN,IAAW,KAAGuL,OAG7E7P,KAAM8E,EAAU5D,iBAAiBoD,GACjCgM,MAAOxL,EAAU1D,kBAAkBkD,GACnC2Q,QAASnQ,EAAU3D,oBAAoBmD,OAGd,SAAAwC,GAAQ,MAAK,CACvCoO,+BADuC,SACR5Q,GAC9BwC,EAASD,EAA6BvC,QAIzBuD,EAjCf,YAAoG,IAA3EvD,EAA0E,EAA1EA,OAAQsQ,EAAkE,EAAlEA,UAAW5U,EAAuD,EAAvDA,KAAMsQ,EAAiD,EAAjDA,MAAO2E,EAA0C,EAA1CA,QAASC,EAAiC,EAAjCA,+BAMjE,OALApM,qBAAU,WACL9I,GAASiV,GACZC,EAA+B5Q,KAE9B,CAACA,EAAQtE,EAAMiV,EAASC,IACxBlV,EACK,0CACGsQ,EACH,8BAAOA,EAAME,cACTyE,GAGJL,K,2cCVT,IAAMO,GAA4B/L,IAAOmB,IAAV,MAOzB6K,GAAWhM,IAAOmB,IAAV,MAOR8K,GAAejM,IAAOmB,IAAV,MAIlB,SAAS+K,GAAT,GAAkC,IAAhBhR,EAAe,EAAfA,OAAQC,EAAO,EAAPA,KACzB,OACC,kBAAC,WAAD,KACC,kBAAC,GAAD,CAAUA,KAAMA,IAChB,kBAAC6Q,GAAD,KACC,kBAACC,GAAD,KAAe9Q,EAAK4D,MACpB,6BAAM5D,EAAK6M,UACX,8CAAmB,kBAAC,GAAD,CAAe9M,OAAQA,OAa/BiR,OARf,YAAsC,IAAVjR,EAAS,EAATA,OAC3B,OAAQ,kBAAC,IAAD,CAAMiE,G3B/Be,gB2B+BID,QAAQ,UAAWhE,IAClD,kBAAC6Q,GAAD,KACC,kBAAC,GAAD,CAAY7Q,OAAQA,EAAQoM,UAAW4E,QC3B5BE,OAXf,YAAsC,IAAT3U,EAAQ,EAARA,MACxBwR,EAAiB,GACrB,IAAK,IAAI/N,KAAUzD,EAClBwR,EAAeN,KAAK,kBAAC,GAAD,CACnBzN,OAAQA,EACRC,KAAM1D,EAAMyD,GACZ7B,IAAK6B,KAEP,OAAO+N,G,6FCJR,IAAMoD,GAAerM,IAAOmB,IAAV,MAelB,IAiBe1C,gBAjBS,SAAC,GAA6B,IAA5BxD,EAA2B,EAA3BA,UACrB4N,EAAgB,GACd3R,EAF8C,EAAhB8D,WAEJ9D,aAAaoP,cAC7C,IAAK,IAAIpL,KAAUD,EAAUxD,MAAO,CACnC,IAAI0D,EAAOF,EAAUxD,MAAMyD,GACVC,EAAK2N,KAAKC,MAAK,SAACC,GAChC,OAAmD,IAA5CA,EAAI1C,cAAciC,QAAQrR,QAGjC2R,EAAc3N,GAAUC,GAG1B,MAAO,CACN1D,MAAOoR,KAIMpK,EA7Bf,YAA+B,IAAThH,EAAQ,EAARA,MACrB,OACC,kBAAC,WAAD,KACC,kBAAC4U,GAAD,KACC,kBAAC,GAAD,MACA,kBAAC,GAAD,CAAmB5U,MAAOA,KAE3B,kBAAC,GAAD,UCDH,IAOegH,gBAPS,SAAA9D,GAAK,MAAK,MACP,SAAA+C,GAAQ,MAAK,CACvC4O,qBADuC,SAClB5V,GACpBgH,EZZK,SAA4BhH,GAClC,MAAO,CACNmE,KxBQmC,wBwBPnCC,QAAS,CAACpE,SYSD6V,CAAmB7V,QAIf+H,EAjBf,YAA4C,IAAxB6N,EAAuB,EAAvBA,qBAOnB,OAAO,kBAAC,GAAD,CAAUnR,KANJ,CACZ6M,SAAU,WACVjJ,KAAM,WACNmG,KAAM,KAGsBtG,QAAS0N,O,SCOvC,IAQe7N,gBARS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAF,MAAa,CACpCyR,WAAYzR,EAAK/D,UAAY+D,EAAK/D,SAAS6H,QAEjB,SAAAnB,GAAQ,MAAK,CACvC+O,sBADuC,SACjB9Q,EAAQJ,GAC7BmC,EpCqHM,SAAwC/B,EAAQT,EAAQmN,GAC/D,8CAAO,WAAM3K,GAAN,qBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACnBC,WChJ4B,SDgJCM,IAAI1C,GACnC+B,EAvFM,CAAC7C,KDlB6B,2BCsG9B,kBAKa2D,EAAIP,MALjB,UAKCI,EALD,UAOD3H,EAAO2H,EAAIC,QACTgK,EAAcD,EAAW,YAAc,aACpB3R,EAAK4R,GAAaC,QAAQrN,IAAW,GATzD,kCAUEsD,EAAIgK,OAAJ,eACJF,EAAczK,IAASC,UAAU2K,WAAWiE,YAAYxR,KAXtD,QAaJxE,EAAK4R,GAAe5R,EAAK4R,GAAaqD,QAAO,SAAAgB,GAAU,OAAIA,IAAezR,KAbtE,QAeLwC,EAASH,EAAgB5B,EAAQjF,IAf5B,kDAiBLgH,EAASF,EAAqB,EAAD,KAjBxB,0DAAP,sDoCtHUoP,CAA+BjR,EAAQJ,GAAS,QAG5CkD,EAtBf,YAAyE,IAAtDvD,EAAqD,EAArDA,OAAQ2R,EAA6C,EAA7CA,QAASL,EAAoC,EAApCA,WAAYC,EAAwB,EAAxBA,sBACzCK,EAAgBN,IAAeK,EAClC,4BAAQlO,UAAU,eACjBC,QAAS,kBAAM6N,EAAsBI,EAAS3R,KAD/C,QAIA,GACH,OACE,yBAAKyD,UAAU,SACd,kBAAC,GAAD,CAAYzD,OAAQA,EAAQoM,UAAWS,GAAUJ,OAAK,IACrDmF,MCAUC,OAZf,YAA2C,IAApBC,EAAmB,EAAnBA,QAASH,EAAU,EAAVA,QAE/B,GAAGG,GAAWvB,OAAOC,OAAOsB,EAAU,GAAI,CACzC,IADyC,EACnCC,EAAiB,GADkB,eAEtBD,GAFsB,IAExC,IAAI,EAAJ,qBAA2B,CAAC,IAApB9R,EAAmB,QAC3B+R,EAAetE,KAAK,kBAAC,GAAD,CAAUzN,OAAQA,EAAQ7B,IAAK6B,EAAQ2R,QAASA,MAH5B,8BAKzC,OAAOI,EAER,OAAO,sDCmBR,IAWexO,gBAXS,SAAC,EAAD,OAAE1D,EAAF,EAAEA,KAAMW,EAAR,EAAQA,UAAawR,EAArB,EAAqBA,MAArB,MAAiC,CACxDlW,SAAU+D,EAAK/D,SACfJ,KAAM8E,EAAUzD,aAChBvB,KAAMgF,EAAUrD,MAAM6U,EAAMC,OAAOxR,YAGT,SAAA+B,GAAQ,MAAK,CACvC0P,gCADuC,SACPzR,GAC/B,OAAO+B,EAASa,EAA8B5C,QAGjC8C,EAnCf,YAA8F,IAAzE4O,EAAwE,EAAxEA,QAASH,EAA+D,EAA/DA,MAAOlW,EAAwD,EAAxDA,SAAUJ,EAA8C,EAA9CA,KAAMF,EAAwC,EAAxCA,KAAM0W,EAAkC,EAAlCA,gCAS1D,GARA1N,qBAAU,WACN1I,GAAYkW,EAAMC,OAAOxR,OAC3ByR,EAAgCF,EAAMC,OAAOxR,QACnC3E,IAAakW,EAAMC,OAAOxR,QACpC0R,EAAQ1E,KjCPqB,kBiCOCzJ,QAAQ,UAAWlI,EAAS6H,QAEzD,CAAC7H,EAAUoW,EAAiCF,EAAMC,OAAOxR,OAAQ0R,IAEjEzW,EACF,OAAQ,wCACF,GAAIF,EAAM,CAChB,IAAM4W,EAASJ,EAAMC,OAAOxR,UAAb,OAAwB3E,QAAxB,IAAwBA,OAAxB,EAAwBA,EAAU6H,KACjD,OACC,6BACEyO,GAAU,kBAAC,GAAD,MACX,kBAAC,GAAD,CAAcN,QAAStW,EAAKkV,SAAUiB,QAASK,EAAMC,OAAOxR,UAI9D,OAAO,KCjBF,SAAS4R,GAAkB7W,GACjC,MAAO,CACNmE,KxC4DiC,sBwC3DjCC,QAAS,CAACpE,SAGL,SAAS8W,GAAgB9W,GAC/B,MAAO,CACNmE,KxCuD+B,oBwCtD/BC,QAAS,CAACpE,SCVG+W,OANf,WACC,OACC,oDAAyB,kBAAC,EAAD,Q,4JCJZzN,WAAO0N,MAAtB,MAEG,qBAAEC,QAAsB,kBAExB,qBAAEA,QAAsB,sB,80BCF3B,IAAMC,GAAoB5N,IAAOmB,IAAV,MAMjB0M,GAAO7N,IAAO8N,IAAV,MAOJC,GAAiB/N,IAAO+E,MAAV,MAadiJ,GAA0BhO,IAAOmB,IAAV,MAIb,SAAAhB,GAAK,OAAKA,EAAM8N,QAAU,UAAY,cAClD,gBAAEtJ,EAAF,EAAEA,SAAUsJ,EAAZ,EAAYA,QAAZ,OAAyBtJ,GAAYsJ,GAAZ,uBAClB,qBAAEtJ,SAAyB,UAAY,SAG9CoJ,GAIAF,IACc,SAAA1N,GAAK,OAAKA,EAAM8N,QAAU,UAAY,YAkBzCC,GAdQ,SAAC,GAAD,IAAGvP,EAAH,EAAGA,UAAWsP,EAAd,EAAcA,QAAStJ,EAAvB,EAAuBA,SAAaxE,EAApC,0DACrB,kBAACyN,GAAD,CAAmBjP,UAAWA,GAC/B,kBAACoP,GAAD,eAAgBlT,KAAK,WACjBoT,QAASA,EACTE,SAAUxJ,GACNxE,IACL,kBAAC6N,GAAD,CAAyBC,QAASA,EAAStJ,SAAUA,GACnD,kBAACkJ,GAAD,CAAMvN,QAAQ,aACZ,8BAAU8N,OAAO,uB,wDCpDV,SAASC,GAAT,GAA0C,IAAtB1L,EAAqB,EAArBA,SAAU2L,EAAW,EAAXA,SAC5C,OAAO,kBAACC,GAAA,EAAD,CAAQ5L,SAAUA,GACxB,kBAAC6L,GAAA,EAAD,CAAO7P,UAAU,eAAe2P,I,mJCClC,IAAMG,GAAezO,IAAOmB,IAAV,MAqClB,SAASuN,GAAT,GAAmC,IAAjBN,EAAgB,EAAhBA,OAAQ3L,EAAQ,EAARA,MACzB,IAAI2L,EAAO3H,SAAWhE,EACrB,OAAO,KAER,IAAMkM,EAASP,EAAO,GAAGzL,SACnBiM,EAASR,EAAO3H,OAAS,EAoBhC,SAAmB2H,GAClB,IAAMS,EAAUT,EAAOpR,KAAI,SAAA8R,GAAK,OAAIC,KAAEC,OAAOF,EAAMnM,aAEnD,OADqB,IAAIoM,KAAEE,aAAaJ,GACpBK,YAvBeA,CAAUd,GAAU,KACvD,OACC,kBAAC,KAAD,CAAY3L,MAAOA,EAClBkM,OAAQA,EACRQ,KAAM,GACNC,iBAAiB,EACjBR,OAAQA,EACRS,cAAe,CAACC,QAAS,CAAC,GAAI,MAE9B,kBAACC,GAAA,EAAD,CACAC,YAAY,0EACZC,IAAI,uDAEJ,kBAACC,GAAD,CAAYtB,OAAQA,KAIvB,SAASsB,GAAT,GACC,OAD6B,EAATtB,OACNpR,KAAI,SAAA8R,GAAK,OAAI,kBAACT,GAAD,eAAWhV,IAAKyV,EAAMjS,IAAQiS,OAO3Ca,OA5Df,YAA6B,IAAD,IAAdvB,cAAc,MAAL,GAAK,IACD3M,mBAAS,MADR,mBACpBgB,EADoB,KACbmN,EADa,KAErBC,EAAeC,iBAAO,MACtBC,EAAeC,uBAAY,SAAAC,GAC7BA,GACFL,EAAS,CACRxP,MAAO6P,EAAYC,YACnB7P,OAAQ4P,EAAYE,aACpBxN,SAAU,eAGV,IACGyN,EAAkBJ,uBAAY,SAAAC,GACnCF,EAAaE,GACbJ,EAAaQ,QAAUJ,IACrB,CAACF,IASJ,OARArQ,qBAAU,WACT,IAAM4Q,EAAiB,WACtBP,EAAaF,EAAaQ,UAI3B,OAFAzO,OAAOC,iBAAiB,SAAUyO,GAE3B,kBAAM1O,OAAOE,oBAAoB,SAAUwO,MAChD,CAACT,EAAcE,IAEjB,kBAACtB,GAAD,CAAcjQ,IAAK4R,GAClB,kBAAC1B,GAAD,CAASjM,MAAOA,EAAO2L,OAAQA,M,0cCrClC,IAAMmC,GAAgBvQ,IAAOwQ,GAAV,MAabC,GAAgBzQ,IAAO0Q,GAAV,MA6BJC,OArBf,YAA4D,IAAzB5W,EAAwB,EAAxBA,YAAa6W,EAAW,EAAXA,SAC/ClR,qBAAU,WACT,SAASmR,IACRD,EAAS,MAGV,OADAhP,OAAOC,iBAAiB,QAASgP,GAC1B,kBAAMjP,OAAOE,oBAAoB,QAAS+O,MAChD,CAACD,IACH,IAAME,EAA2B/W,EAAYiD,KAAK,SAAA+T,GAAU,OAC3D,kBAACN,GAAD,CAAepX,IAAK0X,EAAWC,SAC3BD,WAAYA,EACZnS,QAAS,kBAAMgS,EAASG,KAC1BA,EAAWE,iBAEd,OACC,kBAACV,GAAD,KACEO,I,gGClCJ,IAAMI,GAAyBlR,IAAOmB,IAAV,M,SAGbgQ,G,iFAAf,WAA8BC,GAA9B,mBAAAzT,EAAA,6DACOC,EAAS,yEACXyT,UAAUD,GAFf,kBAIyBE,MAAM1T,GAJ/B,cAIQ2T,EAJR,gBAK4BA,EAASC,OALrC,cAKQzX,EALR,yBAMS,CAACA,EAAaqX,EAAQ,OAN/B,2DAQS,CAAC,GAAIA,EAAL,OART,2D,sBAWA,IAAMK,GAAe,CAACL,OAAQ,IAqCfM,OApCf,YAA4D,IAApCC,EAAmC,EAAnCA,SAAmC,IAAzBC,eAAyB,MAAf,GAAe,EAAXjN,EAAW,EAAXA,SAAW,EAC9BlD,mBAASmQ,GADqB,mBACnDR,EADmD,KAC3CS,EAD2C,OAEpBpQ,mBAAS,IAFW,mBAEnD1H,EAFmD,KAEtC+X,EAFsC,OAGhCrQ,mBAAS,MAHuB,mBAGnDyF,EAHmD,KAG5C6K,EAH4C,iDAI1D,WAA+BX,GAA/B,uBAAAzT,EAAA,6DACCmU,EAAe,MACfL,GAAaL,OAASA,EAFvB,SAG0DD,GAAeC,GAHzE,mCAGQY,EAHR,KAG4BC,EAH5B,KAG2C/K,EAH3C,KAII+K,IAAkBR,GAAaL,SACjCU,EAAeE,GACfD,EAAS7K,IANX,6CAJ0D,sBAoB1D,IAAMgL,IAAyBnY,GAC3B,kBAAC,GAAD,CAA0BA,YAAaA,EAAa6W,SARxD,SAAkBG,GACjBe,EAAe,MACXf,IACHc,EAAUd,EAAWE,cACrBU,EAASZ,OAKX,OACC,kBAACG,GAAD,KACC,kBAAC,GAAD,CAAa1L,SAxB2C,4CAyBpDF,MAAO8L,EACPzM,SAAUA,EACVe,YAAY,kBACZH,SAAUsM,EACVzM,YAAa,kBAACsB,GAAD,QAChBwL,EACAhL,I,iNCzCJ,IAAMuH,GAAezO,IAAOmB,IAAV,MAKZgR,GAAuBnS,IAAOmB,IAAV,MAG1B,SAASiR,GAAiBC,EAAaC,GAAe,IAAD,EACpD,OAAkB,OAAXD,QAAW,IAAXA,GAAA,UAAAA,EAAaE,iBAAb,eAAwBhK,QAAQ+J,KAAiB,EAgEzD,IAKMlT,GAAqB,CAC1BmO,sBAEc9O,gBARS,SAAC9D,GACxB,MAAO,CACN0X,YAAa1X,EAAM4B,WAAW7F,QAMQ0I,GAAzBX,EAtEf,YAAkE,IAA5C4T,EAA2C,EAA3CA,YAAa9E,EAA8B,EAA9BA,kBAAmB5I,EAAW,EAAXA,SACrD,IAAI0N,EACH,OAAO,KA+BR,IAAMG,EAAmD,kBAAzBH,EAAYI,UAA0D,kBAA1BJ,EAAYK,UAClFpE,EAAWkE,EAAkBH,EAAYtT,KAAO,SAChD4D,EAAW6P,EAAkB,CAACH,EAAYI,SAAUJ,EAAYK,WAAc,CAAC,QAAS,SAC9F,OACC,kBAACP,GAAD,KACC,kBAACQ,GAAD,gBAEC,kBAAC,GAAD,CAAarN,MAAO+M,EAAYtT,MAAQ,GACpCwG,SArCP,SAAsBxG,GACrBwO,EAAkB,2BACd8E,GADa,IAEhBtT,WAmCK4F,SAAUA,KAEf,kBAACgO,GAAD,eACC,kBAAC,GAAD,CAAef,QAASS,EAAYO,MAAOjB,SAtB9C,SAA2BZ,GAE1BxD,EAAkB,2BACd8E,GADa,IAEhBO,MAAO7B,EAAWE,aAClBwB,UAAW1B,EAAW8B,IACtBH,WAAY3B,EAAW+B,WAkBvB,kBAAC,GAAD,KACC,kBAAC,GAAD,CAAK1E,OAAQ,CAAC,CAACvR,GAAG,EAAG8F,WAAU2L,gBAEhC,kBAACqE,GAAD,kBACA,6BACC,kBAACA,GAAD,CAAahF,QAAM,GAClB,kBAAC,GAAD,CAAgBM,QAASmE,GAAiBC,EC1E5B,OD2EV9M,SAAU,WA5ClB,IAA0B+M,EACtBF,GAAiBC,EADKC,EC/BR,ODiChB/E,EAAkB,2BACd8E,GADa,IAEhBE,UAAWF,EAAYE,UAAU5G,QAAO,SAAAoH,GAAY,OAAIA,IAAeT,QAIzE/E,EAAkB,2BACd8E,GADa,IAEhBE,WAAsB,OAAXF,QAAW,IAAXA,OAAA,EAAAA,EAAaE,WAAb,sBAA6BF,EAAYE,WAAzC,CAAoDD,IAAgB,CAACA,OAmC1E3N,SAAUA,IAHf,WCzEe,Y,uRCGnB,IAAMqO,GAAehT,IAAOC,OAAV,MAIf,SAAAE,GAAK,OAAIA,EAAM8S,QAAN,2DAOT,SAAA9S,GAAK,OAAIA,EAAM+S,MAAQ,kBAKX,eAAkC,IAAtB7Q,EAAqB,EAArBA,SAAalC,EAAQ,6BAC/C,OAAO,kBAAC6S,GAAgB7S,EAAQkC,I,2FCfjC,IAAM8Q,GAA2BnT,IAAOmB,IAAV,MAY9B,IAMM/B,GAAqB,CAC1BgU,sBXIM,SAA+BzX,EAAQ0W,GAC7C,OAAO,SAAA3U,GAENA,EvC2IK,SAA6B/B,EAAQ0X,EAAaC,GACxD,8CAAO,WAAM5V,GAAN,mBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACnBC,WC7K4B,SD6KCM,IAAI1C,GACnC+B,EApHM,CAAC7C,KDlB6B,2BCmI9B,kBAKa2D,EAAIP,MALjB,cAKCI,EALD,OAOC3H,EAPD,2BAQD2H,EAAIC,QACJ+U,GATC,SAWC7U,EAAIgK,OAAO9R,GAXZ,OAYLgH,EAASH,EAAgB5B,EAAQjF,IACjC4c,EAAgB5c,GAbX,kDAeLgH,EAASF,EAAqB,EAAD,KAfxB,0DAAP,sDuC5IU+V,CAAoB5X,EAAQ0W,GADb,SAAAA,GAAW,OAAI3U,EAAS8P,GAAgB6E,WWJnD5T,gBATS,SAAC,EAAD,OAAE/C,EAAF,EAAEA,UAAWX,EAAb,EAAaA,KAAMwB,EAAnB,EAAmBA,WAAcZ,EAAjC,EAAiCA,OAAjC,MAA8C,CACrEjF,KAAMgF,EAAUrD,MAAMsD,GACtB0W,YAAa9V,EAAW7F,KACxB4W,OAAQvS,EAAK/D,SAAS6H,MAAQlD,EAC9B/E,KAAM8E,EAAUzD,cAAgByD,EAAUvD,kBAKHiH,GAAzBX,EAlBf,YAAwE,IAA9C9C,EAA6C,EAA7CA,OAAQ0W,EAAqC,EAArCA,YAAae,EAAwB,EAAxBA,sBAC9C,OACC,kBAACD,GAAD,KACC,kBAAC,GAAD,CAAcvU,QAAS,kBAAMwU,EAAsBzX,EAAQ0W,IAAca,MAAI,GAA7E,YC2BH,IASM9T,GAAqB,CAC1Bb,gCACAiP,oBAEc/O,gBAbS,SAAC,EAAD,GAAiC,IAA/B1D,EAA8B,EAA9BA,KAAMW,EAAwB,EAAxBA,UACzBC,EADiD,EAAXuR,MACvBC,OAAOtO,IAC5B,MAAO,CACNlD,SACA3E,SAAU+D,EAAK/D,SACfwc,UAAW9X,EAAUrD,MAAMsD,GAC3B/E,KAAM8E,EAAUzD,cAAgByD,EAAUvD,kBAOJiH,GAAzBX,EA3Cf,YAA2G,IAArF9C,EAAoF,EAApFA,OAAQ3E,EAA4E,EAA5EA,SAAUwc,EAAkE,EAAlEA,UAAW5c,EAAuD,EAAvDA,KAAM2H,EAAiD,EAAjDA,8BAA+BiP,EAAkB,EAAlBA,gBAYvF,GAXA9N,qBAAU,WACN1I,IAAawc,GACfjV,EAA8B5C,KAE7B,CAAC3E,EAAU2E,EAAQ6X,EAAWjV,IACjCmB,qBAAU,WACN8T,IAAc5c,GAChB4W,EAAgBgG,KAEf,CAACA,EAAW5c,EAAM4W,KAEjBxW,EACH,OAAO,kBAAC,GAAD,MAER,IAAMsW,EAAS3R,KAAM,OAAK3E,QAAL,IAAKA,OAAL,EAAKA,EAAU6H,KACpC,OACC,kBAAC,WAAD,KACC,6BACC,kBAAC,GAAD,CAAalD,OAAQA,EAAQgJ,UAAW2I,IAIxC,kBAAC,GAAD,CAAiB3R,OAAQA,KAE1B,kBAAC,GAAD,U,2FC5BH,IAAM8X,GAAqBzT,IAAOmB,IAAV,MAaxB,IAGM/B,GAAqB,CAC1BsU,wBbiBM,SAAiC/X,EAAQjF,GAC/C,OAAO,SAAAgH,GAENA,EvC0JK,SAA6B/B,EAAQjF,EAAM4c,GACjD,8CAAO,WAAM5V,GAAN,eAAAC,EAAA,6DACAa,EAAMX,IAASC,YAClBC,WCvM2B,SDuMEM,IAAI1C,GACnC+B,EA9IK,CAAC7C,KDlB6B,2BC6J9B,kBAKE2D,EAAImV,IAAIjd,GALV,OAMJgH,EAASH,EAAgB5B,EAAQjF,IACjC4c,EAAgB5c,GAPZ,gDASJgH,EAASF,EAAqB,EAAD,KATzB,yDAAP,sDuC3JUoW,CAAoBjY,EAAQjF,GADb,SAAAA,GAAI,OAAIgH,EAAS8P,GAAgB9W,WajB5C+H,gBANS,SAAC,GAAD,MAAmB,CAC1C4T,YADuB,EAAE9V,WACD7F,QAKe0I,GAAzBX,EAhBf,YAA+E,IAAhD9C,EAA+C,EAA/CA,OAAQ0W,EAAuC,EAAvCA,YAAaqB,EAA0B,EAA1BA,wBACnD,OACC,kBAACD,GAAD,KACC,kBAAC,GAAD,CAAc7U,QAAS,kBAAM8U,EAAwB/X,EAAQ0W,IAAca,MAAI,GAA/E,gBCeH,IAaezU,gBAbS,SAAC,GAAD,IAAE/C,EAAF,EAAEA,UAAWX,EAAb,EAAaA,KAAMwB,EAAnB,EAAmBA,WAAnB,MAAoC,CAC3DvF,SAAU+D,EAAK/D,SACfqb,YAAa9V,EAAW7F,KACxBE,KAAM8E,EAAUzD,cAAgByD,EAAUvD,mBAEhB,SAAAuF,GAAQ,MAAK,CACvCmW,0BADuC,SACb7c,GACzB,IAAM8c,EAAmB,CACxB/U,KAAM/H,EAASgI,aAEhBtB,EAAS6P,GAAkBuG,QAGdrV,EAhCf,YAA+E,IAApDzH,EAAmD,EAAnDA,SAAUqb,EAAyC,EAAzCA,YAAawB,EAA4B,EAA5BA,0BAOjD,OANAnU,qBAAU,WACN1I,IAAaqb,GAEfwB,EAA0B7c,KAEzB,CAACA,EAAUqb,EAAawB,IACvB7c,EAIH,kBAAC,WAAD,KACC,kBAAC,GAAD,CAAa2E,OAAQ3E,EAAS6H,MAC9B,kBAAC,GAAD,CAAsBlD,OAAQ3E,EAAS6H,OALjC,kBAAC,GAAD,S,0NCZT,IAAMkV,GAAoB/T,IAAO6E,KAAT,MAIrB,qBAAEmP,gBACD,gCACD,qBAAEC,MACD,wBAGD,qBAAEC,MAAc,6RAahB,qBAAEC,OAAgB,6RAalB,qBAAEC,MAAc,sSAchB,qBAAEC,IAAU,kSAeA,eAAuE,IAA7DlV,EAA4D,EAA5DA,GAAIkD,EAAwD,EAAxDA,SAAU6R,EAA8C,EAA9CA,KAAMC,EAAwC,EAAxCA,MAAOC,EAAiC,EAAjCA,KAAMC,EAA2B,EAA3BA,GAAIL,EAAuB,EAAvBA,eAAgBC,EAAO,EAAPA,KAC7E,OACA,kBAAC,IAAD,CAAM9U,GAAIA,GACT,kBAAC4U,GAAD,CAAoBG,KAAMA,EACrBC,MAAOA,EACPC,KAAMA,EACNC,GAAIA,EACJL,eAAgBA,EAChBC,KAAMA,GACT5R,K,0WClEJ,IAAMiS,GAAgBtU,IAAOmB,IAAV,MAGboT,GAAWvU,IAAOwU,GAAV,MAMRC,GAAUzU,IAAO0U,QAAV,MAIb,SAASC,GAAT,GAAsC,IAAD,EAAPxZ,EAAO,EAAPA,KAE7B,OACC,kBAAC,WAAD,KACC,kBAACmZ,GAAD,KACC,kBAAC,GAAD,CAAUnZ,KAAMA,EAAMwM,OAAK,KAE5B,kBAAC4M,GAAD,KAAWpZ,EAAK4D,MAChB,kBAAC0V,GAAD,KACC,kBAAC9B,GAAD,mBACCxX,EAAK6M,aAEL,UAAC7M,EAAKyZ,eAAN,aAAC,EAAcnO,SAChB,kBAACgO,GAAD,KACC,kBAAC9B,GAAD,iBACCxX,EAAKyZ,QAAQC,KAAK,QAiBT7I,OAXf,YAA6B,IAAV9Q,EAAS,EAATA,OACXuU,EAAO7P,cAAP6P,IACP,OACC,6BACC,kBAAC,GAAD,CAAYvU,OAAQA,EAAQoM,UAAWqN,KACvC,kBAACG,GAAD,CAAY3V,GAAE,UAAKsQ,EAAL,YlDlDY,QkDkDiB0E,OAAK,EAACH,gBAAc,GAA/D,eACA,kBAACc,GAAD,CAAY3V,GAAE,UAAKsQ,EAAL,YlDlDgB,YkDkDiB0E,OAAK,EAACH,gBAAc,GAAnE,gBC9BH,SAASe,GAAmB5Y,EAAUC,GACrC,MAAO,CACNvB,KzDmCmC,wByDlCnCC,QAAS,CAACqB,WAAUC,WActB,SAAS4Y,GAAuBlZ,EAAQxC,GACvC,MAAO,CACNuB,KzDqBwC,6ByDpBxCC,QAAS,CAACgB,SAAQxC,YAGpB,SAAS2b,GAAsBnZ,GAC9B,MAAO,CACNjB,KzDgBuC,4ByDfvCC,QAAS,CAACgB,WAGZ,SAASoZ,GAAuBpZ,EAAQnC,GACvC,MAAO,CACNkB,KzDWwC,6ByDVxCC,QAAS,CACRgB,SACAnC,uBAIH,SAASwb,GAAkBhZ,EAAUC,GACpC,MAAO,CACNvB,KzDGwC,6ByDFxCC,QAAS,CACRqB,WACAC,WAuBI,SAASgZ,GAAsBtZ,EAAQ+Q,EAASwI,EAAaC,EAC1Dpa,EAAQmN,EAAUiL,GAC3B,8CAAO,WAAM5V,GAAN,iBAAAC,EAAA,6DACAvB,EAAS,CACdN,SACA+Q,UACAwI,cACAC,eACApa,SACAqa,OChGoC,0BDiGpClN,WACAsC,SAAU9M,IAASC,UAAU2K,WAAW+M,kBACxC3K,WAAYhN,IAASC,UAAU2K,WAAW+M,mBAG3C9X,EA1EM,CACN7C,KzD8BmC,0ByD8B7B,kBAemBgD,IAASC,YAC/BC,WvDrG6B,WuDqGE0X,IAAIrZ,GAhBhC,OAeCsZ,EAfD,OAiBLhY,EAASqX,GAAmBW,EAAU7Y,GAAX,YAAC,eACxBT,GADuB,IAE1BuO,SAAU,IAAIN,KACdQ,WAAY,IAAIR,SAEc,oBAArBiJ,GACTA,EAAgBoC,EAAU7Y,IAvBtB,kDA0BLa,GAA6B,EAAD,GAlFvB,CACN7C,KzD0BoC,yByDzBpCC,QAAS,CAACjE,cAgFA8e,MA1BJ,0DAAP,sDA8DM,SAASC,GAA+BzZ,EAAUC,GACxD,8CAAO,WAAMsB,GAAN,eAAAC,EAAA,6DACAa,EAAMX,IAASC,YAAYC,WvDrJD,WuDsJ9BM,IAAIlC,GACNuB,EAtFM,CAAC7C,KzDJ+B,6ByDuFhC,kBAKC2D,EAAIgK,OAAO,CAChB+M,OAAQnZ,EAAOmZ,OACf1K,WAAYhN,IAASC,UAAU2K,WAAW+M,oBAPtC,OASL9X,EAASyX,GAAkBhZ,EAAUC,IAThC,gDAWLsB,EA3FK,CACN7C,KzDPuC,4ByDQvCC,QAyFiC,EAAD,KAX1B,yDAAP,sDE9GD,IAyCe2D,gBAzCS,SAAC,EAAD,GAAmC,IAAjC1D,EAAgC,EAAhCA,KAAMa,EAA0B,EAA1BA,UAAaiR,EAAa,EAAbA,QACtCgJ,EAAsB9a,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IAEvDiX,EAAa,KACjB,IAAI,IAAIha,KAAUF,EAAUhD,MAAO,CAClC,IAAImD,EAAOH,EAAUhD,MAAMkD,GAC3B,GAAGia,MAAMC,QAAQja,EAAKka,iBACjBla,EAAKka,eAAe1N,QAAQsN,IAAwB,GACpD9Z,EAAKka,eAAe1N,QAAQsE,IAAY,EAAI,CAChDiJ,EAAaha,EACb,OAGF,MAAO,CACN+Z,sBACAhK,QAASjQ,EAAUrD,0BAA0Bsd,GAC7CK,UAAWta,EAAUtD,uBAAuBud,GAC5CC,iBAGyB,SAAApY,GAAQ,MAAK,CACvCyY,qCADuC,SACFta,GACpC6B,EAASuM,GAAmCpO,KAE7Cua,0BAJuC,SAIbvJ,EAASwI,EAAaC,EAAcpa,EAAQmN,EAAUgO,G/ByD1E,IAA6BJ,EAAgB3C,E+BlDlD5V,G/BkDkCuY,E+BlDL,CAACZ,EAAaC,G/BkDOhC,E+BxDlD,SAA+BxX,GAI9B4B,EAAS0X,GAAsBtZ,EAAQ+Q,EAASwI,EAAaC,EAAcpa,EAAQmN,GAHnF,WACCgO,ErD5D0B,iBqD4DInX,QAAQ,UAAWpD,S/BuDpD,uCAAO,WAAM4B,GAAN,iBAAAC,EAAA,6DACA5B,EAAO,CAACka,kBACdvY,EAlFM,CACN7C,K5BMiC,wB4ByE3B,kBAIiBgD,IAASC,YAC7BC,W1B9H2B,S0B8HE0X,IAAI1Z,GAL9B,OAICua,EAJD,OAML5Y,EAASkM,GAAiB0M,EAAQzZ,GAAId,IACP,oBAArBuX,GACTA,EAAgBgD,EAAQzZ,IARpB,kDAWLa,EAtFK,CACN7C,K5BEkC,uB4BDlCC,QAAS,CAACjE,SAoFkB,EAAD,MAXrB,0DAAP,yD+BjDA0f,mBAbuC,SAapBza,EAAQ+Q,EAASwI,EAAaC,EAAcpa,EAAQmN,EAAUgO,GAIhF3Y,EAAS0X,GAAsBtZ,EAAQ+Q,EAASwI,EAAaC,EAAcpa,EAAQmN,GAHnF,WACCgO,ErDpE2B,iBqDoEGnX,QAAQ,UAAWpD,YAMrC2C,EAzEf,YACwF,IAD/DoO,EAC8D,EAD9DA,QAAS3R,EACqD,EADrDA,OAAQ2a,EAC6C,EAD7CA,oBAAqBhK,EACwB,EADxBA,QAASqK,EACe,EADfA,UAAWJ,EACI,EADJA,WAClFK,EAAsF,EAAtFA,qCAAsCC,EAAgD,EAAhDA,0BAA2BG,EAAqB,EAArBA,mBACjE7W,qBAAU,WACLwW,GAAcrK,GACjBsK,EAAqCN,KAIpC,CAACA,EAAqBhK,EAASqK,EAAWC,IAPyC,MAShD1U,mBAAS,IATuC,mBAS/E+U,EAT+E,KASlEH,EATkE,KAmBtF,OAAIG,EACI,kBAAC,IAAD,CAAUrX,GAAIqX,IAEnBN,EACK,gBAELrK,IAAWgK,IACN,kBAAC,GAAD,CAAc3C,MAAI,EAACtU,QAf3B,WACKkX,EAIHS,EAAmBT,EAAYjJ,EAASgJ,EAAqBhJ,EAAS3R,GAAQ,EAAOmb,GAFrFD,EAA0BvJ,EAASgJ,EAAqBhJ,EAAS3R,GAAQ,EAAOmb,KAY1E,iB,uWChCT,IAAMI,GAAqBzW,IAAOmB,IAAV,MAIlBuV,GAAgB1W,IAAOmB,IAAV,MAKbwV,GAAyB3W,IAAOmB,IAAV,MAmB5B,IAGe1C,gBAHS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAF,MAAa,CACpCY,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,OAEzBJ,EAnBf,YAAsD,IAAjCvD,EAAgC,EAAhCA,OAAQS,EAAwB,EAAxBA,OAAQkR,EAAgB,EAAhBA,QAASnW,EAAO,EAAPA,KAC7C,OAAGiF,IAAWkR,EACN,sCAAYnW,EAAKqI,KAAjB,IAAuB,4CAG9B,kBAAC0X,GAAD,KACC,kBAACC,GAAD,KACEhgB,EAAKqI,MAEP,kBAAC4X,GAAD,KACC,kBAAC,GAAD,CAAe9J,QAASA,EAAS3R,OAAQA,SCH9B0b,OApBf,YAAuC,IAAjB1b,EAAgB,EAAhBA,OAAQ7C,EAAQ,EAARA,MACzB4U,EAAiB,GACrB,IAAK,IAAItR,KAAUtD,EAClB4U,EAAetE,KAAK,kBAAC,GAAD,CACnBzN,OAAQA,EACRxE,KAAM2B,EAAMsD,GACZkR,QAASlR,EACTtC,IAAKsC,KAEP,OACC,6BACC,kBAACmZ,GAAD,CAAY3V,GvDRe,gBuDQID,QAAQ,UAAWhE,GAC/CgZ,MAAI,EACJD,MAAI,GAFP,eAKChH,I,0FCdJ,IAAM4J,GAAoB7W,IAAOmB,IAAV,MAevB,SAAS2V,GAAkBze,EAAO6C,GACjC,IAAIkT,EAAS,GACb,IAAI,IAAIzS,KAAUtD,EACjB+V,EAAOzF,KAAK,CACX9L,GAAIlB,EACJgH,SAAU,CAACtK,EAAMsD,GAAQ8W,SAAUpa,EAAMsD,GAAQ+W,WACjDpE,SAAUyI,GAAYpb,EAAQtD,EAAMsD,GAAST,KAG/C,OAAOkT,EAER,SAAS2I,GAAYpb,EAAQjF,EAAMwE,GAClC,OACC,kBAAC,WAAD,KACC,kBAAC2b,GAAD,KAAoBngB,EAAKqI,MACzB,kBAAC,GAAD,CAAe8N,QAASlR,EAAQT,OAAQA,KAI5B8b,OA/Bf,YAAyC,IAAjB3e,EAAgB,EAAhBA,MAAO6C,EAAS,EAATA,OAC9B,OACC,6BACC,kBAAC4Z,GAAD,CAAY3V,GxDLe,gBwDKID,QAAQ,UAAWhE,GAC/CgZ,MAAI,EACJD,MAAI,GAFP,cAKA,kBAAC,GAAD,CAAK7F,OAAQ0I,GAAkBze,EAAO6C,OC+BzC,IAiBeuD,gBAjBS,SAAC,EAAD,GAAiC,IAA/B/C,EAA8B,EAA9BA,UAAWX,EAAmB,EAAnBA,KAC9BG,EADiD,EAAXgS,MACvBC,OAAOjS,OACtB2Q,EAAUnQ,EAAU3D,oBAAoBmD,GACxCtE,EAAO8E,EAAU5D,iBAAiBoD,GACxC,MAAO,CACNA,SACAsR,WAAYzR,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IAC3CxG,MAAOwT,IAAYjV,EAAO8E,EAAUrD,MAAQ,KAC5C6O,MAAO2E,IAAYjV,EAAO8E,EAAU1D,kBAAkBkD,GAAU,SAGvC,SAACwC,EAAD,OAAYwP,EAAZ,EAAYA,MAAZ,MAAuB,CACjDzP,6BADiD,WAEhD,OAAOC,EAASD,EAA6ByP,EAAMC,OAAOjS,aAI7CuD,EAtDf,YAAgG,IAA7EvD,EAA4E,EAA5EA,OAAQ+b,EAAoE,EAApEA,UAAWzK,EAAyD,EAAzDA,WAAYnU,EAA6C,EAA7CA,MAAO6O,EAAsC,EAAtCA,MAAOzJ,EAA+B,EAA/BA,6BAM/D,GALAiC,qBAAU,YACN8M,GAAenU,GAAU6O,GAC3BzJ,MAEC,CAAC+O,EAAYnU,EAAO6O,EAAOzJ,IAC3ByJ,EACF,OAAO,6BAAMA,EAAME,YAEpB,GAAG/O,EAAO,CACT,IAAM6e,EAcR,SAA2B7e,EAAO6C,EAAQsR,GACzC,IAAI0K,EAAiB,GACrB,IAAI,IAAIvb,KAAUtD,EAEhBA,EAAMsD,GAAQiQ,UACXvT,EAAMsD,GAAQiQ,SAASrD,QAAQrN,IAAW,GAC1CS,IAAW6Q,IAEd0K,EAAevb,GAAUtD,EAAMsD,IAGjC,OAAOub,EAzBiBC,CAAkB9e,EAAO6C,EAAQsR,GACxD,OACC,kBAAC,WAAD,MACGyK,GAAa,kBAAC,GAAD,CAAU/b,OAAQA,IzDxBR,SyDyBxB+b,GACM,kBAAC,GAAD,CAAY/b,OAAQA,EAAQ7C,MAAO6e,IzDzBb,ayD0B5BD,GACM,kBAAC,GAAD,CAAe/b,OAAQA,EAAQ7C,MAAO6e,IAC7C,kBAAC,GAAD,OAIH,OAAO,2C,gKC/BR,IAAME,GAAgB,0MAWhBC,GAAYrX,IAAO6H,IAAV,KACZuP,IAEGE,GAAiBtX,IAAO0N,MAAV,KACjB0J,IAWYG,OATf,YAA8B,IAAbtP,EAAY,EAAZA,IAAKlJ,EAAO,EAAPA,KACfyY,EAAWzY,EACf0Y,MAAM,OACNrZ,QAAO,SAACoZ,EAAUE,GAAX,OAAwBF,EAAWE,EAASC,OAAO,GAAGC,gBAAe,IAC9E,OAAG3P,EACK,kBAACoP,GAAD,CAAWnP,IAAKD,EAAK4P,MAAO9Y,EAAMoJ,IAAKqP,IAExC,kBAACF,GAAD,CAAgBO,MAAO9Y,GAAOyY,I,oYClBtC,IAAMM,GAAgB9X,IAAOmB,IAAV,MAYb4W,GAAW/X,IAAOmB,IAAV,MAwBd,IAsBe1C,gBAtBS,SAAC,EAAD,GAAmD,IAAjD1D,EAAgD,EAAhDA,KAAMa,EAA0C,EAA1CA,UAAWF,EAA+B,EAA/BA,UAAaI,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,KACzDJ,EAASZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IACxCmZ,EAAcpc,EAAU/C,kBAAkBiD,GAC1Cmc,GAAelc,EAAKka,gBAAkB,IAC1CtK,QAAO,SAAAuM,GAAW,OAAIA,IAAgBvc,KAAQ,GAC1Cwc,EAAYzc,EAAUrD,MAAM4f,GAClC,MAAO,CACNtc,SACAqc,cACAC,cACAE,gBAGyB,SAAAza,GAAQ,MAAK,CACvC0a,iBADuC,SACtBtc,GAChB4B,ErCmFK,SAA0C5B,GAChD,8CAAO,WAAM4B,GAAN,mBAAAC,EAAA,6DACAC,EAAQC,IAASC,YAAYC,W1B3IF,Y0B4IhCC,MAAM,SAAU,KAAMlC,GACtBuc,QAAQ,WAAY,QAHf,kBAKuBza,EAAMK,MAL7B,OAKCC,EALD,OAMCG,EAAMH,EAAcC,KAAK,GAC9BT,EAASmM,GAA0B/N,EAAQuC,GAAOA,EAAIC,SAPlD,sDAULZ,EAASmM,GAA0B/N,IAV9B,8DAAP,sDqCpFUwc,CAAiCxc,KAE3Cyc,eAJuC,SAIxBN,GACdva,EAASa,EAA8B0Z,QAI1BxZ,EA3Cf,YAA+G,IAA/F3C,EAA8F,EAA9FA,OAAsBkc,GAAwE,EAAtFjc,KAAsF,EAAhFJ,OAAgF,EAAxEqc,aAAaC,EAA2D,EAA3DA,YAAaE,EAA8C,EAA9CA,UAAWC,EAAmC,EAAnCA,iBAAkBG,EAAiB,EAAjBA,eAC5F7Y,qBAAU,gBACU8Y,IAAhBR,GACFI,EAAiBtc,IAEdqc,GAAaF,GAChBM,EAAeN,MAGjB,IAAMhZ,E3DvBuB,iB2DuBDC,QAAQ,UAAWpD,GAE/C,OADkBkc,GAAeA,EAAYS,KAE5C,kBAAC,IAAD,CAAMtZ,GAAIF,GACT,kBAAC6Y,GAAD,KACC,kBAAC,GAAD,CAAQ7P,IAAG,OAAEkQ,QAAF,IAAEA,OAAF,EAAEA,EAAWlQ,IAAKlJ,MAAe,OAAToZ,QAAS,IAATA,OAAA,EAAAA,EAAWpZ,OAAQ,KACtD,kBAACgZ,GAAD,YAAWI,QAAX,IAAWA,OAAX,EAAWA,EAAWpZ,W,6FChC1B,IAAMsN,GAAerM,IAAOmB,IAAV,MA0ClB,IAgBe1C,gBAhBS,SAAC,GAAuB,IAAtB1D,EAAqB,EAArBA,KAAMa,EAAe,EAAfA,UACzBD,EAASZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IAC9C,MAAO,CACNlD,SACA/E,KAAOgF,EAAUtD,uBAAuBqD,GACxCuL,MAAOtL,EAAUpD,wBAAwBmD,GACzCkQ,QAASjQ,EAAUrD,0BAA0BoD,GAC7C/C,MAAOgD,EAAUhD,UAGQ,SAAA8E,GAAQ,MAAK,CACvCgb,WADuC,SAC5B/c,GACV+B,EAASuM,GAAmCtO,QAI/B8C,EAvDf,YAAuF,EAAlE4O,QAAkE,EAAzDH,MAA0D,IAAnDvR,EAAkD,EAAlDA,OAAQ/E,EAA0C,EAA1CA,KAAMsQ,EAAoC,EAApCA,MAAO2E,EAA6B,EAA7BA,QAASjT,EAAoB,EAApBA,MAAO8f,EAAa,EAAbA,WAMzE,GALAhZ,qBAAU,YACN/D,GAAW/E,GAASsQ,GAAU2E,GAChC6M,EAAW/c,MAGVuL,EAEF,OADAyR,QAAQC,IAAI1R,GACL,6BAAMA,EAAME,YAEpB,GAAGxQ,EACF,OAAO,wCAER,IAAMiiB,EAeP,SAAkCjgB,EAAO+C,GACxC,IAAImd,EAAgB,GACpB,IAAI,IAAIhd,KAAUlD,EACbA,EAAMkD,IACNia,MAAMC,QAAQpd,EAAMkD,GAAQma,iBAC3Brd,EAAMkD,GAAQma,eAAe1N,QAAQ5M,IAAW,IACpDmd,EAAchd,GAAUlD,EAAMkD,IAGhC,OAAOgd,EAxBWC,CAAyBngB,EAAO+C,GAClD,OACC,kBAAC,WAAD,KACC,kBAAC,GAAD,KAKH,SAAqBkd,GACpB,IAAIG,EAAgB,GACpB,IAAK,IAAIld,KAAU+c,EAClBG,EAAcrQ,KAAK,kBAAC,GAAD,CAAMtP,IAAKyC,EAAQA,OAAQA,EAAQC,KAAM8c,EAAU/c,MAEvE,OAAOkd,EAVUC,CAAYJ,IAC3B,kBAAC,GAAD,U,szBCxBH,IAAMK,GAAyBlZ,IAAOmB,IAAV,MAItBgY,GAAsBnZ,IAAOC,OAAV,MAqBtB,qBAAEmZ,SAAoB,4DAMnBC,GAAwBrZ,IAAOmB,IAAV,MAOxB,qBAAEiY,SAAwB,oBAEd,eAA+C,IAArCvB,EAAoC,EAApCA,MAAOuB,EAA6B,EAA7BA,QAASxa,EAAoB,EAApBA,QAASyD,EAAW,EAAXA,SACjD,OACC,kBAAC6W,GAAD,KACC,kBAACC,GAAD,CAAqBC,QAASA,EAASxa,QAASA,GAC9CiZ,GAEF,kBAACwB,GAAD,CAAuBD,QAASA,GAC9B/W,KChDU,qBACd,yBAAKjC,MAAM,KAAKC,OAAO,KAAKE,KAAK,OAAOC,MAAM,8BAC7C,0BAAM8Y,EAAE,yGAAyGzY,OAAO,UAAUC,YAAY,IAAIC,cAAc,Y,8GCGlK,IAAMwY,GAAuBvZ,IAAOmB,IAAV,MAsC1B,IAOe1C,gBAPS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAME,EAAR,EAAQA,UAAR,MAAwB,CAC/CU,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IACvCpH,MAAOwD,EAAUxD,UAES,SAAAiG,GAAQ,MAAK,KAGzBe,EAzCf,YAA0D,IACnD+a,EAkBP,SAAoBC,EAAchiB,EAAOkE,EAAQ+d,GAChD,OAAOD,EAAarb,QAAO,SAACub,EAASvd,GACpC,GAAGA,EAAOmZ,SAAWmE,EACpB,OAAOC,EAIR,IAAMC,GAAcniB,EAAM2E,EAAOlB,QAAQ2e,cACzC,OAAGle,IAAWS,EAAOyQ,QACb8M,EAAUC,EAEXD,EAAUC,IACf,GA9BsBE,CAD+B,EAAlCC,iBAAkC,EAAhBtiB,MAAgB,EAATkE,OXTV,0BWWrC,OACC,kBAAC4d,GAAD,KAKF,SAA0BC,GACzB,GAAwB,IAArBA,EACF,OAAO,KAER,GAAGA,EAAmB,EACrB,MAAO,cAER,GAAGA,EAAmB,EACrB,MAAO,UAZLQ,CAAiBR,GADnB,KACwCS,KAAKC,IAAIV,O,46BCFnD,IAAMW,GAAkBna,IAAOmB,IAAV,MAGfiZ,GAA0Bpa,IAAOmB,IAAV,MAIvBkZ,GAAgBra,IAAOsa,EAAV,MAKbC,GAAava,IAAOmB,IAAV,MAGVqZ,GAAoBxa,IAAOmB,IAAV,MAGjBsZ,GAAsBza,IAAOmB,IAAV,MAGnBuZ,GAAiB1a,IAAOmB,IAAV,MAIdwZ,GAAiB3a,IAAO4a,GAAV,MAIdC,GAAqB7a,IAAOsa,EAAV,MAIxB,SAASQ,GAAT,GAAuE,IAA9Cnf,EAA6C,EAA7CA,OAAQS,EAAqC,EAArCA,OAAQ2e,EAA6B,EAA7BA,aAAcC,EAAe,EAAfA,aACtD,OAAG5e,EAAOkZ,eAAiB3Z,GZ7CU,2BY6CAS,EAAOmZ,OAE1C,kBAAC6E,GAAD,KACC,kBAAC,GAAD,CAAcxb,QAASmc,GAAvB,UACA,kBAAC,GAAD,CAAcnc,QAASoc,EAAc/H,QAAM,GAA3C,WAKF,kBAACmH,GAAD,KACC,kBAAC,GAAD,CAAcxb,QAASoc,EAAc/H,QAAM,GAA3C,WAIH,SAASgI,GAAT,GAAqC,IAAhB/f,EAAe,EAAfA,OAAQC,EAAO,EAAPA,KAC5B,OACC,kBAACsf,GAAD,KACC,kBAAC,GAAD,CAAUvf,OAAQA,EAAQC,KAAMA,IAChC,kBAACuf,GAAD,KACC,kBAACC,GAAD,KAAiBxf,EAAK4D,MACtB,kBAAC8b,GAAD,KAAqB1f,EAAK6M,YA2B9B,IAmBevJ,gBAnBS,SAAC,EAAD,OAAE1D,EAAF,EAAEA,KAAMW,EAAR,EAAQA,UAAaU,EAArB,EAAqBA,OAArB,MAAkC,CACzD1F,KAAMgF,EAAUrD,MAAM+D,EAAOyQ,SAC7BlR,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,QAEb,SAACnB,EAAD,OAAYvB,EAAZ,EAAYA,SAAUC,EAAtB,EAAsBA,OAAtB,MAAmC,CAC7D2e,aAD6D,WAE5Drd,EAASkY,GAA+BzZ,EAAD,YAAC,eACpCC,GADmC,IAEtCmZ,OZpGmC,8BYuGrCyF,aAP6D,WAQ5Dtd,EAASkY,GAA+BzZ,EAAD,YAAC,eACpCC,GADmC,IAEtCmZ,OZzGmC,iCY8GvB9W,EAxCf,YAAsE,IAApDrC,EAAmD,EAAnDA,OAAQT,EAA2C,EAA3CA,OAAQjF,EAAmC,EAAnCA,KAAMqkB,EAA6B,EAA7BA,aAAcC,EAAe,EAAfA,aACrD,OAAItkB,EAIF,kBAACyjB,GAAD,KACC,kBAACI,GAAD,KACC,kBAAC,GAAD,CAAQtS,IAAKvR,EAAKuR,IAAKlJ,KAAMrI,EAAKqI,OAClC,kBAACyb,GAAD,KACC,kBAACH,GAAD,4BACA,kBAAC,GAAD,CAAYnf,OAAQkB,EAAOlB,OAAQoM,UAAW2T,OAGhD,kBAACH,GAAD,CAAgBnf,OAAQA,EACpBS,OAAQA,EACR2e,aAAcA,EACdC,aAAcA,KAdb,kBAACb,GAAD,mBAA6Be,KAAKC,UAAU/e,OC5DrD,IAceqC,gBAdS,SAAC,EAAD,GAA8B,IAA5BvC,EAA2B,EAA3BA,YAAeJ,EAAY,EAAZA,OACpCsf,EAAc,GAClB,IAAI,IAAIjf,KAAYD,EAAY5C,QAC5BwC,GAAUI,EAAY5C,QAAQ6C,IAC7BD,EAAY5C,QAAQ6C,GAAUL,SAAWA,IAC5Csf,EAAYjf,GAAYD,EAAY5C,QAAQ6C,IAI9C,MAAO,CACNif,iBAIa3c,EAxBf,YAAsC,IAAf2c,EAAc,EAAdA,YAClBC,EAAkB,GACtB,IAAK,IAAIlf,KAAYif,EAAa,CACjC,IAAME,EAAiB,kBAAC,GAAD,CAAQjiB,IAAK8C,EAC5BA,SAAUA,EACVC,OAAQgf,EAAYjf,KAC5Bkf,EAAgB1S,KAAK2S,GAEtB,OAAOD,KC2BR,IA4Be5c,gBA5BS,SAAC,EAAD,GAAyC,IAAvCvC,EAAsC,EAAtCA,YAAajB,EAAyB,EAAzBA,UAAaa,EAAY,EAAZA,OAC7Cie,EAAmBtO,OAAOC,OAAOxP,EAAY5C,SAASqS,QAAO,SAAAvP,GAAM,OAAIA,EAAON,OAASA,KACvFyf,EAAmBxB,EAAiB3b,QAAO,SAACmd,EAAkBnf,GACnE,OAAGnB,EAAUzD,eAAe4E,EAAOlB,QAC5B,GAAN,mBAAWqgB,GAAX,CAA6BtgB,EAAUzD,eAAe4E,EAAOlB,UAEvDqgB,IACL,IACGC,EAAiBzB,EAAiB0B,OAAM,SAAArf,GAAM,OAAInB,EAAU1D,iBAAiB6E,EAAOlB,WACpFwgB,EAAc3B,EAAiBhR,MAAK,SAAA3M,GAAM,OAAInB,EAAU3D,cAAc8E,EAAOlB,WAC7EygB,EAAsB5B,EAAiB0B,OAAM,SAAArf,GAAM,OAAInB,EAAUxD,MAAM2E,EAAOlB,WAEpF,MAAO,CACN6e,mBACAtiB,MAAOwD,EAAUxD,MACjBH,cAAe2D,EAAU3D,cACzBikB,mBACAC,iBACAE,cACAC,0BAGyB,SAAAje,GAAQ,MAAK,CACvCke,WADuC,SAC5B5O,EAASvV,EAAOH,GAC1BoG,E1DPM,SAA2CsP,EAASvV,EAAOH,GACjE,8CAAO,WAAMoG,GAAN,SAAAC,EAAA,sDAENqP,EAAQxC,SAAQ,SAAAtP,GACX5D,EAAc4D,IAAYzD,EAAMyD,IACnCwC,EAASyG,GAA0BjJ,OAJ/B,2CAAP,sD0DMS2gB,CAAkC7O,EAASvV,EAAOH,QAI9CmH,EA9Df,YAUI,IATH3C,EASE,EATFA,OACAie,EAQE,EARFA,iBACAtiB,EAOE,EAPFA,MACAH,EAME,EANFA,cACAikB,EAKE,EALFA,iBACAC,EAIE,EAJFA,eACAE,EAGE,EAHFA,YACAC,EAEE,EAFFA,oBACAC,EACE,EADFA,WAMA,OAJAlc,qBAAU,WACT,IAAMsN,EAAU+M,EAAiB/c,KAAI,SAAAZ,GAAM,OAAIA,EAAOlB,UACtD0gB,EAAW5O,EAASvV,EAAOH,MAEzBokB,IAAgBF,EACX,wCAEJG,EASH,6BACC,kBAAC,GAAD,CAAa7f,OAAQA,IACrB,kBAAC,GAAD,CAAaie,iBAAkBA,KATxB,oDAEP,6BAAMmB,KAAKC,UAAUI,Q,gQCtBxB,IAAMO,GAAmB9b,IAAOmB,IAAV,MAIhB4a,GAAc/b,IAAOsa,EAAV,MAwBjB,IAMe7b,gBANS,SAAC,EAAD,GAA6B,IAA3B/C,EAA0B,EAA1BA,UAAaM,EAAa,EAAbA,QACtC,MAAO,CACNtF,KAAMgF,EAAUrD,MAAM2D,EAAQggB,aAIjBvd,EAzBf,YAAoC,IAAjBzC,EAAgB,EAAhBA,QAAStF,EAAO,EAAPA,KAC3B,OAAIA,EAIH,kBAAColB,GAAD,KACC,kBAAC,GAAD,CAAQ7T,IAAKvR,EAAKuR,IAAKlJ,KAAMrI,EAAKqI,OAClC,kBAACgd,GAAD,KACE/f,EAAQyc,KADV,IAMH,SAAuBzc,GACtB,GAAGA,EAAQkB,WACV,OAAO+e,OAAOC,aAAa,MAE5B,OAAOD,OAAOC,aAAa,OATRC,CAAcngB,KANzB,kBAAC8f,GAAD,sBCbM,SAASM,GAAT,GAAgD,IAArBhiB,EAAoB,EAApBA,SAAUd,EAAU,EAAVA,QAKnD,MAJ4B,sBAAOc,GAAP,YAW7B,SAA8BlB,GAC7B,IAAImjB,EAAY,GAChB,IAAI,IAAIxf,KAAM3D,EACbmjB,EAAU1T,KAAV,aACC9L,MACG3D,EAAK2D,KAGV,OAAOwf,EAnByCC,CAAqBhjB,KACvBijB,MAAK,SAAC5e,EAAG6e,GACrD,OAAO7e,EAAEgN,SAAW6R,EAAE7R,YAEF3N,KAAI,SAAAyf,GACzB,OAAGA,EAAcvhB,OACT,kBAAC,GAAD,CAAQ7B,IAAKojB,EAAc5f,GAAIV,SAAUsgB,EAAc5f,GAAIT,OAAQqgB,IAEpE,kBAAC,GAAD,CAASpjB,IAAKojB,EAAc5f,GAAIb,QAASygB,O,4HCNlD,IAAMC,GAAuB1c,IAAOmB,IAAV,MAsC1B,IAiBe1C,gBAjBS,SAAC,EAAD,OAAEjC,EAAF,EAAEA,aAAcN,EAAhB,EAAgBA,YAAeJ,EAA/B,EAA+BA,OAA/B,MAA4C,CACnExB,gBAAiBkC,EAAalC,gBAC9BD,iBAAkBmC,EAAanC,iBAC/BD,SAAUoC,EAAapC,SACvBuiB,eAAgBzgB,EAAYxC,qBAAqBoC,GACjD8gB,gBAAiB1gB,EAAYzC,kBAAkBqC,GAC/CxC,QAAS4C,EAAY5C,YAEK,SAAAoE,GAAQ,MAAK,CACvCmf,gBADuC,SACvB/gB,GACf4B,E9CmBK,SAAkC5B,GACxC,8CAAO,WAAM4B,GAAN,mBAAAC,EAAA,6DACAC,EAAQC,IAASC,YAAYC,W3BtEF,Y2BuE/BC,MAAM,SAAS,KAAMlC,GACrBuc,QAAQ,YACRyE,MAAM,KACRpf,EAzDM,CACN7C,K7BqDsC,6B6BFhC,kBAOwB+C,EAAMK,MAP9B,OAOC8e,EAPD,OAQC3iB,EAAW2iB,EAAc5e,KAAKnB,KAAI,SAAAqB,GACvC,IAAMqM,EAAiBrM,EAAIC,OAC3B,OAAO,2BACHoM,GADJ,IAECC,SAAUD,EAAeC,SAASC,SAClCC,WAAYH,EAAeG,WAAWD,SACtC/N,GAAIwB,EAAIxB,GACRK,WAAYmB,EAAIyM,SAASC,sBAG3BrN,EAASwM,GAAkB9P,IAlBtB,wDAoBLsD,EAnEK,CACN7C,K7BiDuC,4B6BhDvCC,QAAS,CACRmB,WAgEgC,EAAD,MApB1B,+DAAP,sD8CpBU+gB,CAAyBlhB,KAEnCmhB,cAJuC,SAIzBnhB,GACb4B,ElBkEK,SAA6C5B,GACnD,8CAAO,WAAM4B,GAAN,mBAAAC,EAAA,6DACAC,EAAQC,IAASC,YAAYC,WvDzHH,WuD0H9BC,MAAM,SAAS,KAAMlC,GACrBkC,MAAM,SAAU,KAAM,CC/Ha,0BACD,2BD+HpCN,EAASuX,GAAsBnZ,IAJzB,kBAMuB8B,EAAMK,MAN7B,OAMCC,EAND,OAOC5E,EAAU4E,EAAcC,KAAKC,QAAO,SAAC9E,EAAS+E,GACnD,IAAM6e,EAAgB7e,EAAIC,OAM1B,OALAhF,EAAQ+E,EAAIxB,IAAZ,2BACIqgB,GADJ,IAECvS,SAAUuS,EAAcvS,SAASC,SACjCC,WAAYqS,EAAcrS,WAAWD,WAE/BtR,IACL,IACHoE,EAASsX,GAAuBlZ,EAAQxC,IAhBnC,kDAkBLoE,EAASwX,GAAuBpZ,EAAD,OAlB1B,0DAAP,sDkBnEUqhB,CAAoCrhB,QAIhC2C,EAnDf,YAUK,IATH3C,EASE,EATFA,OACAxB,EAQE,EARFA,gBACAD,EAOE,EAPFA,iBACAD,EAME,EANFA,SACAuiB,EAKE,EALFA,eACAC,EAIE,EAJFA,gBACAtjB,EAGE,EAHFA,QACAujB,EAEE,EAFFA,gBACAI,EACE,EADFA,cAgBD,OAbAvd,qBAAU,WACLrF,GAAqBC,GACxBuiB,EAAgB/gB,KAEf,CAACA,EAAQxB,EAAiBD,EAAkBwiB,IAG/Cnd,qBAAU,WACLkd,GAAoBD,GACvBM,EAAcnhB,KAEb,CAACA,EAAQ6gB,EAAgBC,EAAiBK,IAEzCN,GAAmBA,EAItB,kBAACD,GAAD,KACC,kBAAC,GAAD,CAAiBtiB,SAAUA,EAAUd,QAASA,KAJxC,2C,wLC/BT,IAAM8jB,GAAyBpd,IAAOmB,IAAV,MAuB5B,IASe1C,gBATS,SAAC,GAAD,IAAE1D,EAAF,EAAEA,KAAF,MAAa,CACpCY,OAAQZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,QAEb,SAAAnB,GAAQ,MAAK,CACvC2f,cADuC,SACzB5E,EAAM3c,EAAQkgB,EAAUsB,GACrC5f,E/CyEK,SAAwC5B,EAAQ2c,EAAMuD,EAAUsB,GACtE,8CAAO,WAAM5f,GAAN,iBAAAC,EAAA,6DACA4f,EAAa1f,IAASC,YAAYC,W3BvGP,Y2BuGwCM,MACnErC,EAAU,CACfF,SACA2c,OACAuD,WACAsB,cACA3S,SAAU9M,IAASC,UAAU2K,WAAW+M,kBACxC3K,WAAYhN,IAASC,UAAU2K,WAAW+M,mBAE3C9X,EAASyM,GAAmB,KAAD,YAAC,aAC3BtN,GAAI0gB,EAAW1gB,IACZb,GAFuB,IAG1BkB,YAAY,MAbP,kBAgBCqgB,EAAW5J,IAAI3X,GAhBhB,OAiBL0B,EAhFK,CACN7C,K7BkC0C,+B6BjC1CC,QAAS,CACRmC,mBA6EmCsgB,EAAW1gB,MAjBzC,sDAmBLa,EAASyM,GAAmBoT,EAAW1gB,GAAZ,YAAC,aAC3BA,GAAI0gB,EAAW1gB,IACZb,GAFuB,IAG1BwhB,UAAS,SAtBL,8DAAP,sD+C1EUC,CAA+BhF,EAAM3c,EAAQkgB,EAAUsB,QAInD7e,EAxBf,YAAsE,IAA9C3C,EAA6C,EAA7CA,OAAQwhB,EAAqC,EAArCA,YAAa3hB,EAAwB,EAAxBA,OAAQ0hB,EAAgB,EAAhBA,cAAgB,EACtC5b,mBAAS,IAD6B,mBAC7DzF,EAD6D,KACpD0hB,EADoD,KAMpE,OACC,kBAACN,GAAD,KACC,kBAAC,GAAD,CAAa9X,MAAOtJ,EAChB0J,YAAY,yBACZH,SAAUmY,EACVlY,SATN,WACC6X,EAAcvhB,EAAQE,EAASL,EAAQ2hB,GACvCI,EAAW,W,+OCJb,IAAMC,GAAgB3d,IAAO6E,KAAV,MAKbiT,GAAgB9X,IAAOmB,IAAV,MA8CnB,IA0Be1C,gBA1BS,SAAC,EAAD,GAA2C,IAAzC1D,EAAwC,EAAxCA,KAAMa,EAAkC,EAAlCA,UAAWF,EAAuB,EAAvBA,UACpCI,EAD2D,EAAXoR,MACjCC,OAAOrR,OACtBH,EAASZ,EAAK/D,UAAY+D,EAAK/D,SAAS6H,IACxC9C,EAAOH,EAAUhD,MAAMkD,GACvBmc,EAAelC,MAAMC,QAAQja,GAAQA,EAAKka,gBAC7Cla,EAAKka,eAAe2H,MAAK,SAAA/hB,GAAa,OAAIA,IAAkBF,KAC5D,KAEH,MAAO,CACNG,SACAC,OACAJ,SACAjF,KAAMgF,EAAUrD,MAAMsD,GACtBsc,cACAE,UAAWzc,EAAUrD,MAAM4f,OAGF,SAAAva,GAAQ,MAAK,CACvCmgB,YADuC,SAC3B/hB,GACX4B,EjDsBK,SAAkC5B,GACxC,8CAAO,WAAM4B,GAAN,iBAAAC,EAAA,6DACAa,EAAMX,IAASC,YACpBC,W1BzG6B,S0B0G7BM,IAAIvC,GACL4B,EAASqM,GAAkBjO,IAJrB,kBAMa0C,EAAIP,MANjB,OAMCI,EAND,OAOLX,EAASoM,GAAmBhO,EAAQuC,EAAIC,SAPnC,gDASLZ,EAASsM,GAAmBlO,EAAD,OATtB,yDAAP,sDiDvBUgiB,CAAyBhiB,KAEnCiiB,YAJuC,SAI3BpiB,GACX+B,EAASa,EAA8B5C,QAI1B8C,EArEf,YAQgB,IAPf3C,EAOc,EAPdA,OACAC,EAMc,EANdA,KACAJ,EAKc,EALdA,OACAjF,EAIc,EAJdA,KACAuhB,EAGc,EAHdA,YACAE,EAEc,EAFdA,UACA0F,EACc,EADdA,YACAE,EAAc,EAAdA,YACAre,qBAAU,WACN/D,IAAWjF,GACbqnB,EAAYpiB,GAEVsc,IAAgBE,GAClB4F,EAAY9F,IAETlc,GAAQD,GACX+hB,EAAY/hB,KAEX,CAACH,EAAQjF,EAAMoF,EAAQC,EAAMkc,EAAaE,EAAW0F,EAAaE,IAXvD,MAYwBtc,oBAAS,GAZjC,mBAYPuc,EAZO,KAYMC,EAZN,KAad,OAAItiB,EAIH,kBAAC,WAAD,KACC,kBAAC,GAAD,KACC,kBAACmZ,GAAD,CAAY3V,GvExCe,SuEwCM+U,MAAI,EAACD,MAAI,GAA1C,oBACYkE,QADZ,IACYA,OADZ,EACYA,EAAWpZ,KACtB,kBAAC4e,GAAD,KAAe,kBAACO,GAAD,QAEhB,kBAACC,GAAD,CAAetG,MAAM,mBACjBuB,QAAS4E,EACTpf,QAAS,kBAAMqf,GAAgBD,KAClC,kBAAC,GAAD,CAAMliB,OAAQA,KAEf,kBAAC,GAAD,CAAaA,OAAQA,KAEtB,kBAAC,GAAD,CAAcA,OAAQA,EAAQwhB,YAAarF,KAhBrC,kBAAC,GAAD,SC1CM,SAASmG,KACvB,OAAO,8CCkCR,IAAMC,GAAQC,YACbC,OACG/F,EACAgG,YAAgBC,MAEL,cACd,OACC,kBAAC,WAAD,KACC,kBAAC,IAAD,CAAUJ,MAAOA,IAChB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOK,UAAWld,KACjB,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOmd,OAAK,EAAC1f,KAAK,IAAIyf,UAAWE,KACjC,kBAAC,IAAD,CAAOD,OAAK,EAAC1f,KzE7CY,UyE6CYyf,UAAWG,KAChD,kBAAC,IAAD,CAAOF,OAAK,EAAC1f,KzE7CY,kByE6CYyf,UAAWE,KAChD,kBAAC,IAAD,CAAOD,OAAK,EAAC1f,KzEhDa,gByEgDYyf,UAAWI,KACjD,kBAAC,IAAD,CAAOH,OAAK,EAAC1f,KzE9CkB,gByE8CYyf,UAAWK,KAEtD,kBAAC,IAAD,CAAOJ,OAAK,EAAC1f,KzE/CU,gByE+CYyf,UAAWM,KAC9C,kBAAC,IAAD,CAAOL,OAAK,EACV1f,KAAMggB,qBACNC,OAAQ,SAAAC,GAAU,OAAI,kBAAC,GAAD,iBAAcA,EAAd,CAA0BlI,UzEzD5B,ayE0DtB,kBAAC,IAAD,CAAO0H,OAAK,EACV1f,KAAMggB,yBACNC,OAAQ,SAAAC,GAAU,OAAI,kBAAC,GAAD,iBAAcA,EAAd,CAA0BlI,UzE3DxB,iByE6D1B,kBAAC,IAAD,CAAO0H,OAAK,EAAC1f,KzEtDW,SyEsDYyf,UAAWU,KAC/C,kBAAC,IAAD,CAAOT,OAAK,EAAC1f,KzEtDU,iByEsDYyf,UAAWW,KAC9C,kBAAC,IAAD,CAAOX,UAAWY,MAEpB,kBAAC,GAAD,OAED,kBAAC,GAAD,SCxDgBC,QACW,cAA7B3d,OAAO4d,SAASC,UAEe,UAA7B7d,OAAO4d,SAASC,UAEhB7d,OAAO4d,SAASC,SAASvS,MACvB,2D,MCFNrP,IAAS6hB,cATc,CACtBC,OAAQ,0CACRC,WAAY,+BACZC,YAAa,sCACbC,UAAW,eACXC,cAAe,2BACfC,kBAAmB,gBACnBC,MAAO,yCAGRC,IAAShB,OAAO,kBAACiB,GAAD,MAAS5d,SAAS6d,eAAe,SDgH3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMra,MAAK,SAAAsa,GACjCA,EAAaC,kB","file":"static/js/main.0314aa8d.chunk.js","sourcesContent":["import {\n\tOFFERS_ADD_SHOW_MODAL,\n\tOFFERS_ADD_HIDE_MODAL\n} from '../constants/action-types'\nconst initialState = {\n\tuser: null,\n\tmodalShown: false,\n\twait: false,\n\taddError: ''\n}\nexport default function (state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase OFFERS_ADD_SHOW_MODAL: return {\n\t\t\t...state,\n\t\t\tmodalShown: true,\n\t\t\tuser: action.payload.user\n\t\t}\n\t\tcase OFFERS_ADD_HIDE_MODAL: return {\n\t\t\t...state,\n\t\t\tmodalShown: false,\n\t\t\tuser: null\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tAUTH_SHOW_MODAL,\n    AUTH_HIDE_MODAL,\n\tAUTH_SUBSCRIBE,\n    AUTH_LOGIN,\n    AUTH_LOGOUT,\n\tAUTH_LOGOUT_WAIT,\n\tAUTH_LOGOUT_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n    authModalShown: false,\n    subscribed: false, //Firebase has authentification state change subscription\n\tauthData: null, //Authenticated user data owned by firebase\n\tlogoutError: '',\n\twait: false //auth state change is not always triggered.\n}\n\nexport default function (state = initialState, action) {\n    switch(action.type) {\n\t\tcase AUTH_SHOW_MODAL: return {\n            ...state,\n            authModalShown: true,\n        }\n        case AUTH_HIDE_MODAL: return {\n            ...state,\n            authModalShown: false\n        }\n\t\tcase AUTH_SUBSCRIBE: return {\n            ...state,\n            subscribed: true\n        }\n        case AUTH_LOGIN: return {\n\t\t\t...state,\n\t\t\tauthModalShown: false,\n\t\t\tauthData: action.payload.authData\n        }\n        case AUTH_LOGOUT: return {\n\t\t\t...state,\n\t\t\tauthData: null,\n\t\t\twait: false,\n\t\t}\n\t\tcase AUTH_LOGOUT_WAIT: return {\n\t\t\t...state,\n\t\t\twait: true,\n\t\t\tlogoutError: ''\n\t\t}\n\t\tcase AUTH_LOGOUT_ERROR: return {\n\t\t\t...state,\n\t\t\tlogoutError: action.payload.logoutError\n\t\t}\n        default: return state\n\t}\n}","import {\n\tGAME_FINDER_SEARCH_PHRASE,\n\tGAME_FINDER_FETCH,\n\tGAME_FINDER_FETCH_WAIT,\n\tGAME_FINDER_FETCH_ERROR,\n\tGAME_FINDER_FETCH_CANCEL\n} from '../constants/action-types'\n\nconst initialState = {\n\tsearchPhrase: '', //Whole phrase user is searching\n\tsearchKey: '', //String search key usualy 2 letters\n\tpendingPromise: null, //Last fetch promise \n\tgamesFetchError: null, //Last fetch error for searchKey\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase GAME_FINDER_SEARCH_PHRASE: return {\n\t\t\t...state,\n\t\t\tsearchPhrase: action.payload.searchPhrase\n\t\t}\n\t\tcase GAME_FINDER_FETCH: if (state.pendingPromise === action.payload.pendingPromise) {\n\t\t\t//request is still being expected\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpendingPromise: null\n\t\t\t}\n\t\t} else {\n\t\t\t//this request was cancelled\n\t\t\treturn state\n\t\t}\n\t\tcase GAME_FINDER_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tsearchKey: action.payload.searchKey,\n\t\t\tpendingPromise: action.payload.pendingPromise,\n\t\t\tgamesFetchError: ''\n\t\t}\n\t\tcase GAME_FINDER_FETCH_ERROR: if(state.pendingPromise === action.payload.pendingPromise) {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpendingPromise: null,\n\t\t\t\tgames: {},\n\t\t\t\tgamesFetchError: action.payload.gamesFetchError\n\t\t\t}\n\t\t} else {\n\t\t\t//TODO log error\n\t\t\treturn state\n\t\t}\n\t\tcase GAME_FINDER_FETCH_CANCEL: return {\n\t\t\t...state,\n\t\t\tpendingPromise: null\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tGAME_CACHE_FETCH_BY_ID,\n\tGAME_CACHE_WAIT_BY_ID,\n\tGAME_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\n\nconst initialState = {\n\tgamesByIdWait: {}, //Map, key: id of game, value: Boolean is being Fetched\n\tgamesByIdFetched: {}, //Map, key: id of game, value: Boolean is already fetche (successfull or not)\n\tgamesByIdError: {},//Map, key: id of game, value: Error on game fetching\n\tgames: {} //Map, key: id of game, value: game object\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase GAME_CACHE_FETCH_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: true,\n\t\t\t},\n\t\t\tgames: {\n\t\t\t\t...state.games,\n\t\t\t\t[action.payload.gameId]: action.payload.game\n\t\t\t}\n\t\t}\n\t\tcase GAME_CACHE_WAIT_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdError: {\n\t\t\t\t...state.gamesByIdError,\n\t\t\t\t[action.payload.gameId]: null\n\t\t\t}\n\t\t}\n\t\tcase GAME_CACHE_ERROR_BY_ID: return {\n\t\t\t...state,\n\t\t\tgamesByIdWait: {\n\t\t\t\t...state.gamesByIdWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tgamesByIdFetched: {\n\t\t\t\t...state.gamesByIdFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tgamesByIdError: {\n\t\t\t\t...state.gamesByIdError,\n\t\t\t\t[action.payload.gameId]: action.payload.gameByIdError\n\t\t\t}\t\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tOFFER_FINDER_FETCH,\n\tOFFER_FINDER_WAIT,\n\tOFFER_FINDER_ERROR,\n} from '../constants/action-types'\n\nconst initialState = {\n\toffersForGameWait: {}, //map key - gameId, value Boolean is being fetched\n\toffersForGameFetched: {}, //map key - gameId, value Boolean is fetched\n\toffers: {}, //map of offers\n\toffersFetchErrors: {} //map key - gameId, value query Error\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase OFFER_FINDER_FETCH: {\n\t\t\t//Fetched all active offers for the game.\n\t\t\t//All previous offer are outdated\n\t\t\tlet filteredOffers = {}\n\t\t\tfor(let offerId in state.offers) {\n\t\t\t\tif(state.offers[offerId].gameId !== action.payload.gameId) {\n\t\t\t\t\tfilteredOffers[offerId] = state.offers[offerId]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\toffersForGameWait: {\n\t\t\t\t\t...state.offersForGameWait,\n\t\t\t\t\t[action.payload.gameId]: false\n\t\t\t\t},\n\t\t\t\toffersForGameFetched: {\n\t\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t\t[action.payload.gameId]: true\n\t\t\t\t},\n\t\t\t\toffers: {\n\t\t\t\t\t...filteredOffers,\n\t\t\t\t\t...action.payload.offersToAdd\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcase OFFER_FINDER_WAIT: return {\n\t\t\t...state,\n\t\t\toffersForGameWait: {\n\t\t\t\t...state.offersForGameWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\toffersForGameFetched: {\n\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\toffersFetchErrors: {\n\t\t\t\t...state.offersFetchErrors,\n\t\t\t\t[action.payload.gameId]: ''\n\t\t\t}\n\t\t}\n\t\tcase OFFER_FINDER_ERROR: return {\n\t\t\t...state,\n\t\t\toffersForGameWait: {\n\t\t\t\t...state.offersForGameWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\toffersForGameFetched: {\n\t\t\t\t...state.offersForGameFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\toffersFetchErrors: {\n\t\t\t\t...state.offersFetchErrors,\n\t\t\t\t[action.payload.gameId]: action.payload.offersFetchError\n\t\t\t}\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tUSER_CACHE_FETCH_BY_OFFER,\n\tUSER_CACHE_WAIT_BY_OFFER,\n\tUSER_CACHE_ERROR_BY_OFFER,\n\tUSER_CACHE_FETCH_BY_ID,\n\tUSER_CACHE_WAIT_BY_ID,\n\tUSER_CACHE_ERROR_BY_ID,\n\tUSER_CACHE_UPDATE,\n\tUSER_CACHE_UPDATE_WAIT,\n\tUSER_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n\tusersByOfferWait: {}, //Map, key: GameId, value: Boolean is being fetched\n\tusersByOfferFetched: {}, //Map, key: GameId, value: Boolean is fetched\n\tusersByOfferError: {},  //Map, key: GameId, value Error fetching Error\n\tuserByIdWait: false,\n\tuserByIdError: null,\n\tuserUpdateWait: false,\n\tuserUpdateError: '',\n\tusers: {} //Map, key: user UID, value Object user\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase USER_CACHE_FETCH_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t...action.payload.users\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_WAIT_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferError: {\n\t\t\t\t...state.usersByOfferError,\n\t\t\t\t[action.payload.gameId]: null\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_ERROR_BY_OFFER: return {\n\t\t\t...state,\n\t\t\tusersByOfferWait: {\n\t\t\t\t...state.usersByOfferWait,\n\t\t\t\t[action.payload.gameId]: false\n\t\t\t},\n\t\t\tusersByOfferFetched: {\n\t\t\t\t...state.usersByOfferFetched,\n\t\t\t\t[action.payload.gameId]: true\n\t\t\t},\n\t\t\tusersByOfferError: {\n\t\t\t\t...state.usersByOfferError,\n\t\t\t\t[action.payload.gameId]: action.payload.usersByOfferError\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_FETCH_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: false,\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t[action.payload.userId]:action.payload.user\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_WAIT_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: true,\n\t\t\tuserByIdError: null\n\t\t}\n\t\tcase USER_CACHE_ERROR_BY_ID: return {\n\t\t\t...state,\n\t\t\tuserByIdWait: false,\n\t\t\tuserByIdError: action.payload.userByIdError\n\t\t}\n\t\tcase USER_CACHE_UPDATE: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: false,\n\t\t\tusers: {\n\t\t\t\t...state.users,\n\t\t\t\t[action.payload.userId]: action.payload.user\n\t\t\t}\n\t\t}\n\t\tcase USER_CACHE_UPDATE_WAIT: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: true,\n\t\t\tuserUpdateError: false\n\t\t}\n\t\tcase USER_CACHE_UPDATE_ERROR: return {\n\t\t\t...state,\n\t\t\tuserUpdateWait: false,\n\t\t\tuserUpdateError: action.payload.userUpdateError\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tCHAT_CACHE_FETCH_BY_PARTICIPANT, //TODO rename all actions to user FETCH_BY_SOMTH\n\tCHAT_CACHE_WAIT_BY_PARTICIPANT,\n\tCHAT_CACHE_ERROR_BY_PARTICIPANT,\n\tCHAT_CACHE_ADD_PUSH,\n\tCHAT_CACHE_ADD_WAIT,\n\tCHAT_CACHE_ADD_ERROR,\n\tCHAT_CACHE_LAST_MESSAGE_FETCH,\n\tCHAT_CACHE_FETCH_BY_ID,\n\tCHAT_CACHE_WAIT_BY_ID,\n\tCHAT_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\n\nconst initialState = {\n\tchatsByParticipantWait: {}, //Map, key: participantId, value Boolean is being fetched\n\tchatsByParticipantFetched: {}, //Map, key: participantId, value Boolean is fetched\n\tchatsByParticipantError: {}, //Map, key: participantId, value Error\n\tchatsByIdWait: {}, //Map, key chatId, value boolean is being fetched\n\tchatsByIdFetched: {}, //Map, key chatId, value boolean is fetched\n\tchatsByIdError: {}, //Map, key chatId, value Error fetching\n\tchats: {}, //Map, key: chatId, value Object chat\n\tchatsLastMessages: {}, //Map, key: chatId, value Object last message\n\tchatsNames: {}, //Map, key: chatId, value string name\n\tchatAddWait: false,\n\tchatAddError: null\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase CHAT_CACHE_FETCH_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchats: {\n\t\t\t\t...state.chats,\n\t\t\t\t...action.payload.chats\n\t\t\t},\n\t\t\tchatsByIdFetched: {\n\t\t\t\t...state.chatsByIdFetched,\n\t\t\t\t...objectMap(action.payload.chats, () => true)\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_WAIT_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantError: {\n\t\t\t\t...state.chatsByParticipantError,\n\t\t\t\t[action.payload.participantId]: null\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_ERROR_BY_PARTICIPANT: return {\n\t\t\t...state,\n\t\t\tchatsByParticipantWait: {\n\t\t\t\t...state.chatsByParticipantWait,\n\t\t\t\t[action.payload.participantId]: false\n\t\t\t},\n\t\t\tchatsByParticipantFetched: {\n\t\t\t\t...state.chatsByParticipantFetched,\n\t\t\t\t[action.payload.participantId]: true\n\t\t\t},\n\t\t\tchatsByParticipantError: {\n\t\t\t\t...state.chatsByParticipantError,\n\t\t\t\t[action.payload.participantId]: action.payload.chatsByParticipantError\n\t\t\t},\n\t\t}\n\t\tcase CHAT_CACHE_ADD_PUSH: return {\n\t\t\t...state,\n\t\t\tchats: {\n\t\t\t\t...state.chats,\n\t\t\t\t[action.payload.chatId]: action.payload.chat\n\t\t\t},\n\t\t\tchatAddWait: false\n\t\t}\n\t\tcase CHAT_CACHE_ADD_WAIT: return {\n\t\t\t...state,\n\t\t\tchatAddWait: false,\n\t\t\tchatAddError: null\n\t\t}\n\t\tcase CHAT_CACHE_ADD_ERROR: return {\n\t\t\t...state,\n\t\t\tchatAddWait: false,\n\t\t\tchatAddError: action.payload.addError\n\t\t}\n\t\tcase CHAT_CACHE_LAST_MESSAGE_FETCH: return {\n\t\t\t...state,\n\t\t\tchatsLastMessages: {\n\t\t\t\t...state.chatsLastMessages,\n\t\t\t\t[action.payload.chatId]: action.payload.message\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_FETCH_BY_ID: return {\n\t\t\t...state,\n\t\t\tchats: {\n\t\t\t\t...state.chats,\n\t\t\t\t[action.payload.chatId]: action.payload.chat\n\t\t\t},\n\t\t\tchatsByIdWait: {\n\t\t\t\t...state.chatsByIdWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tchatsByIdFetched: {\n\t\t\t\t...state.chatsByIdFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_WAIT_BY_ID: return {\n\t\t\t...state,\n\t\t\tchatsByIdWait: {\n\t\t\t\t...state.chatsByIdWait,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tchatsByIdFetched: {\n\t\t\t\t...state.chatsByIdFetched,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tchatsByIdError: {\n\t\t\t\t...state.chatsByIdError,\n\t\t\t\t[action.payload.chatId]: null\n\t\t\t}\n\t\t}\n\t\tcase CHAT_CACHE_ERROR_BY_ID: return {\n\t\t\t...state,\n\t\t\tchatsByIdWait: {\n\t\t\t\t...state.chatsByIdWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tchatsByIdFetched: {\n\t\t\t\t...state.chatsByIdFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tchatsByIdError: {\n\t\t\t\t...state.chatsByIdError,\n\t\t\t\t[action.payload.chatId]: action.payload.fetchError\n\t\t\t}\n\t\t}\n\t\tdefault: return state\n\t}\n}\n//TODO put this to utilities\n/**\n * Converts map like object values using iteratee\n * @param {Object} list \n * @param {function} iteratee is passed three arguments: the value, key and reference to list\n * @returns {Object} map with same keys but object represented by true\n */\nfunction objectMap(list, iteratee) {\n\tlet mappedList = {}\n\tfor(let key in list) {\n\t\tmappedList[key] = iteratee(list[key], key, list)\n\t}\n\treturn mappedList\n}","import {\n\tCLAUSE_CACHE_ADD_PUSH,\n\tCLAUSE_CACHE_ADD_WAIT,\n\tCLAUSE_CACHE_ADD_ERROR,\n\tCLAUSE_CACHE_FETCH_BY_CHAT,\n\tCLAUSE_CACHE_WAIT_BY_CHAT,\n\tCLAUSE_CACHE_ERROR_BY_CHAT,\n\tCLAUSE_CACHE_UPDATE_STATUS,\n\tCLAUSE_CACHE_UPDATE_WAIT,\n\tCLAUSE_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\n\nconst initialState = {\n\tclauses: {},\t/* Map, key: clauseId, value Object clause.\n\t\t\t\t\tAll clauses from this collection, are displayed in chat. */\n\tclauseAddWait: false,\t//Boolean flag, clause is now being added to server\n\tclauseAddError: null,\t//Error on adding clause object to (server database)\n\tclausesByChatWait: {},\t//Map, key: chatId, value: Boolean is being Fetched\n\tclausesByChatFetched: {},\t//Map, key: chatId, value: Boolean is Fetched\n\tclausesByChatError: {},\t//Map, key: chatId, value: Error\n\tclausesUpdateWait: false,\t//Boolean flag, clause is being updated\n\tclausesUpdateError: null\t//Error on updating clause specifficaly status\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase CLAUSE_CACHE_ADD_PUSH: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t[action.payload.clauseId]: action.payload.clause\n\t\t\t},\n\t\t\tclauseAddWait: false\n\t\t}\n\t\tcase CLAUSE_CACHE_ADD_WAIT: return {\n\t\t\t...state,\n\t\t\tclauseAddWait: true,\n\t\t\tclauseAddError: null\n\t\t}\n\t\tcase CLAUSE_CACHE_ADD_ERROR: return {\n\t\t\t...state,\n\t\t\tclauseAddWait: false,\n\t\t\tclauseAddError: action.payload.addError\n\t\t}\n\t\tcase CLAUSE_CACHE_FETCH_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t...action.payload.clauses\n\t\t\t},\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_WAIT_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatError: {\n\t\t\t\t...state.clausesByChatError,\n\t\t\t\t[action.payload.chatId]: null\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_ERROR_BY_CHAT: return {\n\t\t\t...state,\n\t\t\tclausesByChatWait: {\n\t\t\t\t...state.clausesByChatWait,\n\t\t\t\t[action.payload.chatId]: false\n\t\t\t},\n\t\t\tclausesByChatFetched: {\n\t\t\t\t...state.clausesByChatFetched,\n\t\t\t\t[action.payload.chatId]: true\n\t\t\t},\n\t\t\tclausesByChatError: {\n\t\t\t\t...state.clausesByChatError,\n\t\t\t\t[action.payload.chatId]: action.payload.clausesByChatError\n\t\t\t}\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_STATUS: return {\n\t\t\t...state,\n\t\t\tclauses: {\n\t\t\t\t...state.clauses,\n\t\t\t\t[action.payload.clauseId]: action.payload.clause\n\t\t\t},\n\t\t\tclausesUpdateWait: false\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_WAIT: return {\n\t\t\t...state,\n\t\t\tclausesUpdateWait: true,\n\t\t\tclausesUpdateError: null,\n\t\t}\n\t\tcase CLAUSE_CACHE_UPDATE_ERROR: return {\n\t\t\t...state,\n\t\t\tclausesUpdateWait: false,\n\t\t\tclausesUpdateError: action.payload.updateError\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tADDRESS_LOOKUP_CACHE_FETCH,\n\tADDRESS_LOOKUP_CACHE_FETCH_WAIT,\n\tADDRESS_LOOKUP_CACHE_FETCH_ERROR,\n} from '../constants/action-types'\n\nconst initialState = {\n\tlookupPhrase: '', //Lookup phrase\n\tsuggestions: [], //Array of places, https://nominatim.org/release-docs/develop/api/Output/\n\tsuggestionsFetchWait: false,\n\tsuggestionsFetchError: null,\n\tsuggestionsFetched: false\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH: return {\n\t\t\t...state,\n\t\t\tsuggestions: action.payload.suggestions,\n\t\t\tsuggestionsFetchWait: false,\n\t\t\tsuggestionsFetched: true\n\t\t}\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tlookupPhrase: action.payload.lookupPhrase,\n\t\t\tsuggestionsFetchWait: true,\n\t\t\tsuggestionsFetched: false,\n\n\t\t}\n\t\tcase ADDRESS_LOOKUP_CACHE_FETCH_ERROR: return {\n\t\t\t...state,\n\t\t\tsuggestionsFetchWait: false,\n\t\t\tsuggestionsFetched: true,\n\t\t\tsuggestionsFetchError: action.payload.suggestionsFetchError\n\t\t}\n\t\tdefault: return state\n\t}\n}","/*\n\tReducer used only for self update. \n\tGeneric user update is not supported.\n*/\nimport {\n\tUSER_UPDATE_UNSAVED,\n\tUSER_UPDATE_SAVED\n} from '../constants/action-types'\n\nconst initialState = {\n\tuser: null,\n\tisSaved: true,\n}\n\nexport default function (state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase USER_UPDATE_UNSAVED: return {\n\t\t\t...state,\n\t\t\tuser: action.payload.user,\n\t\t\tisSaved: false,\n\t\t}\n\t\tcase USER_UPDATE_SAVED: return {\n\t\t\t...state,\n\t\t\tuser: action.payload.user,\n\t\t\tisSaved: true,\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {\n\tMESSAGE_CACHE_FETCH,\n\tMESSAGE_CACHE_FETCH_WAIT,\n\tMESSAGE_CACHE_FETCH_ERROR,\n\tMESSAGE_CACHE_UPDATE,\n\tMESSAGE_CACHE_UPDATE_CONFIRM,\n\tMESSAGE_CACHE_SUBSCRITION\n} from '../constants/action-types'\n\nconst initialState = {\n\tmessages: [], //Message list for specific chat.\n\tmessagesFetching: false, //Boolean flag, messages for chat are being fetched.\n\tmessagesFetched: false,\n\tmessagesFetchError: null, //Error on fetching chat messages.\n\tmessagesUnsubscribe: null //firebase unsubscribe function\n}\n\nexport default function(state = initialState, action) {\n\tswitch(action.type) {\n\t\tcase MESSAGE_CACHE_FETCH: return {\n\t\t\t...state,\n\t\t\tmessages: action.payload.messages,\n\t\t\tmessagesFetchFetching: false,\n\t\t\tmessagesFetched: true\n\t\t}\n\t\tcase MESSAGE_CACHE_FETCH_WAIT: return {\n\t\t\t...state,\n\t\t\tmessagesFetchFetching: true,\n\t\t\tmessagesFetched: false,\n\t\t\tmessagesFetchError: null,\n\t\t}\n\t\tcase MESSAGE_CACHE_FETCH_ERROR: return {\n\t\t\t...state,\n\t\t\tmessagesFetchFetching: false,\n\t\t\tmessagesFetched: true,\n\t\t\tmessagesFetchError: action.payload.fetchError\n\t\t}\n\t\tcase MESSAGE_CACHE_UPDATE: {\n\t\t\tconst messageIndex = (action.payload.outdatedMessageId\n\t\t\t\t? state.messages.findIndex(message => message.id === action.payload.outdatedMessageId)\n\t\t\t\t: -1)\n\t\t\tif(messageIndex >= 0 ) { //message is in array, replace it with updated\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tmessages: [\n\t\t\t\t\t\t...state.messages.slice(0, messageIndex),\n\t\t\t\t\t\taction.payload.updatedMessage,\n\t\t\t\t\t\t...state.messages.slice(messageIndex + 1)\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {//message is not in array, put in list as the last one, \n\t\t\t\t...state,\n\t\t\t\tmessages: [\n\t\t\t\t\t...state.messages,\n\t\t\t\t\taction.payload.updatedMessage\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t\tcase MESSAGE_CACHE_UPDATE_CONFIRM: return {\n\t\t\t...state,\n\t\t\tmessages: state.messages.map(message => {\n\t\t\t\tif(message.id === action.payload.confirmedMessageId) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...message,\n\t\t\t\t\t\tisUpdating: false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn message\n\t\t\t})\n\t\t}\n\t\tcase MESSAGE_CACHE_SUBSCRITION: return {\n\t\t\t...state,\n\t\t\tmessagesUnsubscribe: action.payload.messagesUnsubscribe\n\t\t}\n\t\tdefault: return state\n\t}\n}","import {combineReducers} from 'redux'\n\nimport offersAdd from './reducers/offers-add'\nimport auth from './reducers/auth'\nimport gameFinder from './reducers/game-finder'\nimport gameCache from './reducers/game-cache'\nimport offerFinder from './reducers/offer-finder'\nimport userCache from './reducers/user-cache'\nimport chatCache from './reducers/chat-cache'\nimport clauseCache from './reducers/clause-cache'\nimport addressLookupCache from './reducers/address-lookup-cache'\nimport userUpdate from './reducers/user-update'\nimport messageCache from './reducers/message-cache'\n\nexport default combineReducers({\n    offersAdd,\n    auth,\n    gameFinder,\n    gameCache,\n    offerFinder,\n    userCache,\n    chatCache,\n    clauseCache,\n    addressLookupCache,\n    userUpdate,\n    messageCache\n})","export const AUTH_SHOW_MODAL = 'AUTH_SHOW_MODAL'\nexport const AUTH_HIDE_MODAL = 'AUTH_HIDE_MODAL'\nexport const AUTH_SUBSCRIBE = 'AUTH_SUBSCRIBE'\nexport const AUTH_LOGIN = 'AUTH_LOGIN'\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT'\nexport const AUTH_LOGOUT_WAIT= 'AUTH_LOGOUT_WAIT'\nexport const AUTH_LOGOUT_ERROR = 'AUTH_LOGOUT_ERROR'\n\nexport const OFFERS_FETCH = 'OFFERS_FETCH'\nexport const OFFERS_FETCH_WAIT = 'OFFERS_FETCH_WAIT'\nexport const OFFERS_FETCH_ERROR = 'OFFERS_FETCH_ERROR'\nexport const OFFERS_PUSH = 'OFFERS_PUSH'\nexport const OFFERS_DELETE = 'OFFERS_DELETE'\nexport const OFFERS_DELETE_WAIT = 'OFFERS_DELETE_WAIT'\nexport const OFFERS_DELETE_ERROR = 'OFFERS_DELETE_ERROR'\n\nexport const OFFERS_ADD_SHOW_MODAL = 'OFFERS_ADD_SHOW_MODAL'\nexport const OFFERS_ADD_HIDE_MODAL = 'OFFERS_ADD_HIDE_MODAL'\n\nexport const GAME_CACHE_FETCH_BY_ID = 'GAME_CACHE_FETCH_BY_ID'\nexport const GAME_CACHE_WAIT_BY_ID = 'GAME_CACHE_WAIT_BY_ID'\nexport const GAME_CACHE_ERROR_BY_ID = 'GAME_CACHE_ERROR_BY_ID'\n\nexport const GAME_FINDER_SEARCH_PHRASE = 'GAME_FINDER_SEARCH_PHRASE'\nexport const GAME_FINDER_FETCH = 'GAME_FINDER_FETCH'\nexport const GAME_FINDER_FETCH_WAIT = 'GAME_FINDER_FETCH_WAIT'\nexport const GAME_FINDER_FETCH_ERROR = 'GAME_FINDER_FETCH_ERROR'\nexport const GAME_FINDER_FETCH_CANCEL = 'GAME_FINDER_FETCH_CANCEL'\n\nexport const OFFER_FINDER_FETCH = 'OFFER_FINDER_FETCH'\nexport const OFFER_FINDER_WAIT = 'OFFER_FINDER_WAIT'\nexport const OFFER_FINDER_ERROR = 'OFFER_FINDER_ERROR'\n\nexport const USER_CACHE_FETCH_BY_OFFER = 'USER_CACHE_FETCH_BY_OFFER'\nexport const USER_CACHE_WAIT_BY_OFFER = 'USER_CACHE_WAIT_BY_OFFER'\nexport const USER_CACHE_ERROR_BY_OFFER = 'USER_CACHE_ERROR_BY_OFFER'\nexport const USER_CACHE_FETCH_BY_ID = 'USER_CACHE_FETCH_BY_ID'\nexport const USER_CACHE_WAIT_BY_ID = 'USER_CACHE_WAIT_BY_ID'\nexport const USER_CACHE_ERROR_BY_ID = 'USER_CACHE_ERROR_BY_ID'\nexport const USER_CACHE_UPDATE = 'USER_CACHE_UPDATE'\nexport const USER_CACHE_UPDATE_WAIT = 'USER_CACHE_UPDATE_WAIT'\nexport const USER_CACHE_UPDATE_ERROR = 'USER_CACHE_UPDATE_ERROR'\n\nexport const GAME_FETCH = 'GAME_FETCH'\nexport const GAME_FETCH_WAIT = 'GAME_FETCH_WAIT'\nexport const GAME_FETCH_ERROR = 'GAME_FETCH_ERROR'\n\nexport const CHAT_CACHE_FETCH_BY_PARTICIPANT = 'CHAT_CACHE_FETCH_BY_PARTICIPANT'\nexport const CHAT_CACHE_WAIT_BY_PARTICIPANT = 'CHAT_CACHE_WAIT_BY_PARTICIPANT'\nexport const CHAT_CACHE_ERROR_BY_PARTICIPANT = 'CHAT_CACHE_ERROR_BY_PARTICIPANT'\nexport const CHAT_CACHE_ADD_PUSH = 'CHAT_CACHE_ADD_PUSH'\nexport const CHAT_CACHE_ADD_WAIT = 'CHAT_CACHE_ADD_WAIT'\nexport const CHAT_CACHE_ADD_ERROR = 'CHAT_CACHE_ADD_ERROR'\nexport const CHAT_CACHE_LAST_MESSAGE_FETCH = 'CHAT_CACHE_LAST_MESSAGE_FETCH'\nexport const CHAT_CACHE_FETCH_BY_ID = 'CHAT_CACHE_FETCH_BY_ID'\nexport const CHAT_CACHE_WAIT_BY_ID = 'CHAT_CACHE_WAIT_BY_ID'\nexport const CHAT_CACHE_ERROR_BY_ID = 'CHAT_CACHE_ERROR_BY_ID'\n\nexport const CLAUSE_CACHE_ADD_PUSH = 'CLAUSE_CACHE_ADD_PUSH'\nexport const CLAUSE_CACHE_ADD_WAIT = 'CLAUSE_CACHE_ADD_WAIT'\nexport const CLAUSE_CACHE_ADD_ERROR = 'CLAUSE_CACHE_ADD_ERROR'\nexport const CLAUSE_CACHE_FETCH_BY_CHAT = 'CLAUSE_CACHE_FETCH_BY_CHAT'\nexport const CLAUSE_CACHE_WAIT_BY_CHAT = 'CLAUSE_CACHE_WAIT_BY_CHAT'\nexport const CLAUSE_CACHE_ERROR_BY_CHAT = 'CLAUSE_CACHE_ERROR_BY_CHAT'\nexport const CLAUSE_CACHE_UPDATE_STATUS = 'CLAUSE_CACHE_UPDATE_STATUS'\nexport const CLAUSE_CACHE_UPDATE_WAIT = 'CLAUSE_CACHE_UPDATE_WAIT'\nexport const CLAUSE_CACHE_UPDATE_ERROR = 'CLAUSE_CACHE_UPDATE_ERROR'\n\nexport const ADDRESS_LOOKUP_CACHE_FETCH = 'ADDRESS_LOOKUP_CACHE_FETCH'\nexport const ADDRESS_LOOKUP_CACHE_FETCH_WAIT = 'ADDRESS_LOOKUP_CACHE_FETCH_WAIT'\nexport const ADDRESS_LOOKUP_CACHE_FETCH_ERROR = 'ADDRESS_LOOKUP_CACHE_FETCH_ERROR'\n\nexport const USER_UPDATE_UNSAVED = 'USER_UPDATE_UNSAVED'\nexport const USER_UPDATE_SAVED = 'USER_UPDATE_SAVED'\n\nexport const MESSAGE_CACHE_FETCH = 'MESSAGE_CACHE_FETCH'\nexport const MESSAGE_CACHE_FETCH_WAIT = 'MESSAGE_CACHE_FETCH_WAIT'\nexport const MESSAGE_CACHE_FETCH_ERROR = 'MESSAGE_CACHE_FETCH_ERROR'\nexport const MESSAGE_CACHE_UPDATE = 'MESSAGE_CACHE_UPDATE'\nexport const MESSAGE_CACHE_UPDATE_CONFIRM = 'MESSAGE_CACHE_UPDATE_CONFIRM'\nexport const MESSAGE_CACHE_SUBSCRITION = 'MESSAGE_CACHE_SUBSCRITION'","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tUSER_CACHE_FETCH_BY_OFFER,\n\tUSER_CACHE_WAIT_BY_OFFER,\n\tUSER_CACHE_ERROR_BY_OFFER,\n\tUSER_CACHE_FETCH_BY_ID,\n\tUSER_CACHE_WAIT_BY_ID,\n\tUSER_CACHE_ERROR_BY_ID,\n\tUSER_CACHE_UPDATE,\n\tUSER_CACHE_UPDATE_WAIT,\n\tUSER_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\nimport {COLLECTION_USERS} from '../constants/collection-names'\n//Actions\nfunction userCacheFetchByOffer(gameId, users) {\n\treturn {\n\t\ttype: USER_CACHE_FETCH_BY_OFFER,\n\t\tpayload: {gameId, users}\n\t}\n}\nfunction userCacheWaitByOffer(gameId) {\n\treturn {\n\t\ttype: USER_CACHE_WAIT_BY_OFFER,\n\t\tpayload: {gameId}\n\t}\n}\nfunction userCacheErrorByOffer(gameId, usersByOfferError) {\n\treturn {\n\t\ttype: USER_CACHE_ERROR_BY_OFFER,\n\t\tpayload: {gameId}\n\t}\n}\nfunction userCacheFetchById(userId, user) {\n\treturn {\n\t\ttype: USER_CACHE_FETCH_BY_ID,\n\t\tpayload: {userId, user}\n\t}\n}\nfunction userCacheWaitById() {\n\treturn {type: USER_CACHE_WAIT_BY_ID}\n}\nfunction userCacheErrorById(userByIdError) {\n\treturn {\n\t\ttype: USER_CACHE_ERROR_BY_ID,\n\t\tpayload: {userByIdError}\n\t}\n}\nfunction userCacheUpdate(userId, user) {\n\treturn {\n\t\ttype: USER_CACHE_UPDATE,\n\t\tpayload: {\n\t\t\tuserId,\n\t\t\tuser\n\t\t}\n\t}\n}\nfunction userCacheUpdateWait() {\n\treturn {type: USER_CACHE_UPDATE_WAIT}\n}\nfunction userCacheUpdateError(userUpdateError) {\n\treturn {\n\t\ttype: USER_CACHE_UPDATE_ERROR,\n\t\tpayload: {userUpdateError}\n\t}\n}\n//Thunks\n/**\n * Fetches all user for specified gameId as Offer\n * @param {String} gameId\n */\nexport function userCacheFetchByOfferRequest(gameId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore() //TODO rename complex names to query\n\t\t\t.collection(COLLECTION_USERS)\n\t\t\t.where('offerIds', 'array-contains', gameId)\n\t\tdispatch(userCacheWaitByOffer(gameId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst users = querySnapshot.docs.reduce((users, doc) => {\n\t\t\t\tusers[doc.id] = doc.data()\n\t\t\t\treturn users\n\t\t\t}, {})\n\t\t\tdispatch(userCacheFetchByOffer(gameId, users))\n\t\t} catch (usersByOfferError) {\n\t\t\tdispatch(userCacheErrorByOffer(gameId, usersByOfferError))\n\t\t}\n\t}\n}\n/**\n * Fetches single user\n * @param {String} userId same as authData.uid\n */\nexport function userCacheFetchUserByIdRequest(userId) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheWaitById())\n\t\ttry {\n\t\t\tconst doc = await ref.get()\n\t\t\tdispatch(userCacheFetchById(userId, doc.data() || null))\n\t\t} catch(userByIdError) {\n\t\t\tdispatch(userCacheErrorById (userByIdError))\n\t\t}\n\t}\n}\n/**\n * Adds Offer or demand to user Object\n * @param {String} userId\n * @param {String} gameId\n * @param {Boolean} isDemand\n */\n export function userCacheAddUserGameRequest(userId, gameId, isDemand) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tlet user = doc.data()\n\t\t\tconst updateField = isDemand ? 'demandIds' : 'offerIds'\n\t\t\tif (!user[updateField] || user[updateField].indexOf(gameId) < 0) {\n\t\t\t\tawait ref.update({\n\t\t\t\t\t[updateField]: firebase.firestore.FieldValue.arrayUnion(gameId)\n\t\t\t\t})\n\t\t\t\tuser[updateField] = user[updateField] || []\n\t\t\t\tuser[updateField].push(gameId)\n\t\t\t}\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n/**\n * Deletes Offer or demand to user Object\n * @param {String} userId\n * @param {String} gameId\n * @param {Boolean} isDemand\n */\n export function userCacheDeleteUserGameRequest(userId, gameId, isDemand) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tlet user = doc.data()\n\t\t\tconst updateField = isDemand ? 'demandIds' : 'offerIds'\n\t\t\tif (user[updateField] && user[updateField].indexOf(gameId) >= 0) {\n\t\t\t\tawait ref.update({\n\t\t\t\t\t[updateField]: firebase.firestore.FieldValue.arrayRemove(gameId)\n\t\t\t\t})\n\t\t\t\tuser[updateField] = user[updateField].filter(userGameId => userGameId !== gameId)\n\t\t\t}\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n\n/**\n * Updates specified user\n * @param {String} userId\n * @param {Object} userUpdates\n * @param {Function} successCallback\n */\nexport function userCacheUserUpdate(userId, userUpdates, successCallback) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t\t.collection(COLLECTION_USERS).doc(userId)\n\t\tdispatch(userCacheUpdateWait())\n\t\ttry {\n\t\t\tconst doc = await ref.get() //TODO Possible unnescessary fetch, create user LAST UPDATE attribute,\n\t\t\t\t\t\t\t\t\t\t// to preserve data integrity\n\t\t\tconst user = {\n\t\t\t\t...doc.data(),\n\t\t\t\t...userUpdates\n\t\t\t}\n\t\t\tawait ref.update(user)\n\t\t\tdispatch(userCacheUpdate(userId, user))\n\t\t\tsuccessCallback(user)\n\t\t} catch (userUpdateError) {\n\t\t\tdispatch(userCacheUpdateError(userUpdateError))\n\t\t}\n\t}\n}\n/**\n * Creates specified user\n * @param {String} userId\n * @param {Object} user\n * @param {Function} successCallback\n */\nexport function userCacheUserCreate(userId, user, successCallback) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n \t\t\t.collection(COLLECTION_USERS).doc(userId)\n \t\tdispatch(userCacheUpdateWait())\n \t\ttry {\n \t\t\tawait ref.set(user)\n \t\t\tdispatch(userCacheUpdate(userId, user))\n \t\t\tsuccessCallback(user)\n \t\t} catch (userUpdateError) {\n \t\t\tdispatch(userCacheUpdateError(userUpdateError))\n \t\t}\n\t}\n}","export const COLLECTION_USERS = 'users'\nexport const COLLECTION_OFFERS = 'offers'\nexport const COLLECTION_GAMES = 'games'\nexport const COLLECTION_CHATS = 'chats'\nexport const COLLECTION_CLAUSES = 'clauses'\nexport const COLLECTION_MESSAGES = 'messages'","import React from 'react'\nimport {connect} from 'react-redux'\nimport {authShowModal} from '../actions/auth'\n\nfunction LoginButton({authShowModal}) {\n\treturn <button className=\"link\" onClick={authShowModal}>{'Login'}</button>\n}\nexport default connect(null, {authShowModal})(LoginButton) ","import firebase from 'firebase/app'\nimport 'firebase/auth'\nimport {\n\tAUTH_SHOW_MODAL,\n    AUTH_HIDE_MODAL,\n\tAUTH_SUBSCRIBE,\n    AUTH_LOGIN,\n    AUTH_LOGOUT,\n\tAUTH_LOGOUT_WAIT,\n\tAUTH_LOGOUT_ERROR\n} from '../constants/action-types'\nimport {\n\tuserCacheFetchUserByIdRequest\n} from './user-cache'\n\n//Actions\nexport function authShowModal() {\n    return {\n        type: AUTH_SHOW_MODAL\n    }\n}\nexport function authHideModal() {\n    return {\n        type: AUTH_HIDE_MODAL\n    }\n}\nfunction authSubscribe() {\n    return {\n        type: AUTH_SUBSCRIBE\n    }\n}\nfunction authLogin(authData) {\n    return {\n        type: AUTH_LOGIN,\n        payload: {authData}\n    }\n}\nfunction authLogout() {\n    return {\n        type: AUTH_LOGOUT\n    }\n}\nfunction authLogoutWait() {\n\treturn {\n\t\ttype: AUTH_LOGOUT_WAIT\n\t}\n}\nfunction authLogoutError(logoutError){\n\treturn {\n\t\ttype: AUTH_LOGOUT_ERROR,\n\t\tpayload: {\n\t\t\tlogoutError: logoutError,\n\t\t}\n\t}\n}\n\n//Thunks\n/**\n * Logouts user.\n */\nexport function authRequestLogout() {\n    return async dispatch => {\n\t\tdispatch(authLogoutWait())\n\t\ttry {\n\t\t\tawait firebase.auth().signOut()\n        \tdispatch(authLogout())    \n\t\t} catch (logoutError) {\n\t\t\tdispatch(authLogoutError(logoutError))\n\t\t}\n    }\n}\n/**\n * Adds authentication state observer\n */\nexport function authRequestSubscribe() {\n    return dispatch => {\n        //Subscribe to auth state change\n        firebase.auth().onAuthStateChanged(function(authData) {\n            if(authData) {\n                dispatch(authLogin(authData))\n\t\t\t\tdispatch(userCacheFetchUserByIdRequest(authData.uid))\n            } else {\n                dispatch(authLogout())\n            }\n        })\n        //self dispatch\n        dispatch(authSubscribe())\n    }\n}\n","import React from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport {\n\tPATH_PAGE_REGISTRATION,\n\tPATH_PAGE_PROFILE\n} from '../constants/paths'\n\nfunction HeaderProfileName({authData, unregistered, user=null}) {\n\tconst name = (user && user.name) || authData.displayName\n\tconst path = (unregistered \n\t\t? PATH_PAGE_REGISTRATION \n\t\t: PATH_PAGE_PROFILE.replace(':uid', authData.uid))\n\treturn (\n\t\t<Link to={path}>{name}</Link>\n\t)\n}\n\nconst mapStateToProps = ({auth, userCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tauthData: auth.authData,\n\t\tunregistered: userCache.users[userId] === null,\n\t\tuser: userCache.users[userId]\n\t}\n}\n\nexport default connect(mapStateToProps)(HeaderProfileName) ","export const PATH_TAB_LIST = 'list'\nexport const PATH_TAB_LOCATION = 'location'\n\nexport const PATH_PAGE_PROFILE = '/profile/:uid'\nexport const PATH_PAGE_SEARCH = '/search'\nexport const PATH_PAGE_OFFERS = '/offers/:userId'\nexport const PATH_PAGE_REGISTRATION = '/registration'\nexport const PATH_PAGE_GAME = '/game/:gameId'\nexport const PATH_PAGE_CHATS = '/chats'\nexport const PATH_PAGE_CHAT = '/chats/:chatId'","import React, {Fragment, useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {Redirect, useRouteMatch} from 'react-router-dom';\nimport {authRequestLogout, authRequestSubscribe} from '../actions/auth'\nimport {PATH_PAGE_REGISTRATION, PATH_PAGE_PROFILE} from '../constants/paths'\nimport LoginButton from './LoginButton'\nimport HeaderProfileName from './HeaderProfileName'\n\nfunction HeaderProfile({\n\tsubscribed,\n\tauthData,\n\tunregistered,\n\twait,\n\tauthRequestSubscribe,\n\tauthRequestLogout})\n{\n\tuseEffect(() => {\n\t\tif(!subscribed) { //Subscribe to auth change on firebase\n\t\t\tauthRequestSubscribe()\n\t\t}\n\t}, [subscribed, authRequestSubscribe])\n\tconst isRegisterirng = useRouteMatch(PATH_PAGE_REGISTRATION);\n\tif(wait) {//if pending authentication of fetching authorized user.\n\t\treturn 'Loading...'\n\t}\n\tif(unregistered && authData?.uid && !isRegisterirng) {\n\t\treturn <Redirect to={PATH_PAGE_REGISTRATION} />\n\t}\n\tif(!unregistered && authData?.uid && isRegisterirng) {\n\t\treturn <Redirect to={PATH_PAGE_PROFILE.replace(':uid', authData.uid)} />\n\t}\n\tif(authData) { //user is authenticated\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<HeaderProfileName />\n\t\t\t\t<button onClick={authRequestLogout}>Logout</button>\n\t\t\t</Fragment>\n\t\t)\n\t} \n\t//user not authenticated\n\treturn <LoginButton />\n}\nconst mapStateToProps = ({auth, userCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tsubscribed: auth.subscribed,\n\t\tauthData: auth.authData,\n\t\tunregistered: userCache.users[userId] === null,\n\t\twait: auth.wait || userCache.userByIdWait\n\t}\n}\nconst mapDispatchToProps = {\n\tauthRequestSubscribe,\n\tauthRequestLogout,\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderProfile)","import React, {Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport HeaderProfile from './HeaderProfile'\nimport {\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_CHATS,\n\tPATH_PAGE_OFFERS,\n} from '../constants/paths'\nfunction HeaderMenu({userId}) {\n\treturn (\n\t\t<Fragment>\n\t\t\t<nav>\n\t\t\t\t<Link to={PATH_PAGE_SEARCH}>\n\t\t\t\t\tFind games\n\t\t\t\t</Link>\n\t\t\t\t{userId && <Link to={PATH_PAGE_OFFERS.replace(':userId', userId)}>\n\t\t\t\t\tMy games\n\t\t\t\t</Link>}\n\t\t\t\t<Link to={PATH_PAGE_CHATS}>\n\t\t\t\t\tDeals\n\t\t\t\t</Link>\n\t\t\t</nav>\n\t\t\t<nav>\n\t\t\t\t<HeaderProfile/>\n\t\t\t</nav>\n\t\t</Fragment>\n\t)\n}\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData?.uid\n})\nexport default connect(mapStateToProps)(HeaderMenu)","import {useRouteMatch} from \"react-router-dom\";\nimport {\n\tPATH_PAGE_PROFILE,\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_OFFERS,\n\tPATH_PAGE_REGISTRATION,\n\tPATH_PAGE_GAME,\n\tPATH_PAGE_CHATS,\n\tPATH_PAGE_CHAT,\n} from '../constants/paths'\n\nfunction HeaderPage() {\n\tlet pageName = '';\n\tif(useRouteMatch(PATH_PAGE_PROFILE)) {\n\t\tpageName = 'Profile'\n\t}\n\tif(useRouteMatch(PATH_PAGE_SEARCH)) {\n\t\tpageName = 'Find games'\n\t}\n\tif(useRouteMatch(PATH_PAGE_OFFERS)) {\n\t\tpageName = 'Offers'\n\t}\n\tif(useRouteMatch(PATH_PAGE_REGISTRATION)) {\n\t\tpageName = 'Registration'\n\t}\n\tif(useRouteMatch(PATH_PAGE_GAME)) {\n\t\tpageName = 'Find games'\n\t}\n\tif(useRouteMatch(PATH_PAGE_CHATS)) {\n\t\tpageName = 'Deals'\n\t}\n\tif(useRouteMatch(PATH_PAGE_CHAT)) {\n\t\tpageName = 'Deals'\n\t}\n\treturn pageName\n}\nexport default HeaderPage","import React from 'react'\nimport styled from 'styled-components'\nconst BurgerButton = styled.button`\n\tcursor: pointer;\n\theight: 50px;\n\twidth: 60px;\n\tuser-select: none;\n\tbackground: none;\n\tcolor: inherit;\n\tborder: none;\n\tpadding: 0;\n\tfont: inherit;\n\toutline: inherit;\n\t@media (min-width: 768px) {\n\t\tdisplay: none;\n\t}\n`\nfunction Burger(props) {\n\treturn (\n\t\t<BurgerButton {...props} type=\"button\">\n\t\t\t<svg width=\"20\" height=\"14\" viewBox=\"0 0 20 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t<line x1=\"1\" y1=\"1\" x2=\"19\" y2=\"1\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n\t\t\t\t<line x1=\"1\" y1=\"7\" x2=\"19\" y2=\"7\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n\t\t\t\t<line x1=\"1\" y1=\"13\" x2=\"19\" y2=\"13\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n\t\t\t</svg>\n\t\t</BurgerButton>\n\t)\n}\nexport default Burger","import React, {useState, useEffect} from 'react'\nimport styled from 'styled-components'\nimport HeaderMenu from './HeaderMenu'\nimport HeaderPage from './HeaderPage'\nimport Burger from './Burger'\nconst HeaderContainer = styled.header`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tposition: relative;\n`\nconst HeaderLogo = styled.div`\n\tline-height: 50px;\n\twidth: 60px;\n`\nconst MenuContainer = styled.div`\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tflex-grow: 1;\n\t@media(max-width: 767px) {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tflex-direction: column;\n\t\ttop: 50px;\n\t\tright: 0;\n\t\tpadding: 0 10px;\n\t\tbackground-color: #13131D;\n\t\topacity: .9;\n\t\t${\n\t\t\t({isToggled}) => !isToggled &&`\n\t\t\t\tdisplay: none;\n\t\t\t`\n\t\t}\n\t\t> nav {\n\t\t\tdisplay: flex;\n\t\t\talign-items: flex-end;\n\t\t\tflex-direction: column;\n\t\t}\n\t}\n`\nconst HeaderPageContainer = styled.h1`\n\tmargin: 0;\n\tpadding: 0;\n\tline-height: 50px;\n\tfont-size: inherit;\n\tfont-weight: normal;\n\ttext-transform: uppercase;\n\t@media(min-width: 768px) {\n\t\tdisplay: none;\n\t}\n`\nfunction Header() {\n\tconst [isToggled, toggle] = useState(false)\n\tuseEffect(() => {\n\t\tfunction closeMenu() {\n\t\t\ttoggle(false)\n\t\t}\n\t\twindow.addEventListener('click', closeMenu)\n\t\treturn () => window.removeEventListener('click', closeMenu)\n\t}, [toggle])\n\tfunction onBurgerClick(e) {\n\t\te.stopPropagation()\n\t\ttoggle(!isToggled)\n\t}\n\treturn (\n\t\t<HeaderContainer>\n\t\t\t<HeaderLogo>U-D</HeaderLogo>\n\t\t\t<MenuContainer isToggled={isToggled}>\n\t\t\t\t<HeaderMenu/>\n\t\t\t</MenuContainer>\n\t\t\t<HeaderPageContainer>\n\t\t\t\t<HeaderPage/>\n\t\t\t</HeaderPageContainer>\n\t\t\t<Burger onClick = {onBurgerClick}/>\n\t\t</HeaderContainer>\n\t)\n}\n\nexport default Header","import React, {useEffect} from 'react'\nimport styled from 'styled-components'\n\nconst ModalMask = styled.div`\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\toverflow: auto;\n\tbackground-color: rgba(0, 0, 0, 0.8);\n\ttext-align: center;\n`\nconst ModalBody = styled.div`\n\tdisplay: inline-block;\n\tmargin: 2rem;\n`\n\nfunction Modal({closeCallback, children}) {\n\t//Fix body to prevent background scrolling;\n\tuseEffect(() => {\n\t\tif(window.scrollY) {\n\t\t\tdocument.body.style.top = `-${window.scrollY}px`\n\t\t}\n\t\tdocument.body.style.width = '100%'\n\t\tdocument.body.style.position = 'fixed'\n\t\t\n\t\treturn function() {\n\t\t\tconst top = document.body.style.top\n\t\t\tif(top) {\n\t\t\t\twindow.scrollTo(0, parseFloat(top.replace('-', '').replace('px', '')));\n\t\t\t\tdocument.body.style.top = ''\n\t\t\t}\n\t\t\tdocument.body.style.width = ''\n\t\t\tdocument.body.style.position = ''\n\t\t}\n\t})\n\t//Subscribe ESC close \n\tuseEffect(() => {\n\t\tfunction closeByEsc(e) {\n\t\t\t(e.key === \"Escape\") && closeCallback && closeCallback(e)\n\t\t}\n\t\tdocument.addEventListener('keyup', closeByEsc)\n\n\t\treturn function() {\n\t\t\tdocument.removeEventListener('keyup', closeByEsc)\n\t\t}\n\t})\n\n\t/**\n\t * Handles click event:\n\t *  if clicked on modal mask tries to close the modal\n\t * @param {Event} e click event\n\t */\n\tfunction maskClick(e) {\n\t\tif(closeCallback && e.target === e.currentTarget) {\n\t\t\tcloseCallback(e)\n\t\t}\n\t}\n\treturn (\n\t\t<ModalMask onClick={maskClick}>\n\t\t\t<ModalBody>{children}</ModalBody>\n\t\t</ModalMask>\n\t)\n}\n\nexport default Modal;","import React from 'react'\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport firebase from 'firebase/app'\nimport 'firebase/auth'\nimport styled from 'styled-components'\nimport * as firebaseui from 'firebaseui'\nimport {connect} from 'react-redux'\nimport Modal from '../common/Modal'\nimport {authHideModal} from '../actions/auth'\n// Configure FirebaseUI.\nconst uiConfig = {\n\t// Popup signin flow rather than redirect flow.\n    signInFlow: 'popup',\n\t// We will display Google and Email as auth providers.\n\tsignInOptions: [\n\t\tfirebase.auth.GoogleAuthProvider.PROVIDER_ID,\n\t\tfirebase.auth.EmailAuthProvider.PROVIDER_ID\n\t],\n\tcredentialHelper: firebaseui.auth.CredentialHelper.NONE,\n\tcallbacks: {\n\t\tsignInSuccessWithAuthResult() {\n\t\t\treturn false\n\t\t}\n\t}\n}\nconst AuthModalContainer = styled.div`\n\tcolor: unset;\n\t& input {\n\t\tcolor: unset;\n\t}\n`\n// Auth component\nfunction AuthModal({authHideModal}) {\n\treturn (\n\t\t<Modal closeCallback={authHideModal}>\n\t\t\t<AuthModalContainer>\n\t\t\t\t<StyledFirebaseAuth uiConfig={uiConfig} firebaseAuth={firebase.auth()} />\n\t\t\t</AuthModalContainer>\n\t\t</Modal>\n\t)\n}\n\nexport default connect(null, {authHideModal})(AuthModal)","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {COLLECTION_GAMES} from '../constants/collection-names'\nimport {\n\tGAME_CACHE_FETCH_BY_ID,\n\tGAME_CACHE_WAIT_BY_ID,\n\tGAME_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\n//Actions\nexport function gameCacheFetchById(gameId, game) {\n\treturn {\n\t\ttype: GAME_CACHE_FETCH_BY_ID,\n\t\tpayload: {\n\t\t\tgameId,\n\t\t\tgame\n\t\t}\n\t}\n}\nfunction gameCacheWaitById(gameId) {\n\treturn {\n\t\ttype: GAME_CACHE_WAIT_BY_ID,\n\t\tpayload: {gameId}\n\t}\n}\nfunction gameCacheErrorById(gameId, gameByIdError) {\n\treturn {\n\t\ttype: GAME_CACHE_ERROR_BY_ID,\n\t\tpayload: {gameId, gameByIdError}\n\t}\n}\n//Thunks\n/**\n * Fetches single game by Id,\n * @param {String} gameId id id datebase\n */\n export function gameCacheFetchByIdRequest(gameId) {\n \treturn async dispatch => {\n \t\tconst ref = firebase.firestore()\n \t\t\t.collection(COLLECTION_GAMES)\n \t\t\t.doc(gameId)\n \t\tdispatch(gameCacheWaitById(gameId))\n \t\ttry {\n\t\t\tconst doc = await ref.get()\n\t\t\tif(!doc.exists) {\n\t\t\t\tthrow new Error('Could not find game for gameId: ' + gameId)\n\t\t\t} \n \t\t\tdispatch(gameCacheFetchById(gameId, doc.data()))\n \t\t} catch(gameByIdError) {\n \t\t\tdispatch(gameCacheErrorById(gameId, gameByIdError))\n \t\t}\n \t}\n }\n/**\n * Fetches games that haven't beent fetched\n * @param {Object} \n */\n export function gameCacheFetchMissingGamesRequest(gameIds, games, gamesByIdWait) {\n \treturn async dispatch => {\n \t\t//TODO convert to single bulk dispatch and fetch\n \t\tgameIds.forEach(gameId => {\n \t\t\tif(!gamesByIdWait[gameId] && !games[gameId]) {\n \t\t\t\tdispatch(gameCacheFetchByIdRequest(gameId))\n \t\t\t}\n \t\t})\n \t}\n }","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tGAME_FINDER_SEARCH_PHRASE,\n\tGAME_FINDER_FETCH,\n\tGAME_FINDER_FETCH_WAIT,\n\tGAME_FINDER_FETCH_ERROR,\n\tGAME_FINDER_FETCH_CANCEL\n} from '../constants/action-types'\nimport {COLLECTION_GAMES} from '../constants/collection-names'\nimport {gameCacheFetchById} from './game-cache'\n//Actions\nexport function gameFinderSearchPhrase(searchPhrase) {\n\treturn {\n\t\ttype: GAME_FINDER_SEARCH_PHRASE,\n\t\tpayload: {searchPhrase}\n\t}\n}\nfunction gameFinderFetch(pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH,\n\t\tpayload: {pendingPromise}\n\t}\n}\nfunction gameFinderFetchWait(searchKey, pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH_WAIT,\n\t\tpayload: {searchKey, pendingPromise}\n\t}\n}\nfunction gameFinderFetchError(gamesFetchError, pendingPromise) {\n\treturn {\n\t\ttype: GAME_FINDER_FETCH_ERROR,\n\t\tpayload: {gamesFetchError, pendingPromise}\n\t}\n}\nexport function gameFinderFetchCancel() {\n\treturn {type: GAME_FINDER_FETCH_CANCEL}\n}\n//Thunks\n/**\n * Fetches list of games according to search string,\n * Should not be used for filtering games\n * @param {String} searchKey 2 chars key stored for each game\n */\nexport function gameFinderFetchRequest(searchKey) {\n\t/*TODO create game cache for finding games,\n\t\tso you won't get possibly enormous ammount of queries */\n\treturn async dispatch => {\n\t\tconst gamesQuery = firebase.firestore()\n\t\t\t.collection(COLLECTION_GAMES)\n\t\t\t.where('searchKeys', 'array-contains', searchKey)\n\t\tconst pendingPromise = gamesQuery.get()\n\t\tpendingPromise.then(\n\t\t\tquerySnapshot => {\n\t\t\t\tconst games = querySnapshot.docs.reduce((games, doc) => {\n\t\t\t\t\tgames[doc.id] = doc.data()\n\t\t\t\t\treturn games\n\t\t\t\t}, {})\n\t\t\t\tdispatch(gameFinderFetch(pendingPromise))\n\t\t\t\tfor(let gameId in games) {\n\t\t\t\t\tdispatch(gameCacheFetchById(gameId, games[gameId]))\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tgamesFetchError => {\n\t\t\t\tdispatch(gameFinderFetchError(gamesFetchError, pendingPromise))\n\t\t\t}\n\t\t)\n\t\tdispatch(gameFinderFetchWait(searchKey, pendingPromise))\n\t}\n}","import React from 'react'\nimport styled from 'styled-components'\nconst StyledInputContainer = styled.form`\n\tdisplay: flex;\n\theight: 50px;\n\tline-height: 50px;\n\tmargin: 16px 0;\n\tpadding-left: 15px;\n\tbackground-color: #191A24;\n\t${({readonly}) => readonly && `\n\t\tpadding-left: 0;\n\t\tbackground: none;\n\t`}\n\tposition: relative;\n`\nconst StyledInputIconContainer = styled.span`\n\twidth: 30px;\n\t> * {\n\t\tvertical-align: middle;\n\t}\n`\nconst StyledInputElement = styled.input`\n\tflex-grow: 1;\n\tbackground: none;\n\tborder: none;\n\toutline: none;\n\t::placeholder {\n\t\tcolor: #454651;;\n\t}\n`\nconst StyledInputButton = styled.button`\n\tmin-width: 50px;\n\tbackground: none;\n\tcolor: black;\n\tbackground-color: #FDE74C;\n\tborder: none;\n`\nfunction StyledInputIcon({icon}) {\n\tif(!icon) {\n\t\treturn null\n\t}\n\treturn <StyledInputIconContainer>{icon}</StyledInputIconContainer>\n}\nfunction StyledInputSubmit({submitLabel, readonly}) {\n\tif(!submitLabel || readonly) {\n\t\treturn null\n\t}\n\treturn(\n\t\t<StyledInputButton type='submit'>{submitLabel}</StyledInputButton>\n\t)\n}\nfunction StyledInput({\n\tvalue,\n\tonChange,\n\tonSubmit = (e) => e.preventDefault(),\n\tsubmitLabel = null,\n\ticon = null,\n\tplaceholder = 'type in value',\n\treadonly\n}) {\n\treturn (\n\t\t<StyledInputContainer\tonSubmit={e => {\n\t\t\te.preventDefault()\n\t\t\tonSubmit && !readonly && onSubmit(value)\n\t\t}}\n\t\t\t\t\t\t\t\treadonly={readonly}>\n\t\t\t<StyledInputIcon icon={icon}/>\n\t\t\t<StyledInputElement\ttype=\"text\"\n\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\tonChange={e => onChange(e.target.value)}\n\t\t\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\t\t\treadonly={readonly}/>\n\t\t\t<StyledInputSubmit submitLabel={submitLabel} readonly={readonly}/>\n\t\t</StyledInputContainer>\n\t)\n}\n\nexport default StyledInput","import React from 'react'\nexport default () => (\n\t<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<circle cx=\"7.91625\" cy=\"7.91625\" r=\"6.91625\" stroke=\"currentColor\" strokeWidth=\"2\"/>\n\t\t<line x1=\"12.8382\" y1=\"13.5681\" x2=\"17.8559\" y2=\"18.5858\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n\t</svg>\n)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tgameFinderSearchPhrase,\n\tgameFinderFetchRequest,\n\tgameFinderFetchCancel\n} from '../actions/game-finder'\nimport StyledInput from '../common/StyledInput'\nimport IconSearch from '../common/Icons/IconSearch'\nfunction GameFinderInput ({\n\tsearchPhrase,\n\tsearchKey,\n\tonGameFinderSearchPhrase,\n\tonGameFinderFetchRequest,\n\tonGameFinderFetchCancel\n}) {\n\tfunction onSearchPhraseChange(searchPhrase) {\n\t\tconst currentSearchKey = searchPhrase.toLowerCase().trim().substring(0,2)\n\n\t\tif((currentSearchKey.length < 2) && searchKey) {\n\t\t\tonGameFinderFetchCancel()\n\t\t} else if ((currentSearchKey.length === 2) && (currentSearchKey !== searchKey)) {\n\t\t\tonGameFinderFetchRequest(currentSearchKey)\n\t\t}\n\t\tonGameFinderSearchPhrase(searchPhrase)\n\t}\n\treturn (\n\t\t<StyledInput\tvalue={searchPhrase}\n\t\t\t\t\t\tplaceholder=\"start typing game name\"\n\t\t\t\t\t\tonChange={onSearchPhraseChange}\n\t\t\t\t\t\ticon={<IconSearch />}/>\n\t)\n}\n\n\nconst mapStateToProps = ({gameFinder}) => ({\n\tsearchPhrase: gameFinder.searchPhrase,\n\tsearchKey: gameFinder.searchKey\n})\nconst mapDispatchToProps = (dispatch) => ({\n\tonGameFinderSearchPhrase(searchPhrase) {\n\t\tdispatch(gameFinderSearchPhrase(searchPhrase))\n\t},\n\tonGameFinderFetchRequest(searchKey) {\n\t\tdispatch(gameFinderFetchRequest(searchKey))\n\t},\n\tonGameFinderFetchCancel() {\n\t\tdispatch(gameFinderFetchCancel())\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GameFinderInput)","import React from 'react'\nimport styled from 'styled-components'\n\nconst WaitContainer = styled.span`\n\tdisplay: inline-flex;\n\theight: 100%;\n\twidth: 100%;\n`\nconst WaitContents = styled.span`\n\tmargin: auto;\n`\nfunction StyledWait() {\n\treturn <WaitContainer><WaitContents>Loading...</WaitContents></WaitContainer>\n}\nexport default StyledWait","import React from 'react'\nimport styled from 'styled-components'\n\nconst ErrorContainer = styled.span`\n\tdisplay: inline-flex;\n\theight: 100%;\n\twidth: 100%;\n`\nconst ErrorContents = styled.pre`\n\tpadding: 10px;\t\n`\nfunction StyledError({error}) {\n\tconst errorText = (error && error.toString && error.toString()) || error || 'Error happened'\n\treturn (\n\t\t<ErrorContainer>\n\t\t\t<ErrorContents>{errorText}</ErrorContents>\n\t\t</ErrorContainer>\n\t)\n}\nexport default StyledError","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {gameCacheFetchByIdRequest} from '../actions/game-cache'\nimport StyledWait from '../common/StyledWait'\nimport StyledError from '../common/StyledError'\nfunction GameLoader({\n\tgameId,\n\tComponent,\n\tCompoenentWait = StyledWait,\n\tComponentError = StyledError,\n\tgame,\n\tfetchWait,\n\tfetchError,\n\tfetchById,\n\t...props\n}) {\n\tuseEffect(() => {\n\t\tif(!game && !fetchWait && !fetchError) {\n\t\t\tfetchById(gameId)\n\t\t}\n\t}, [gameId, game, fetchWait, fetchError, fetchById])\n\tif(fetchError) {\n\t\treturn <ComponentError gameId={gameId} error={fetchError}/>\n\t}\n\tif(game) {\n\t\treturn <Component gameId={gameId} game={game} {...props} />\n\t}\n\treturn <CompoenentWait gameId={gameId}/>\n}\n\nconst mapStateToProps = ({gameCache}, {gameId}) => ({\n\tgame: gameCache.games[gameId],\n\twait: gameCache.gamesByIdWait[gameId],\n\terror: gameCache.gamesByIdError[gameId]\n})\n\nconst mapDispatchToProps = dispatch => ({\n\tfetchById(gameId) {\n\t\tdispatch(gameCacheFetchByIdRequest(gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(GameLoader)","import React from 'react'\nimport styled from 'styled-components'\nconst Tile = styled.div`\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tflex-shrink: 0;\n\tbackground-color: #154ea3;\n\tborder #3b64b1 solid 2px;\n\tborder-radius: 3px;\n\tcolor: white;\n\ttext-align: left;\n\tfont-size: 12px;\n\theight: 88px;\n\twidth: 66px;\n\t${({isBig}) => isBig && `\n\t\theight: 264px;\n\t\twidth: 198px;\n\t\tborder-width: 4px;\n\t\tborder-radius: 6px;\n\t\tfont-size: 16px;\n\t`}\n`\nconst GameImg = styled.img`\n\tdisplay: block;\n\tborder-top: 1px solid white;\n\tbackground-color: black;\n\tpadding-bottom: 10%;\n\twidth: 100%;\n\ttext-align: center;\n`\nconst GameIcon = styled.div`\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n`\nfunction GameTile({game, isBig, onClick}) {\n\treturn (\n\t\t<Tile isBig={isBig} onClick={onClick}>\n\t\t\t<div>{game.platform}</div>\n\t\t\t{game.pic && <GameImg src={game.pic} alt={game.name}/>}\n\t\t\t{game.icon && <GameIcon>{game.icon}</GameIcon>}\n\t\t</Tile>\n\t)\n}\nexport default GameTile","import React from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheAddUserGameRequest} from '../actions/user-cache'\nimport {offersAddHideModal} from '../actions/offers-add'\nimport GameLoader from '../containers/GameLoader'\nimport GameTile from './GameTile'\n\nfunction OffersAddSuggestion({ gameId, userId, onUserCacheAddUserGameRequest}) {\n\tconst onClick = () => {\n\t\tonUserCacheAddUserGameRequest(userId, gameId, false)\n\t}\n\treturn (\n\t\t<div className=\"offers-add-suggestion\">\n\t\t\t<GameLoader gameId={gameId} Component={GameTile} onClick={onClick}/>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({auth, userCache}) => ({\n\tuserId: auth.authData && auth.authData.uid,\n\tuser: userCache[auth.authData && auth.authData.uid]\n})\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheAddUserGameRequest(userId, gameId, isDemand) {\n\t\tdispatch(userCacheAddUserGameRequest(userId, gameId, isDemand))\n\t\tdispatch(offersAddHideModal())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAddSuggestion) ","import {\n    OFFERS_ADD_SHOW_MODAL,\n    OFFERS_ADD_HIDE_MODAL\n} from '../constants/action-types'\n\n//Actions\nexport function offersAddShowModal(user) {\n\treturn {\n\t\ttype: OFFERS_ADD_SHOW_MODAL,\n\t\tpayload: {user}\n\t}\n}\nexport function offersAddHideModal() {\n\treturn {\n\t\ttype: OFFERS_ADD_HIDE_MODAL\n\t}\n}","import React from 'react'\nimport {connect} from 'react-redux'\nimport OffersAddSuggestion from './offers-add-suggestion.js'\n\nfunction GameFinderOffers ({games}) {\n\tlet rederedResults = []\n\tfor (let gameId in games) {\n\t\trederedResults.push(<OffersAddSuggestion \n\t\t\tgameId={gameId}\n\t\t\tgame={games[gameId]}\n\t\t\tkey={gameId}/>)\n\t}\n\treturn rederedResults\n}\n//TODO same in game-finder results\nconst mapStateToProps = ({gameCache, gameFinder}) => {\n\tlet filteredGames = {}\n\tconst searchPhrase = gameFinder.searchPhrase.toLowerCase()\n\tfor (let gameId in gameCache.games) {\n\t\tlet game = gameCache.games[gameId]\n\t\tlet isSuitable = game.tags.some((tag) => {\n\t\t\treturn tag.toLowerCase().indexOf(searchPhrase) === 0\n\t\t})\n\t\tif(isSuitable) {\n\t\t\tfilteredGames[gameId] = game\n\t\t}\t\n\t}\n\treturn {\n\t\tgames: filteredGames\n\t}\n}\n\nexport default connect(mapStateToProps)(GameFinderOffers)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Modal from '../common/Modal'\nimport {offersAddHideModal} from '../actions/offers-add'\nimport GameFinderInput from './GameFinderInput'\nimport GameFinderOffers from './GameFinderOffers'\n\nconst style = {\n\t'backgroundColor': 'white',\n\t'minHeight': '400px',\n\t'width': '700px',\n\t'padding': '12px',\n\t'textAlign': 'initial'\n}\n\nfunction OffersAddModal({onOffersAddHideModal}) {\n\tconst renderCallback = () => (\n\t\t<div style={style}>\n\t\t\t<h3>Offer a game</h3>\n\t\t\t<select>\n\t\t\t\t<option>PS4</option>\n\t\t\t\t<option>XBOX</option>\n\t\t\t</select>\n\t\t\t<GameFinderInput />\n\t\t\t<div>\n\t\t\t\t<GameFinderOffers />\n\t\t\t</div>\n\t\t</div>\n\t)\n\t\n\treturn (\n\t\t<Modal renderCallback={renderCallback} closeCallback={onOffersAddHideModal}/>\n\t)\n}\n\nconst mapStateToProps = state => ({})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersAddHideModal(){\n\t\tdispatch(offersAddHideModal())\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAddModal)","import React from 'react';\nimport {connect} from 'react-redux'\n\nimport AuthModal from '../components/AuthModal'\nimport OffersAddModal from '../components/offers-add-modal'\n\nclass Modals extends React.PureComponent {\n\trender() {\n\t\tif (this.props.authModalShown) {\n\t\t\treturn <AuthModal />\n\t\t} else if (this.props.offersAddModalShown) {\n\t\t\treturn <OffersAddModal />\n\t\t}\n\t\treturn null\n\t}\n}\n\nconst mapStateToProps = ({auth, offersAdd}) => ({\n\tauthModalShown: auth.authModalShown,\n\toffersAddModalShown: offersAdd.modalShown\n})\nexport default connect(mapStateToProps)(Modals)","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tCHAT_CACHE_FETCH_BY_PARTICIPANT, //TODO rename all actions to user FETCH_BY_SOMTH\n\tCHAT_CACHE_WAIT_BY_PARTICIPANT,\n\tCHAT_CACHE_ERROR_BY_PARTICIPANT,\n\tCHAT_CACHE_ADD_PUSH,\n\tCHAT_CACHE_ADD_WAIT,\n\tCHAT_CACHE_ADD_ERROR,\n\tCHAT_CACHE_LAST_MESSAGE_FETCH,\n\tCHAT_CACHE_FETCH_BY_ID,\n\tCHAT_CACHE_WAIT_BY_ID,\n\tCHAT_CACHE_ERROR_BY_ID\n} from '../constants/action-types'\nimport {\n\tCOLLECTION_CHATS,\n\tCOLLECTION_MESSAGES\n} from '../constants/collection-names'\n//Actions\nfunction chatCacheFetchByParticipant(participantId, chats) {\n\treturn {\n\t\ttype: CHAT_CACHE_FETCH_BY_PARTICIPANT,\n\t\tpayload: {participantId, chats}\n\t}\n}\nfunction chatCacheWaitByParticipant(participantId) {\n\treturn {\n\t\ttype: CHAT_CACHE_WAIT_BY_PARTICIPANT,\n\t\tpayload: {participantId}\n\t}\n}\nfunction chatCacheErrorByParticipant(participantId, chatsByParticipantError) {\n\treturn {\n\t\ttype: CHAT_CACHE_ERROR_BY_PARTICIPANT,\n\t\tpayload: {participantId, chatsByParticipantError}\n\t}\n}\nfunction chatCacheAddPush(chatId, chat) {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_PUSH,\n\t\tpayload: {chatId, chat}\n\t}\n}\nfunction chatCacheAddWait() {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_WAIT\n\t}\n}\nfunction chatCacheAddError(addError) {\n\treturn {\n\t\ttype: CHAT_CACHE_ADD_ERROR,\n\t\tpayload: {addError}\n\t}\n}\nexport function chatCacheFetchLastMessage(message) {\n\treturn {\n\t\ttype: CHAT_CACHE_LAST_MESSAGE_FETCH,\n\t\tpayload: {chatId: message.chatId, message}\n\t}\n}\nfunction chatCacheFetchById(chatId, chat) {\n\treturn {\n\t\ttype: CHAT_CACHE_FETCH_BY_ID,\n\t\tpayload: {chatId, chat}\n\t}\n}\nfunction chatCacheWaitById(chatId) {\n\treturn {\n\t\ttype: CHAT_CACHE_WAIT_BY_ID,\n\t\tpayload: {chatId}\n\t}\n}\nfunction chatCacheErrorById(chatId, fetchError) {\n\treturn {\n\t\ttype: CHAT_CACHE_ERROR_BY_ID,\n\t\tpayload: {chatId, fetchError}\n\t}\n}\n//Thunks\n/**\n * Fetches all chats for specified User\n * @param {String} participantId user id of any participant in chat\n */\nexport function chatCacheFetchByParticipantRequest(participantId) {\n\treturn async dispatch => {\n\t\t//TODO triggered multiple times\n\t\tconst query = firebase.firestore().collection(COLLECTION_CHATS)\n\t\t\t.where('participantIds', 'array-contains', participantId)\n\t\tdispatch(chatCacheWaitByParticipant(participantId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst chats = querySnapshot.docs.reduce((chats, doc) => {\n\t\t\t\tchats[doc.id] = doc.data()\n\t\t\t\treturn chats\n\t\t\t}, {})\n\t\t\tdispatch(chatCacheFetchByParticipant(participantId, chats))\n\t\t} catch(chatsByParticipantError) {\n\t\t\tdispatch(chatCacheErrorByParticipant(participantId, chatsByParticipantError))\n\t\t}\n\t}\n}\n/**\n * Fetches single chat object\n * @param {string} chatId \n */\nexport function chatCacheFetcByIdRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore()\n\t\t.collection(COLLECTION_CHATS)\n\t\t.doc(chatId)\n\t\tdispatch(chatCacheWaitById(chatId))\n\t\ttry {\n\t\t\tconst doc = await ref.get()\n\t\t\tdispatch(chatCacheFetchById(chatId, doc.data()))\n\t\t} catch (fetchError) {\n\t\t\tdispatch(chatCacheErrorById(chatId, fetchError))\n\t\t}\n\t}\n}\n/**\n * Creates new chat in chats collection\n * @param {Array} participantIds\n */\nexport function chatCacheAddRequest(participantIds, successCallback) {\n\treturn async dispatch => {\n\t\tconst chat = {participantIds}\n\t\tdispatch(chatCacheAddWait())\n\t\ttry {\n\t\t\tconst chatRef = await firebase.firestore()\n\t\t\t\t.collection(COLLECTION_CHATS).add(chat)\n\t\t\tdispatch(chatCacheAddPush(chatRef.id, chat))\n\t\t\tif(typeof(successCallback) === 'function') {\n\t\t\t\tsuccessCallback(chatRef.id)\n\t\t\t}\n\t\t} catch(addError) {\n\t\t\tdispatch(chatCacheAddError(addError))\n\t\t}\n\t}\n}\n/**\n * Fetches last message for chat\n */\nexport function chatCacheFetchLastMessageRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_MESSAGES)\n\t\t.where('chatId', '==', chatId)\n\t\t.orderBy('sendDate', 'desc')\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst doc = querySnapshot.docs[0]\n\t\t\t\tdispatch(chatCacheFetchLastMessage(chatId, doc && doc.data()))\n\n\t\t} catch (fetchLastMessageError) {\n\t\t\tdispatch(chatCacheFetchLastMessage(chatId, null))\n\t\t\tthrow fetchLastMessageError\n\t\t}\n\t}\n}","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tMESSAGE_CACHE_FETCH,\n\tMESSAGE_CACHE_FETCH_WAIT,\n\tMESSAGE_CACHE_FETCH_ERROR,\n\tMESSAGE_CACHE_UPDATE,\n\tMESSAGE_CACHE_UPDATE_CONFIRM,\n\tMESSAGE_CACHE_SUBSCRITION\n} from '../constants/action-types'\nimport {COLLECTION_MESSAGES} from '../constants/collection-names'\nimport {chatCacheFetchLastMessage} from './chat-cache'\n//Actions\nfunction messageCacheFetch(messages) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH,\n\t\tpayload: {\n\t\t\tmessages\n\t\t}\n\t}\n}\nfunction messageCacheFetchWait() {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH_WAIT\n\t}\n}\nfunction messageCacheFetchError(fetchError) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_FETCH_ERROR,\n\t\tpayload: {\n\t\t\tfetchError\n\t\t}\n\t}\n}\nfunction messageCacheUpdate(outdatedMessageId, updatedMessage) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_UPDATE,\n\t\tpayload: {\n\t\t\toutdatedMessageId,\n\t\t\tupdatedMessage\n\t\t}\n\t}\n}\nfunction messageCacheUpdateConfirm(confirmedMessageId) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_UPDATE_CONFIRM,\n\t\tpayload: {\n\t\t\tconfirmedMessageId\n\t\t}\n\t}\n}\nfunction messageCacheSubscribe(messagesUnsubscribe) {\n\treturn {\n\t\ttype: MESSAGE_CACHE_SUBSCRITION,\n\t\tpayload: {\n\t\t\tmessagesUnsubscribe\n\t\t}\n\t}\n}\nexport function messageCacheUnsubscribe(messagesUnsubscribe) {\n\tmessagesUnsubscribe()\n\treturn {\n\t\ttype: MESSAGE_CACHE_SUBSCRITION,\n\t\tpayload: {\n\t\t\tmessagesUnsubscribe: null\n\t\t}\n\t}\n}\n//Thunks\n/**\n * Fetches last 100 messages for specified chat\n * @param {String} chatId \n */\nexport function messageCacheFetchRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_MESSAGES)\n\t\t\t.where('chatId','==', chatId)\n\t\t\t.orderBy('sendDate')\n\t\t\t.limit(100)\n\t\tdispatch(messageCacheFetchWait())\n\t\ttry {\n\t\t\tconst queyrSnapshot = await  query.get()\n\t\t\tconst messages = queyrSnapshot.docs.map(doc => {\n\t\t\t\tconst fetchedMessage = doc.data()\n\t\t\t\treturn {\n\t\t\t\t\t...fetchedMessage,\n\t\t\t\t\tsendDate: fetchedMessage.sendDate.toDate(),\n\t\t\t\t\tupdateDate: fetchedMessage.updateDate.toDate(),\n\t\t\t\t\tid: doc.id,\n\t\t\t\t\tisUpdating: doc.metadata.hasPendingWrites\n\t\t\t\t}\n\t\t\t})\n\t\t\tdispatch(messageCacheFetch(messages))\n\t\t} catch(fetchError) {\n\t\t\tdispatch(messageCacheFetchError(fetchError))\n\t\t\tthrow fetchError\n\t\t}\n\t}\n}\n/**\n * Adds message to specified chat.\n * After sending message should be updated via subscription messageCacheSubscribeRequest()\n * @param {String} chatId\n * @param {String} text Message body\n * @param {String} authorId User can add messages as self\n */\nexport function messageCacheSendMessageRequest(chatId, text, authorId, recipientId) {\n\treturn async dispatch => {\n\t\tconst messageRef = firebase.firestore().collection(COLLECTION_MESSAGES ).doc()\n\t\tconst message = {\n\t\t\tchatId,\n\t\t\ttext,\n\t\t\tauthorId,\n\t\t\trecipientId,\n\t\t\tsendDate: firebase.firestore.FieldValue.serverTimestamp(),\n\t\t\tupdateDate: firebase.firestore.FieldValue.serverTimestamp()\n\t\t}\n\t\tdispatch(messageCacheUpdate(null, {\n\t\t\tid: messageRef.id,\n\t\t\t...message,\n\t\t\tisUpdating: true\n\t\t}))\n\t\ttry {\n\t\t\tawait messageRef.set(message)\n\t\t\tdispatch(messageCacheUpdateConfirm(messageRef.id))\n\t\t} catch (sendError) {\n\t\t\tdispatch(messageCacheUpdate(messageRef.id, {\n\t\t\t\tid: messageRef.id,\n\t\t\t\t...message,\n\t\t\t\tsendError\n\t\t\t})) //TODO save to local storage, check date value\n\t\t\tthrow sendError\n\t\t}\n\t}\n}\n/**\n * Sets subscription for specified chat.\n * Updates single message each time it appers updated in database.\n * Dont forget to unsubscribe on chat leave!\n * @param {String} userId \n */\nexport function messageCacheSubscribeRequest(userId) {\n\treturn dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_MESSAGES)\n\t\t\t\t.where('recipientId', '==', userId)\n\t\t\t\t.where('updateDate', '>', new Date())\n\t\tconst messagesUnsubscribe = query.onSnapshot(\n\t\t\t\tquerySnapshot => {\n\t\t\t\t\tquerySnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tconst fetchedMessage = change.doc.data()\n\t\t\t\t\t\tdispatch(messageCacheUpdate(\n\t\t\t\t\t\t\t\tchange.doc.id,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: change.doc.id,\n\t\t\t\t\t\t\t\t\t...fetchedMessage,\n\t\t\t\t\t\t\t\t\tsendDate: fetchedMessage.sendDate.toDate(),\n\t\t\t\t\t\t\t\t\tupdateDate: fetchedMessage.updateDate.toDate(),\n\t\t\t\t\t\t\t\t\tisUpdating: change.doc.metadata.hasPendingWrites\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tdispatch(chatCacheFetchLastMessage(change.doc.data()))\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tupdateError => {\n\t\t\t\t\tthrow updateError\n\t\t\t\t}\n\t\t\t)\n\t\tdispatch(messageCacheSubscribe(messagesUnsubscribe))\n\t}\n}","import {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tmessageCacheSubscribeRequest,\n\tmessageCacheUnsubscribe\n} from '../actions/message-cache'\n\nfunction SubscriptionMessages ({userId, messagesUnsubscribe, onMessagesSubscribe, onMessagesUnsubscribe}) {\n\tuseEffect(() => {\n\t\tif(userId && !messagesUnsubscribe) {\n\t\t\tonMessagesSubscribe(userId)\n\t\t}\n\t\tif(!userId && messagesUnsubscribe) {\n\t\t\tonMessagesUnsubscribe(messagesUnsubscribe)\n\t\t}\n\t})\n\treturn null\n}\nconst mapStateToProps = ({auth, messageCache}) => {\n\treturn {\n\tuserId: auth.authData && auth.authData.uid,\n\tmessagesUnsubscribe: messageCache.messagesUnsubscribe\n}}\nconst mapDispatchToProps = dispatch => ({\n\tonMessagesSubscribe(userId) { //TODO create global subscribe\n\t\tdispatch(messageCacheSubscribeRequest(userId))\n\t},\n\tonMessagesUnsubscribe(messagesUnsubscribe) {\n\t\tdispatch(messageCacheUnsubscribe(messagesUnsubscribe))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SubscriptionMessages)","import React from 'react'\nimport {Link} from 'react-router-dom'\nimport styled from 'styled-components'\nimport {\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_CHATS\n} from '../constants/paths'\nconst FooterContainer = styled.footer`\n\tmargin: 20px;\n\tpadding: 12px 0;\n\tborder-top: 1px solid #454651;\n\tfont-size: 12px;\n\tline-height: 24px;\n\ttext-align: center;\n\ttext-transform: uppercase;\n\tgrid-row-start: 3;\n  \tgrid-row-end: 4;\n`\nconst FooterCopyryight = styled.div`\n\tmargin-top: 12px;\n\tline-height: 12px;\n\tcolor:#5F606C;\n\ttext-transform: none;\n`\nfunction Footer() {\n\treturn (\n\t\t<FooterContainer>\n\t\t\t<div>\n\t\t\t\t<Link to={PATH_PAGE_SEARCH}>Find games</Link>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<Link to={PATH_PAGE_CHATS}>Deals</Link>\n\t\t\t</div>\n\t\t\t<FooterCopyryight>\n\t\t\t\tUnpacked 2020. All rights reserved.\n\t\t\t</FooterCopyryight>\n\t\t</FooterContainer>\n\t)\n}\nexport default Footer;","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheFetchByOfferRequest} from '../actions/user-cache'\n\nfunction OffersCounter ({gameId, userCount, wait, error, fetched, onUserCacheFetchByOfferRequest}) {\n\tuseEffect(() => {\n\t\tif(!wait && !fetched) {\n\t\t\tonUserCacheFetchByOfferRequest(gameId)\n\t\t}\n\t}, [gameId, wait, fetched, onUserCacheFetchByOfferRequest])\n\tif(wait) {\n\t\treturn <span>Wait ...</span>\n\t} else if (error) {\n\t\treturn <span>{error.toString()}</span>\n\t} else if (!fetched) {\n\t\treturn false\n\t} else {\n\t\treturn userCount\n\t}\n}\n\nconst mapStateToProps = ({userCache}, {gameId}) => {\n\tconst userCount = Object.values(userCache.users)\n\t\t.filter(user => user && user.offerIds && user.offerIds.indexOf(gameId) >= 0).length\n\treturn {\n\t\tuserCount,\n\t\twait: userCache.usersByOfferWait[gameId],\n\t\terror: userCache.usersByOfferError[gameId],\n\t\tfetched: userCache.usersByOfferFetched[gameId]\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchByOfferRequest(gameId) {\n\t\tdispatch(userCacheFetchByOfferRequest(gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersCounter)","import React, {Fragment} from 'react'\nimport styled from 'styled-components'\nimport {Link} from 'react-router-dom'\nimport {PATH_PAGE_GAME} from '../constants/paths'\nimport GameLoader from '../containers/GameLoader'\nimport GameTile from './GameTile'\nimport OffersCounter from './OffersCounter'\nconst GameFinderResultContainer = styled.div`\n\tborder: 1px solid #5F606C;\n\theight: 88px;\n\tmargin: 10px 0;\n\tpadding: 20px;\n\tdisplay: flex;\n`\nconst GameInfo = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex-grow: 1;\n\tcolor: #5F606C;\n\tpadding-left: 20px;\n`\nconst GameInfoName = styled.div`\n\tcolor: white;\n\tflex-grow: 1;\n`\nfunction GameRow({gameId, game}) {\n\treturn (\n\t\t<Fragment>\n\t\t\t<GameTile game={game}/>\n\t\t\t<GameInfo>\n\t\t\t\t<GameInfoName>{game.name}</GameInfoName>\n\t\t\t\t<div>{game.platform}</div>\n\t\t\t\t<div>Offers found: <OffersCounter gameId={gameId}/></div>\n\t\t\t</GameInfo>\n\t\t</Fragment>\n\t)\n}\nfunction GameFinderResult ({gameId}) {\n\treturn (<Link to={PATH_PAGE_GAME.replace(':gameId', gameId)}>\n\t\t\t<GameFinderResultContainer>\n\t\t\t\t<GameLoader gameId={gameId} Component={GameRow}/>\n\t\t\t</GameFinderResultContainer>\n\t\t</Link>)\n}\n\nexport default GameFinderResult","import React from 'react'\nimport GameFinderResult from './GameFinderResult'\nfunction GameFinderResults ({games}) {\n\tlet rederedResults = []\n\tfor (let gameId in games) {\n\t\trederedResults.push(<GameFinderResult \n\t\t\tgameId={gameId}\n\t\t\tgame={games[gameId]}\n\t\t\tkey={gameId}/>)\n\t}\n\treturn rederedResults\n}\n\nexport default GameFinderResults","import React, {Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport Footer from '../components/Footer'\nimport GameFinderInput from '../components/GameFinderInput'\nimport GameFinderResults from '../components/GameFinderResults'\nconst PageContents = styled.div`\n\tpadding: 0 20px;\n`\nfunction PageSearch ({games}) {\n\treturn (\n\t\t<Fragment>\n\t\t\t<PageContents>\n\t\t\t\t<GameFinderInput />\n\t\t\t\t<GameFinderResults games={games}/>\n\t\t\t</PageContents>\n\t\t\t<Footer/>\n\t\t</Fragment>\n\t)\n}\n\nconst mapStateToProps = ({gameCache, gameFinder}) => {\n\tlet filteredGames = {}\n\tconst searchPhrase = gameFinder.searchPhrase.toLowerCase()\n\tfor (let gameId in gameCache.games) {\n\t\tlet game = gameCache.games[gameId]\n\t\tlet isSuitable = game.tags.some((tag) => {\n\t\t\treturn tag.toLowerCase().indexOf(searchPhrase) === 0\n\t\t})\n\t\tif(isSuitable) {\n\t\t\tfilteredGames[gameId] = game\n\t\t}\t\n\t}\n\treturn {\n\t\tgames: filteredGames\n\t}\n}\n\nexport default connect(mapStateToProps)(PageSearch)","import React from 'react'\nimport {connect} from 'react-redux'\nimport GameTile from './GameTile'\nimport {offersAddShowModal} from '../actions/offers-add'\n\nfunction OffersAdd({onOffersAddShowModal}) {\n\tconst game = {\n\t\tplatform: 'platform',\n\t\tname: 'Add game',\n\t\ticon: '+',\n\t}\n\n\treturn <GameTile game={game} onClick={onOffersAddShowModal} />\n}\n\nconst mapStateToProps = state => ({})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersAddShowModal(user) {\n\t\tdispatch(offersAddShowModal(user))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OffersAdd)","import React from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheDeleteUserGameRequest} from '../actions/user-cache'\nimport GameLoader from '../containers/GameLoader'\nimport GameTile from './GameTile'\nfunction UserGame({gameId, ownerId, authUserId, onOffersDeleteRequest}) {\n\tconst deleteButton = (authUserId === ownerId\n\t\t? <button className=\"offer-delete\"\n\t\t\t\t\tonClick={() => onOffersDeleteRequest(ownerId, gameId)}>\n\t\t\t\t\t\t&times;\n\t\t\t</button> \n\t\t: '')\n\treturn (\n\t\t\t<div className=\"offer\">\n\t\t\t\t<GameLoader gameId={gameId} Component={GameTile} isBig/>\n\t\t\t\t{deleteButton}\n\t\t\t</div>\n\t\t)\n}\nconst mapStateToProps = ({auth}) => ({\n\tauthUserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = dispatch => ({\n\tonOffersDeleteRequest(userId, offerId) {\n\t\tdispatch(userCacheDeleteUserGameRequest(userId, offerId, false))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(UserGame)","import React from 'react'\nimport UserGame from './user-game'\n\nfunction UserGameList({gameIds, ownerId}) {\n\t\n\tif(gameIds && Object.values(gameIds > 0)) { //List not empty\n\t\tconst renderedOffers = []\n\t\t\tfor(let gameId of gameIds) {\n\t\t\trenderedOffers.push(<UserGame gameId={gameId} key={gameId} ownerId={ownerId}/>)\n\t\t}\n\t\treturn renderedOffers\n\t}\n\treturn <h3>Game list is empty...</h3>\n}\n\nexport default UserGameList","import React, {useEffect} from 'react'\nimport { connect } from 'react-redux'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache' \nimport {PATH_PAGE_OFFERS} from '../constants/paths'\nimport OffersAdd from '../components/OffersAdd'\nimport UserGameList from '../components/user-game-list'\n\nfunction PageOffers({history, match, authData, wait, user, onUserCacheFetchUserByIdRequest}) {\n\tuseEffect(() => {\n\t\tif(authData && match.params.userId) {\n\t\t\tonUserCacheFetchUserByIdRequest(match.params.userId)\n\t\t} else if (authData && !match.params.userId) {\n\t\t\thistory.push(PATH_PAGE_OFFERS.replace(':userId', authData.uid))\n\t\t}\n\t}, [authData, onUserCacheFetchUserByIdRequest, match.params.userId, history])\n\t\n\tif(wait) {\n\t\treturn (<div>Wait...</div>)\n\t} else if (user) {\n\t\tconst isSelf = match.params.userId === authData?.uid\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{isSelf && <OffersAdd />}\n\t\t\t\t<UserGameList gameIds={user.offerIds} ownerId={match.params.userId}/>\n\t\t\t</div>\n\t\t)\n\t} else {\n\t\treturn false\n\t}\n}\n\nconst mapStateToProps = ({auth, userCache}, {match}) => ({\n\tauthData: auth.authData,\n\twait: userCache.userByIdWait,\n\tuser: userCache.users[match.params.userId]\n\n})\nconst mapDispatchToProps = dispatch => ({\n\tonUserCacheFetchUserByIdRequest(userId) {\n\t\treturn dispatch(userCacheFetchUserByIdRequest(userId))\n\t} \n})\nexport default connect(mapStateToProps, mapDispatchToProps)(PageOffers)","import {\n\tUSER_UPDATE_UNSAVED,\n\tUSER_UPDATE_SAVED\n} from '../constants/action-types'\n\nimport {\n\tuserCacheUserUpdate,\n\tuserCacheUserCreate\n} from './user-cache'\n//Actions\nexport function userUpdateUnsaved(user) {\n\treturn {\n\t\ttype: USER_UPDATE_UNSAVED,\n\t\tpayload: {user}\n\t}\n}\nexport function userUpdateSaved(user) {\n\treturn {\n\t\ttype: USER_UPDATE_SAVED,\n\t\tpayload: {user}\n\t}\n}\n//Thunks\n/**\n * Saves user to database\n * @param {String} userId\n * @param {Object} updatedUser\n */\nexport function userUpdateSaveRequest(userId, updatedUser) {\n\treturn dispatch => {\n\t\tconst successCallback = updatedUser => dispatch(userUpdateSaved(updatedUser))\n\t\tdispatch(userCacheUserUpdate(userId, updatedUser, successCallback))\n\t}\n}\n/**\n * Creates user to database\n * @param {String} userId\n * @param {Object} user\n */\nexport function userUpdateCreateRequest(userId, user) {\n\treturn dispatch => {\n\t\tconst successCallback = user => dispatch(userUpdateSaved(user))\n\t\tdispatch(userCacheUserCreate(userId, user, successCallback))\n\t}\n}","import React from 'react'\nimport LoginButton from './LoginButton'\n\nfunction AskAuthenticate() {\n\treturn (\n\t\t<div>Please Authenticate <LoginButton /></div>\n\t)\n}\n\nexport default AskAuthenticate","import styled from 'styled-components'\nexport default styled.label`\n\tcolor: #5F606C;\n\t${({bright}) => bright && 'color: #fff;'}\n\tfont-size: 12px;\n\t${({bright}) => bright && 'font-size: 16px;'}\n\ttext-transform: uppercase;\n`","import React from 'react'\nimport styled from 'styled-components'\n\nconst CheckboxContainer = styled.div`\n  display: inline-block;\n  vertical-align: middle;\n  margin: 15px 0;\n`\n\nconst Icon = styled.svg`\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 2px;\n`\n// Hide checkbox visually but remain accessible to screen readers.\n// Source: https://polished.js.org/docs/#hidevisually\nconst HiddenCheckbox = styled.input`\n  border: 0;\n  clip: rect(0 0 0 0);\n  clippath: inset(50%);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n`\n\nconst StyledCheckboxDisplayer = styled.div`\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  background: ${props => (props.checked ? '#FDE74C' : ' #21222B')};\n  ${({readonly, checked}) => readonly && checked && `background: none;`}\n  color: ${({readonly}) => readonly ? '#FDE74C' : '#000' };\n  transition: all 150ms;\n\n  ${HiddenCheckbox}:focus + & {\n    box-shadow: 0 0 0 3px #292B36;\n  }\n\n  ${Icon} {\n    visibility: ${props => (props.checked ? 'visible' : 'hidden')}\n  }\n`\n\nconst StyledCheckbox = ({ className, checked, readonly, ...props }) => (\n  <CheckboxContainer className={className}>\n\t<HiddenCheckbox\ttype=\"checkbox\"\n\t\t\t\t\tchecked={checked}  \n\t\t\t\t\tdisabled={readonly}\n\t\t\t\t\t{...props} />\n    <StyledCheckboxDisplayer checked={checked} readonly={readonly}>\n      <Icon viewBox=\"0 0 24 24\">\n        <polyline points=\"20 6 9 17 4 12\" />\n      </Icon>\n    </StyledCheckboxDisplayer>\n  </CheckboxContainer>\n)\n\nexport default StyledCheckbox","import React from 'react'\nimport {Marker, Popup } from 'react-leaflet'\n\nexport default function MapMarker({position, contents}) {\n\treturn <Marker position={position}>\n\t\t<Popup className=\"point-popup\">{contents}</Popup>\n\t</Marker>\n}","import React, {useState, useEffect, useCallback, useRef} from 'react'\nimport {Map as LeafletMap, TileLayer} from 'react-leaflet'\nimport L from 'leaflet'\nimport MapMarker from './MapMarker'\nimport styled from 'styled-components'\n\nconst MapContainer = styled.div`\n\tposition: relative;\n\twidth: 100%;\n\theight: 100%;\n\topacity: 0.99;\n`\n\nfunction Map({points = []}) {\n\tconst [style, setStyle] = useState(null)\n\tconst containerRef = useRef(null)\n\tconst updateStyles = useCallback(containerEl => {\n\t\tif(containerEl) {\n\t\t\tsetStyle({\n\t\t\t\twidth: containerEl.offsetWidth,\n\t\t\t\theight: containerEl.offsetHeight,\n\t\t\t\tposition: 'absolute',\n\t\t\t})\n\t\t}\n\t}, [])\n\tconst getContainerRef = useCallback(containerEl => {\n\t\tupdateStyles(containerEl);\n\t\tcontainerRef.current = containerEl\n\t}, [updateStyles])\n\tuseEffect(() => {\n\t\tconst onResizeUpdate = () => {\n\t\t\tupdateStyles(containerRef.current)\n\t\t}\n\t\twindow.addEventListener('resize', onResizeUpdate)\n\t\t\n\t\treturn () => window.removeEventListener('resize', onResizeUpdate)\n\t}, [containerRef, updateStyles])\n\treturn (\n\t\t<MapContainer ref={getContainerRef}>\n\t\t\t<MapPane style={style} points={points} />\n\t\t</MapContainer>\n\t)\n}\nfunction MapPane({points, style}) {\n\tif(!points.length || !style) {\n\t\treturn null\n\t}\n\tconst center = points[0].position\n\tconst bounds = points.length > 1 ? getBounds(points) : null\n\treturn (\n\t\t<LeafletMap\tstyle={style}\n\t\t\tcenter={center}\n\t\t\tzoom={14}\n\t\t\tscrollWheelZoom={false}\n\t\t\tbounds={bounds}\n\t\t\tboundsOptions={{padding: [10, 10]}}\n\t\t>\n\t\t\t<TileLayer\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n\t\t\turl=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n\t\t\t/>\n\t\t\t<MapMarkers points={points} />\n\t\t</LeafletMap>\n\t)\n} \nfunction MapMarkers({points}) {\n\treturn points.map(point => <MapMarker key={point.id} {...point} />)\n}\nfunction getBounds(points) {\n\tconst markers = points.map(point => L.marker(point.position))\n\tconst markersGroup = new L.featureGroup(markers);\n\treturn markersGroup.getBounds()\n}\nexport default Map\n\n","import React, {useEffect} from 'react'\nimport styled from 'styled-components'\nconst ListContainer = styled.ul`\n\tposition: absolute;\n\tbackground-color: #13131D;\n\twidth: 100%;\n\tcolor: white;\n\topacity: .9;\n\tz-index: 1;\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0 20px;\n\ttop: 50px; \n\tleft: -20px;\n`\nconst ItemContainer = styled.li`\n\tcursor: pointer;\n\tline-height: 50px;\n\tpadding: 0 15px;\n\t&:hover {\n\t\tbackground-color: grey;\n\t}\n`\nfunction AddressLookupSuggestions({suggestions, onSelect}) {\n\tuseEffect(() => {\n\t\tfunction closeSuggestions() {\n\t\t\tonSelect(null)\n\t\t}\n\t\twindow.addEventListener('click', closeSuggestions)\n\t\treturn () => window.removeEventListener('click', closeSuggestions)\n\t},[onSelect])\n\tconst addressLookupSuggestions = suggestions.map( suggestion => (\n\t\t<ItemContainer\tkey={suggestion.place_id} \n\t\t\t\t\t\tsuggestion={suggestion}\n\t\t\t\t\t\tonClick={() => onSelect(suggestion)}\n\t\t>{suggestion.display_name}</ItemContainer>\n\t))\n\treturn (\n\t\t<ListContainer>\n\t\t\t{addressLookupSuggestions}\n\t\t</ListContainer>\n\t)\n}\n\nexport default AddressLookupSuggestions","import React, {useState} from 'react'\nimport styled from 'styled-components'\nimport AddressLookupSuggestions from './AddressLookupSuggestions'\nimport StyledInput from '../common/StyledInput'\nimport IconSearch from '../common/Icons/IconSearch'\nconst AddressLookupContainer = styled.div`\n\tposition: relative;\n`\nasync function getSuggestions(phrase) {\n\tconst query = ('https://nominatim.openstreetmap.org?osm_ids=[N]&format=json&limit=5&q=' \n\t\t\t+ encodeURI(phrase))\n\ttry {\n\t\tconst response = await fetch(query)\n\t\tconst suggestions = await response.json()\n\t\treturn [suggestions, phrase, null]\n\t} catch(error) {\n\t\treturn [[], phrase, error]\n\t}\n}\nconst actualPhrase = {phrase: ''}; //do I need to use memo?\nfunction AddressLookup({onLookup, address = '', readonly}) {\n\tconst [phrase, setPhrase] = useState(address)\n\tconst [suggestions, setSuggestions] = useState([])\n\tconst [error, setError] = useState(null)\n\tasync function showSuggestions(phrase) {\n\t\tsetSuggestions(null)\n\t\tactualPhrase.phrase = phrase\n\t\tconst [fetchedSuggestions, fetchedPhrase, error] = await getSuggestions(phrase)\n\t\tif(fetchedPhrase === actualPhrase.phrase) {\n\t\t\tsetSuggestions(fetchedSuggestions)\n\t\t\tsetError(error)\n\t\t}\n\t}\n\tfunction onSelect(suggestion) {\n\t\tsetSuggestions(null)\n\t\tif (suggestion) {\n\t\t\tsetPhrase(suggestion.display_name)\n\t\t\tonLookup(suggestion)\n\t\t}\n\t}\n\tconst renderedSuggestions = (!!suggestions \n\t\t&& <AddressLookupSuggestions suggestions={suggestions} onSelect={onSelect}/>)\n\treturn (\n\t\t<AddressLookupContainer>\n\t\t\t<StyledInput\tonSubmit={showSuggestions}\n\t\t\t\t\t\t\tvalue={phrase}\n\t\t\t\t\t\t\treadonly={readonly}\n\t\t\t\t\t\t\tplaceholder='Type in address'\n\t\t\t\t\t\t\tonChange={setPhrase}\n\t\t\t\t\t\t\tsubmitLabel={<IconSearch/>}/>\n\t\t\t{renderedSuggestions}\n\t\t\t{error}\n\t\t</AddressLookupContainer>\n\t)\n}\n\nexport default AddressLookup","import React from 'react';\nimport styled from 'styled-components'\nimport {connect} from 'react-redux'\nimport {userUpdateUnsaved} from '../actions/user-update'\nimport {PS4} from '../constants/platform-types'\nimport StyledLabel from '../common/StyledLabel'\nimport StyledInput from '../common/StyledInput'\nimport StyledCheckbox from '../common/StyledCheckbox'\nimport Map from '../common/Map/Map'\nimport AddressLookup  from './AddressLookup'\nconst MapContainer = styled.div`\n\tposition: relative;\n\theight: 250px;\n\n`\nconst ProfileFormContainer = styled.div`\n\tpadding: 0 20px;\n`\nfunction checkHasPlatform(updatedUser, platformType) {\n\treturn updatedUser?.platforms?.indexOf(platformType) >= 0\n}\nfunction ProfileForm({updatedUser, userUpdateUnsaved, readonly}) {\n\tif(!updatedUser) {\n\t\treturn null\n\t}\n\tfunction onNameChange(name) {\n\t\tuserUpdateUnsaved({\n\t\t\t...updatedUser,\n\t\t\tname,\n\t\t})\n\t}\n\tfunction onPlatformSelect(platformType) {\n\t\tif(checkHasPlatform(updatedUser, platformType)) {\n\t\t\tuserUpdateUnsaved({\n\t\t\t\t...updatedUser,\n\t\t\t\tplatforms: updatedUser.platforms.filter(userPlatfrom => userPlatfrom!==platformType)\n\t\t\t})\n\t\t\treturn\n\t\t}\n\t\tuserUpdateUnsaved({\n\t\t\t...updatedUser,\n\t\t\tplatforms: updatedUser?.platforms ? [...updatedUser.platforms, platformType] : [platformType]\n\t\t})\n\t}\n\tfunction onLocactionChange(suggestion) {\n\t\tdebugger;\n\t\tuserUpdateUnsaved({\n\t\t\t...updatedUser,\n\t\t\tplace: suggestion.display_name,\n\t\t\tlatitude: +suggestion.lat,\n\t\t\tlongitude: +suggestion.lon,\n\t\t})\n\t}\n\n\tconst positionDefined = (typeof(updatedUser.latitude)=== 'number' && typeof(updatedUser.longitude)=== 'number')\n\tconst contents = positionDefined ? updatedUser.name : 'Moscow'\n\tconst position = positionDefined ? [updatedUser.latitude, updatedUser.longitude ] : [55.7558, 37.6173]\n\treturn (\n\t\t<ProfileFormContainer>\n\t\t\t<StyledLabel>\n\t\t\t\tNickame:\n\t\t\t\t<StyledInput\tvalue={updatedUser.name || ''}\n\t\t\t\t\t\t\t\tonChange={onNameChange}\n\t\t\t\t\t\t\t\treadonly={readonly}/>\n\t\t\t</StyledLabel>\n\t\t\t<StyledLabel>Address\n\t\t\t\t<AddressLookup address={updatedUser.place} onLookup={onLocactionChange}/>\n\t\t\t</StyledLabel>\n\t\t\t<MapContainer>\n\t\t\t\t<Map points={[{id:0, position, contents}]}/>\n\t\t\t</MapContainer>\n\t\t\t<StyledLabel>Platform:</StyledLabel>\n\t\t\t<div>\n\t\t\t\t<StyledLabel bright>\n\t\t\t\t\t<StyledCheckbox\tchecked={checkHasPlatform(updatedUser, PS4)}\n\t\t\t\t\t\t\t\t\tonChange={() => onPlatformSelect(PS4)}\n\t\t\t\t\t\t\t\t\treadonly={readonly}/>&nbsp;&nbsp;\n\t\t\t\t\t{PS4}\n\t\t\t\t</StyledLabel>\n\t\t\t</div>\n\t\t</ProfileFormContainer>\n\t)\n}\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tupdatedUser: state.userUpdate.user\n\t}\n}\nconst mapDispatchToProps = {\n\tuserUpdateUnsaved\t\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileForm)","export const PS4 = 'PS4'\nexport const XBOX = 'XBOX'","import React from 'react'\nimport styled from \"styled-components\";\n\nconst StyledButton = styled.button`\n\tbox-sizing: border-box;\n\tborder: 2px solid #FDE74C;\n\tcolor: white;\n\t${props => props.reject && `\n\t\tborder-color: #AD2031;\n\t\tcolor: #AD2031;\n\t`}\n\tfont-weight: bold;\n\tbackground: none;\n\tline-height: 46px;\n\t${props => props.wide && 'width: 100%;'};\n\tflex-grow: 1;\n\tcursor: pointer;\n\tpadding: 0;\n`\nexport default function ({ children, ...props}) {\n\treturn <StyledButton{...props}>{children}</StyledButton>\n}","import React from 'react'\nimport styled from 'styled-components'\nimport {connect} from 'react-redux'\nimport {userUpdateSaveRequest} from '../actions/user-update'\nimport StyledButton from '../common/StyledButton'\nconst ProfileControlsContainer = styled.div`\n\tpadding: 20px;\n`\nfunction ProfileControls({userId, updatedUser, userUpdateSaveRequest}) {\n\treturn (\n\t\t<ProfileControlsContainer>\n\t\t\t<StyledButton onClick={() => userUpdateSaveRequest(userId, updatedUser)} wide>\n\t\t\t\tSave\n\t\t\t</StyledButton>\n\t\t</ProfileControlsContainer>\n\t)\n}\nconst mapStateToProps = ({userCache, auth, userUpdate}, {userId}) => ({\n\tuser: userCache.users[userId],\n\tupdatedUser: userUpdate.user,\n\tisSelf: auth.authData.uid === userId,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = {\n\tuserUpdateSaveRequest\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileControls)","import React, {useEffect, Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache'\nimport {userUpdateSaved} from '../actions/user-update'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport ProfileForm from '../components/ProfileForm'\nimport ProfileControls from '../components/ProfileControls'\nimport Footer from '../components/Footer'\nfunction PageProfile({userId, authData, savedUser, wait, userCacheFetchUserByIdRequest, userUpdateSaved}) {\n\tuseEffect(() => {\n\t\tif(authData && !savedUser) {\n\t\t\tuserCacheFetchUserByIdRequest(userId)\n\t\t}\n\t}, [authData, userId, savedUser, userCacheFetchUserByIdRequest])\n\tuseEffect(() => {\n\t\tif(savedUser && !wait) {\n\t\t\tuserUpdateSaved(savedUser)\n\t\t}\n\t}, [savedUser, wait, userUpdateSaved])\n\n\tif(!authData) {\n\t\treturn <AskAuthenticate />\n\t}\n\tconst isSelf = userId === authData?.uid\n\treturn (\n\t\t<Fragment>\n\t\t\t<div>\n\t\t\t\t<ProfileForm userId={userId} readonly={!isSelf}/>\n\t\t\t\t{/* <AddressLookup userId={userId}/>\n\t\t\t\t<AddressSuggestions />\n\t\t\t\t<ProfileMap userId={userId}/> */}\n\t\t\t\t<ProfileControls userId={userId}/>\n\t\t\t</div>\n\t\t\t<Footer />\n\t\t</Fragment>\n\t)\n\n}\nconst mapStateToProps = ({auth, userCache}, {match}) => {\n\tconst userId = match.params.uid\n\treturn {\n\t\tuserId,\n\t\tauthData: auth.authData,\n\t\tsavedUser: userCache.users[userId],\n\t\twait: userCache.userByIdWait || userCache.userUpdateWait\n\t}\n}\nconst mapDispatchToProps = {\n\tuserCacheFetchUserByIdRequest,\n\tuserUpdateSaved\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(PageProfile)","import React from 'react'\nimport styled from 'styled-components'\nimport {connect} from 'react-redux'\nimport {userUpdateCreateRequest} from '../actions/user-update'\nimport StyledButton from '../common/StyledButton'\nconst RegistrationFooter = styled.div`\n\tpadding: 20px;\n`\nfunction RegistrationControls({userId, updatedUser, userUpdateCreateRequest}) {\n\treturn (\n\t\t<RegistrationFooter>\n\t\t\t<StyledButton onClick={() => userUpdateCreateRequest(userId, updatedUser)} wide>\n\t\t\t\tRegister\n\t\t\t</StyledButton>\n\t\t</RegistrationFooter>\n\t)\n}\n\nconst mapStateToProps = ({userUpdate}) => ({\n\tupdatedUser: userUpdate.user,\n})\nconst mapDispatchToProps = {\n\tuserUpdateCreateRequest\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(RegistrationControls)","import React, {useEffect, Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport ProfileForm from '../components/ProfileForm'\nimport RegistrationControls from '../components/RegistrationControls'\nimport {userUpdateUnsaved} from '../actions/user-update'\n\nfunction PageRegistration({authData, updatedUser, onProfileUserUnregistered}) {\n\tuseEffect(() => {\n\t\tif(authData && !updatedUser) {\n\t\t\t//Create user object in userCache with name from authdata.displayName\n\t\t\tonProfileUserUnregistered(authData)\n\t\t}\n\t}, [authData, updatedUser, onProfileUserUnregistered])\n\tif(!authData) {\n\t\treturn <AskAuthenticate />\n\t} else {\n\t\treturn (\n\t\t<Fragment>\n\t\t\t<ProfileForm userId={authData.uid}/>\n\t\t\t<RegistrationControls userId={authData.uid}/>\n\t\t</Fragment>\n\t)\n\t}\n}\n\nconst mapStateToProps = ({userCache, auth, userUpdate}) => ({\n\tauthData: auth.authData,\n\tupdatedUser: userUpdate.user,\n\twait: userCache.userByIdWait || userCache.userUpdateWait\n})\nconst mapDispatchToProps = dispatch => ({\n\tonProfileUserUnregistered(authData) {\n\t\tconst userUnregistered = {\n\t\t\tname: authData.displayName\n\t\t}\n\t\tdispatch(userUpdateUnsaved(userUnregistered))\n\t}\n})\nexport default connect(mapStateToProps, mapDispatchToProps)(PageRegistration) ","import React from 'react'\nimport styled from 'styled-components'\nimport {Link} from \"react-router-dom\"\nconst StyledLinkContents= styled.span`\n\tdisplay: block;\n\tposition: relative;\n\tmargin: 1px 0;\n\t${({withBackground}) => withBackground \n\t&& 'background-color: #191A24;'}\n\t${({bold}) => bold \n\t&& 'font-weight: bold;'}\n\tpadding: 0 20px;\n\tline-height: 50px;\n\t${({left}) => left \n\t&& `padding-left: 50px;\n\t\t&:after {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tleft: 20px;\n\t\t\twidth: 14px;\n\t\t\theight: 14px;\n\t\t\tborder-left: 2px solid #FDE74C;\n\t\t\tborder-bottom: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t}`}\n\t${({right}) => right \n\t&& `padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 14px;\n\t\t\theight: 14px;\n\t\t\tborder-top: 2px solid #FDE74C;\n\t\t\tborder-right: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t}`}\n\t${({down}) => down\n\t&& `padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tborder-bottom: 2px solid #FDE74C;\n\t\t\tborder-right: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t\n\t\t}`}\n\t${({up}) => up\n\t&& `padding-right: 50px;\n\t\t&:after {\n\t\t\tcontent: \"\";\n\t\t\tposition: absolute;\n\t\t\ttop: 15px;\n\t\t\tright: 20px;\n\t\t\twidth: 12px;\n\t\t\theight: 12px;\n\t\t\tborder-top: 2px solid #FDE74C;\n\t\t\tborder-left: 2px solid #FDE74C;\n\t\t\ttransform: rotate(45deg);\n\t\t\n\t\t}`} \n`\nexport default function({to, children, left, right, down, up, withBackground, bold}) {\n\treturn (\n\t<Link to={to}>\n\t\t<StyledLinkContents\tleft={left}\n\t\t\t\t\t\t\tright={right}\n\t\t\t\t\t\t\tdown={down}\n\t\t\t\t\t\t\tup={up}\n\t\t\t\t\t\t\twithBackground={withBackground}\n\t\t\t\t\t\t\tbold={bold}>\n\t\t\t{children}\n\t\t</StyledLinkContents>\n\t</Link>\n\t)\n}","import React, {Fragment} from 'react'\nimport styled from 'styled-components'\nimport {useRouteMatch} from \"react-router-dom\"\nimport StyledLink from '../common/StyledLink'\nimport StyledLabel from '../common/StyledLabel'\nimport {\n\tPATH_TAB_LIST,\n\tPATH_TAB_LOCATION,\n} from '../constants/paths'\nimport GameLoader from '../containers/GameLoader'\nimport GameTile from './GameTile'\nconst TileContainer = styled.div`\n\ttext-align: center;\n`\nconst GameName = styled.h2`\n\tfont-size: 24px;\n\tpadding: 10px 20px;\n\tmargin: 0;\n\tmargin-top: 15px;\n`\nconst Section = styled.section`\n\tpadding 10px 20px;\n\tfont-size: 12px;\n`\nfunction GameInfoDescription({game}) {\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<TileContainer>\n\t\t\t\t<GameTile game={game} isBig/>\n\t\t\t</TileContainer>\n\t\t\t<GameName>{game.name}</GameName>\n\t\t\t<Section>\n\t\t\t\t<StyledLabel>Platform: </StyledLabel>\n\t\t\t\t{game.platform}\n\t\t\t</Section>\n\t\t\t{!!game.generes?.length && (\n\t\t\t\t<Section>\n\t\t\t\t\t<StyledLabel>Genere: </StyledLabel>\n\t\t\t\t\t{game.generes.join(', ')}\n\t\t\t\t</Section>\n\t\t\t)}\n\t\t</Fragment>\n\t)\n}\nfunction GameInfo({gameId}) {\n\tconst {url} = useRouteMatch();\n\treturn (\n\t\t<div>\n\t\t\t<GameLoader gameId={gameId} Component={GameInfoDescription}/>\n\t\t\t<StyledLink to={`${url}/${PATH_TAB_LIST}`} right withBackground>Offers list</StyledLink>\n\t\t\t<StyledLink to={`${url}/${PATH_TAB_LOCATION}`} right withBackground>Offers map</StyledLink>\n\t\t</div>\n\t)\n}\n\nexport default GameInfo","import firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport {\n\tCLAUSE_CACHE_ADD_PUSH,\n\tCLAUSE_CACHE_ADD_WAIT,\n\tCLAUSE_CACHE_ADD_ERROR,\n\tCLAUSE_CACHE_FETCH_BY_CHAT,\n\tCLAUSE_CACHE_WAIT_BY_CHAT,\n\tCLAUSE_CACHE_ERROR_BY_CHAT,\n\tCLAUSE_CACHE_UPDATE_STATUS,\n\tCLAUSE_CACHE_UPDATE_WAIT,\n\tCLAUSE_CACHE_UPDATE_ERROR\n} from '../constants/action-types'\nimport {\n\tCOLLECTION_CLAUSES\n} from '../constants/collection-names'\nimport {\n\tCLAUSE_STATUS_SUGGESTED,\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\n//Actions\nfunction clauseCacheAddPush(clauseId, clause) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_PUSH,\n\t\tpayload: {clauseId, clause}\n\t}\n}\nfunction clauseCacheAddWait() {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_WAIT\n\t}\n}\nfunction clauseCacheAddError(clauseId, addError) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ADD_ERROR,\n\t\tpayload: {addError}\n\t}\n}\nfunction clauseCacheFetchByChat(chatId, clauses) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_FETCH_BY_CHAT,\n\t\tpayload: {chatId, clauses}\n\t}\n}\nfunction clauseCacheWaitByChat(chatId) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_WAIT_BY_CHAT,\n\t\tpayload: {chatId}\n\t}\n}\nfunction clauseCacheErrorByChat(chatId, clausesByChatError) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_ERROR_BY_CHAT,\n\t\tpayload: {\n\t\t\tchatId,\n\t\t\tclausesByChatError\n\t\t}\n\t}\n}\nfunction clauseCacheUpdate(clauseId, clause) {\n\treturn {\n\t\ttype: CLAUSE_CACHE_UPDATE_STATUS,\n\t\tpayload: {\n\t\t\tclauseId,\n\t\t\tclause\n\t\t}\n\t}\n}\nfunction clauseCacheUpdateWait() {\n\treturn {type: CLAUSE_CACHE_UPDATE_WAIT}\n}\nfunction clauseCacheUpdateError(updateError){\n\treturn {\n\t\ttype: CLAUSE_CACHE_UPDATE_ERROR,\n\t\tpayload: updateError\n\t}\n}\n//Thunks\n/**\n * Creates clause in db with specified chatId\n * @params {String} chatId\n * @params {String} suggesterId basicly the authenticated user\n * @params {String} respondentId Owner of the offer/demand\n * @params {String} gameId\n * @params {Boolean} isDemand specifies if user is submitting a demand or an offer\n * @params {Function} successCallback\n */\nexport function clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId,\n\t\t\t\t\t\t\t\t\t\tgameId, isDemand, successCallback) {\n\treturn async dispatch => {\n\t\tconst clause = {\n\t\t\tchatId,\n\t\t\townerId,\n\t\t\tsuggesterId,\n\t\t\trespondentId,\n\t\t\tgameId,\n\t\t\tstatus: CLAUSE_STATUS_SUGGESTED,\n\t\t\tisDemand,\n\t\t\tsendDate: firebase.firestore.FieldValue.serverTimestamp(),\n\t\t\tupdateDate: firebase.firestore.FieldValue.serverTimestamp()\n\n\t\t}\n\t\tdispatch(clauseCacheAddWait())\n\t\ttry {\n\t\t\tconst clauseRef = await firebase.firestore()\n\t\t\t\t.collection(COLLECTION_CLAUSES).add(clause)\n\t\t\tdispatch(clauseCacheAddPush(clauseRef.id, {\n\t\t\t\t...clause,\n\t\t\t\tsendDate: new Date(), //because server date is unknown at the moment\n\t\t\t\tupdateDate: new Date() //because server date is unknown at the moment\n\t\t\t}))\n\t\t\tif(typeof(successCallback) === 'function') {\n\t\t\t\tsuccessCallback(clauseRef.id)\n\t\t\t}\n\t\t} catch(addError) {\n\t\t\tdispatch(clauseCacheAddError(addError))\n\t\t}\n\t}\n}\n/**\n * Fetches active (suggested and accepted) clauses for specified chat\n * @param chatId {String} chat\n */\nexport function clauseCacheFetchActiveByChatRequest(chatId) {\n\treturn async dispatch => {\n\t\tconst query = firebase.firestore().collection(COLLECTION_CLAUSES)\n\t\t\t.where('chatId','==', chatId)\n\t\t\t.where('status', 'in', [CLAUSE_STATUS_SUGGESTED, CLAUSE_STATUS_ACCEPTED])\n\t\tdispatch(clauseCacheWaitByChat(chatId))\n\t\ttry {\n\t\t\tconst querySnapshot = await query.get()\n\t\t\tconst clauses = querySnapshot.docs.reduce((clauses, doc) => {\n\t\t\t\tconst fetchedClause = doc.data()\n\t\t\t\tclauses[doc.id] = {\n\t\t\t\t\t...fetchedClause,\n\t\t\t\t\tsendDate: fetchedClause.sendDate.toDate(),\n\t\t\t\t\tupdateDate: fetchedClause.updateDate.toDate(),\n\t\t\t\t}\n\t\t\t\treturn clauses\n\t\t\t}, {})\n\t\t\tdispatch(clauseCacheFetchByChat(chatId, clauses))\n\t\t} catch (clausesByChatError) {\n\t\t\tdispatch(clauseCacheErrorByChat(chatId, clausesByChatError))\n\t\t}\n\t}\n}\n/**\n * Changes status for specified clause\n * @param clauseId {String}\n * @param clause {Object} updated clause\n */\nexport function clauseCacheUpdateStatusRequest(clauseId, clause) {\n\treturn async dispatch => {\n\t\tconst ref = firebase.firestore().collection(COLLECTION_CLAUSES)\n\t\t\t.doc(clauseId)\n\t\tdispatch(clauseCacheUpdateWait())\n\t\ttry {\n\t\t\tawait ref.update({\n\t\t\t\tstatus: clause.status,\n\t\t\t\tupdateDate: firebase.firestore.FieldValue.serverTimestamp()\n\t\t\t})\n\t\t\tdispatch(clauseCacheUpdate(clauseId, clause))\n\t\t} catch(updateError) {\n\t\t\tdispatch(clauseCacheUpdateError(updateError))\n\t\t}\n\n\t}\n}","export const CLAUSE_STATUS_SUGGESTED = 'CLAUSE_STATUS_SUGGESTED'\nexport const CLAUSE_STATUS_ACCEPTED = 'CLAUSE_STATUS_ACCEPTED'\nexport const CLAUSE_STATUS_REJECTED = 'CLAUSE_STATUS_REJECTED'\nexport const CLAUSE_STATUS_COMPLETED = 'CLAUSE_STATUS_COMPLETED'","import React, {useEffect, useState} from 'react'\nimport { Redirect } from 'react-router-dom';\nimport {connect} from 'react-redux'\nimport StyledButton from '../common/StyledButton'\nimport {\n\tchatCacheFetchByParticipantRequest,\n\tchatCacheAddRequest\n} from '../actions/chat-cache'\nimport {clauseCacheAddRequest} from '../actions/clause-cache'\nimport {PATH_PAGE_CHAT} from '../constants/paths'\nfunction SubmitToOffer ({ownerId, gameId, authenticatedUserId, fetched, waitFetch, dealChatId,\n\tonChatCacheFetchByParticipantRequest, onChatAndClauseAddRequest, onClauseAddRequest}) {\n\tuseEffect(() => {\n\t\tif(!waitFetch && !fetched) {\n\t\t\tonChatCacheFetchByParticipantRequest(authenticatedUserId) /*TODO fetch somwhere else.\n\t\t\tREDUX updates state (waitFetch, fetched) only after all of this components mounts,\n\t\t\tso each of them triggers this Fetch*/\n\t\t}\n\t}, [authenticatedUserId, fetched, waitFetch, onChatCacheFetchByParticipantRequest])\n\n\tconst [redirectUrl, toggleRedirect] = useState('')\n\n\tfunction onSubmitToOffer() {\n\t\tif(!dealChatId) {\n\t\t\t// TODO User can not create chat with self\n\t\t\tonChatAndClauseAddRequest(ownerId, authenticatedUserId, ownerId, gameId, false, toggleRedirect)\t\t\t\n\t\t} else {\n\t\t\tonClauseAddRequest(dealChatId, ownerId, authenticatedUserId, ownerId, gameId, false, toggleRedirect)\n\t\t}\n\t}\n\tif (redirectUrl) {\n\t\treturn <Redirect to={redirectUrl} />\n\t}\n\tif(waitFetch) {\n\t\treturn 'loading...'\n\t}\n\tif(fetched && authenticatedUserId) {\n\t\treturn <StyledButton wide onClick={onSubmitToOffer}>apply deal</StyledButton>\n\t}\n\treturn false\n}\n\nconst mapStateToProps = ({auth, chatCache}, {ownerId}) => {\n\tconst authenticatedUserId = auth.authData && auth.authData.uid\n\t\n\tlet dealChatId = null //Chat beetwen the authenticated user and owner of the game\n\tfor(let chatId in chatCache.chats) {\n\t\tlet chat = chatCache.chats[chatId]\n\t\tif(Array.isArray(chat.participantIds)\n\t\t\t&& (chat.participantIds.indexOf(authenticatedUserId) >= 0)\n\t\t\t&& (chat.participantIds.indexOf(ownerId) >= 0)) {\n\t\t\tdealChatId = chatId\n\t\t\tbreak\n\t\t}\n\t} \n\treturn {\n\t\tauthenticatedUserId,\n\t\tfetched: chatCache.chatsByParticipantFetched[authenticatedUserId],\n\t\twaitFetch: chatCache.chatsByParticipantWait[authenticatedUserId],\n\t\tdealChatId\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonChatCacheFetchByParticipantRequest(participantId) {\n\t\tdispatch(chatCacheFetchByParticipantRequest(participantId))\n\t},\n\tonChatAndClauseAddRequest(ownerId, suggesterId, respondentId, gameId, isDemand, toggleRedirect) {\n\t\tfunction onChatCreatedCallback(chatId) {\n\t\t\tfunction onClauseCreatedCallback(){\n\t\t\t\ttoggleRedirect(PATH_PAGE_CHAT.replace(':chatId', chatId))\n\t\t\t}\n\t\t\tdispatch(clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, onClauseCreatedCallback))\n\t\t}\n\t\tdispatch(chatCacheAddRequest([suggesterId, respondentId], onChatCreatedCallback))\n\t},\n\tonClauseAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, toggleRedirect) {\n\t\tfunction onClauseCreatedCallback(){\n\t\t\ttoggleRedirect(PATH_PAGE_CHAT.replace(':chatId', chatId))\n\t\t}\n\t\tdispatch(clauseCacheAddRequest(chatId, ownerId, suggesterId, respondentId, gameId, isDemand, onClauseCreatedCallback))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SubmitToOffer)","import React from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport SubmitToOffer from './SubmitToOffer'\n\nconst GameOfferContainer = styled.div`\n\tborder: 1px solid #5F606C;\n\tmargin: 10px;\n`\nconst GameOfferUser = styled.div`\n\tbackground-color: #21222B;\n\tpadding: 20px;\n\tbox-sizing: border-box;\n`\nconst SubmitToOfferContainer = styled.div`\n\tpadding: 10px;\n`\nfunction GameOffer ({gameId, userId, ownerId, user}) {\n\tif(userId === ownerId){\n\t\treturn <div>User: {user.name} <small>my offer</small></div>\n\t}\n\treturn (\n\t\t<GameOfferContainer>\n\t\t\t<GameOfferUser>\n\t\t\t\t{user.name}\n\t\t\t</GameOfferUser>\n\t\t\t<SubmitToOfferContainer>\n\t\t\t\t<SubmitToOffer ownerId={ownerId} gameId={gameId}/>\n\t\t\t</SubmitToOfferContainer>\n\t\t</GameOfferContainer>\n\t) \n}\n\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nexport default connect(mapStateToProps)(GameOffer)","import React from 'react'\nimport GameOffer from './GameOffer'\nimport StyledLink from '../common/StyledLink'\nimport { PATH_PAGE_GAME } from '../constants/paths'\nfunction GameOffers ({gameId, users}) {\n\tlet renderedOffers = []\n\tfor (let userId in users) {\n\t\trenderedOffers.push(<GameOffer \n\t\t\tgameId={gameId}\n\t\t\tuser={users[userId]}\n\t\t\townerId={userId}\n\t\t\tkey={userId}/>)\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<StyledLink\tto={PATH_PAGE_GAME.replace(':gameId', gameId)}\n\t\t\t\t\t\tleft\n\t\t\t\t\t\tbold>\n\t\t\t\tOffers list\n\t\t\t</StyledLink>\n\t\t\t{renderedOffers}\n\t\t</div>\n\t)\n}\nexport default(GameOffers)","import React, {Fragment} from 'react'\nimport styled from 'styled-components'\nimport Map from '../common/Map/Map'\nimport { PATH_PAGE_GAME } from '../constants/paths'\nimport StyledLink from '../common/StyledLink'\nimport SubmitToOffer from './SubmitToOffer'\nconst UserNameContainer = styled.div`\n\tmargin: 10px;\n`\nfunction GameLocations({users, gameId}) {\n\treturn (\n\t\t<div>\n\t\t\t<StyledLink\tto={PATH_PAGE_GAME.replace(':gameId', gameId)} \n\t\t\t\t\t\tleft\n\t\t\t\t\t\tbold>\n\t\t\t\tOffers map\n\t\t\t</StyledLink>\n\t\t\t<Map points={getPointsForUsers(users, gameId)}/>\n\t\t</div>\n\t)\n}\nfunction getPointsForUsers(users, gameId) {\n\tlet points = []\n\tfor(let userId in users) {\n\t\tpoints.push({\n\t\t\tid: userId,\n\t\t\tposition: [users[userId].latitude, users[userId].longitude],\n\t\t\tcontents: getContents(userId, users[userId], gameId)\n\t\t})\n\t}\n\treturn points\n}\nfunction getContents(userId, user, gameId) {\n\treturn ( \n\t\t<Fragment>\n\t\t\t<UserNameContainer>{user.name}</UserNameContainer>\n\t\t\t<SubmitToOffer ownerId={userId} gameId={gameId}/>\n\t\t</Fragment>\n\t)\n} \nexport default GameLocations","import React, {useEffect, Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport {\n\tPATH_TAB_LIST,\n\tPATH_TAB_LOCATION,\n} from '../constants/paths'\nimport Footer from '../components/Footer'\nimport {userCacheFetchByOfferRequest} from '../actions/user-cache'\nimport GameInfo from '../components/GameInfo'\nimport GameOffers from '../components/GameOffers'\nimport GameLocations from '../components/GameLocations'\nfunction PageGame({gameId, activeTab, authUserId, users, error, userCacheFetchByOfferRequest}) {\n\tuseEffect(()=> {\n\t\tif(authUserId && !users && !error) {\n\t\t\tuserCacheFetchByOfferRequest()\n\t\t}\n\t}, [authUserId, users, error, userCacheFetchByOfferRequest])\n\tif(error) {\n\t\treturn <div>{error.toString()}</div>\n\t}\n\tif(users) {\n\t\tconst usersWithOffer = getUsersWithOffer(users, gameId, authUserId)\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{!activeTab && <GameInfo gameId={gameId}/>}\n\t\t\t\t{activeTab === PATH_TAB_LIST \n\t\t\t\t\t\t\t\t&& <GameOffers gameId={gameId} users={usersWithOffer} />}\n\t\t\t\t{activeTab === PATH_TAB_LOCATION\n\t\t\t\t\t\t\t\t&& <GameLocations gameId={gameId} users={usersWithOffer} />}\n\t\t\t\t<Footer/>\n\t\t\t</Fragment>\n\t\t)\n\t}\n\treturn <div>Wait...</div>\n}\nfunction getUsersWithOffer(users, gameId, authUserId) {\n\tlet usersWithOffer = {}\n\tfor(let userId in users) {\n\t\tif(\n\t\t\tusers[userId].offerIds \n\t\t\t&& users[userId].offerIds.indexOf(gameId) >= 0\n\t\t\t&& userId !== authUserId\n\t\t) {\n\t\t\tusersWithOffer[userId] = users[userId]\n\t\t}\n\t}\n\treturn usersWithOffer\n}\nconst mapStateToProps = ({userCache, auth}, {match}) => {\n\tconst gameId = match.params.gameId;\n\tconst fetched = userCache.usersByOfferFetched[gameId]\n\tconst wait = userCache.usersByOfferWait[gameId]\n\treturn {\n\t\tgameId,\n\t\tauthUserId: auth.authData && auth.authData.uid,\n\t\tusers: fetched && !wait ? userCache.users : null,\n\t\terror: fetched && !wait ? userCache.usersByOfferError[gameId] : null,\n\t}\n}\nconst mapDispatchToProps = (dispatch, {match}) =>({\n\tuserCacheFetchByOfferRequest() {\n\t\treturn dispatch(userCacheFetchByOfferRequest(match.params.gameId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageGame)","import React from 'react'\nimport styled from 'styled-components'\nconst styleAvatarShape = `\n\tdisplay: inline-block;\n\tflex-shrink: 0;\n\twidth: 32px;\n\theight: 32px;\n\tline-height: 32px;\n\ttext-align: center;\n\toverflow: hidden;\n\tborder-radius: 50%;\n\tbackground-color: #454651;\n`\nconst AvatarImg = styled.img`\n\t${styleAvatarShape}\n`\nconst AvatarInitials = styled.label`\n\t${styleAvatarShape}\n`\nfunction Avatar({pic, name}) {\n\tconst initials = name\n\t\t.split(/\\s+/)\n\t\t.reduce((initials, namePart) => initials + namePart.charAt(0).toUpperCase(), '')\n\tif(pic) {\n\t\treturn <AvatarImg src={pic} title={name} alt={initials}/>\n\t}\n\treturn <AvatarInitials title={name}>{initials}</AvatarInitials>\n}\nexport default Avatar","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport {Link} from 'react-router-dom'\nimport styled from 'styled-components'\nimport Avatar from '../common/Avatar'\nimport {PATH_PAGE_CHAT} from '../constants/paths'\nimport {chatCacheFetchLastMessageRequest} from '../actions/chat-cache'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache'\nconst ChatContainer = styled.div`\n\tdisplay: flex;\n\theight: 58px;\n\tline-height: 58px;\n\talign-items: center;\n\tmargin 10px 0;\n\tpadding 0 20px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\tborder 1px solid #454651;\n`\nconst ChatInfo = styled.div`\n\tmargin-left: 10px;\n`\nfunction Chat ({chatId, chat, userId, lastMessage, companionId, companion, fetchLastMessage, fetchCompanion}) {\n\tuseEffect(() => {\n\t\tif(lastMessage === undefined) {\n\t\t\tfetchLastMessage(chatId)\n\t\t}\n\t\tif(!companion && companionId) {\n\t\t\tfetchCompanion(companionId)\n\t\t}\n\t})\n\tconst path = PATH_PAGE_CHAT.replace(':chatId', chatId)\n\tconst briefText = lastMessage && lastMessage.text //TODO kill it for now\n\treturn (\n\t\t<Link to={path}>\n\t\t\t<ChatContainer>\n\t\t\t\t<Avatar pic={companion?.pic} name={companion?.name || ''}/>\n\t\t\t\t<ChatInfo>{companion?.name}</ChatInfo>\n\t\t\t</ChatContainer>\n\t\t</Link>\n\t)\n}\n\nconst mapStateToProps = ({auth, chatCache, userCache}, {chatId, chat}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\tconst lastMessage = chatCache.chatsLastMessages[chatId]\n\tconst companionId = (chat.participantIds || [])\n\t\t.filter(participant => participant !== userId)[0]\n\tconst companion = userCache.users[companionId]\n\treturn {\n\t\tuserId,\n\t\tlastMessage,\n\t\tcompanionId,\n\t\tcompanion\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tfetchLastMessage(chatId) {\n\t\tdispatch(chatCacheFetchLastMessageRequest(chatId))\n\t},\n\tfetchCompanion(companionId) {\n\t\tdispatch(userCacheFetchUserByIdRequest(companionId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat)","import React, {useEffect, Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport Footer from '../components/Footer'\nimport Chat from '../components/Chat'\nimport {chatCacheFetchByParticipantRequest} from '../actions/chat-cache'\nconst PageContents = styled.div`\n\tpadding: 0 20px;\n`\nfunction PageChats ({history, match, userId, wait, error, fetched, chats, fetchChats}) {\n\tuseEffect(() => {\n\t\tif(userId && !wait && !error && !fetched) {\n\t\t\tfetchChats(userId)\n\t\t}\n\t})\n\tif(error) {\n\t\tconsole.log(error)\n\t\treturn <div>{error.toString()}</div> //Todo universal error handler\n\t}\n\tif(wait) {\n\t\treturn <div>Wait...</div> //TODO universal wait handler\n\t}\n\tconst userChats = filterChatsByParticipant(chats, userId)\n\treturn (\n\t\t<Fragment>\n\t\t\t<PageContents>{renderChats(userChats)}</PageContents>\n\t\t\t<Footer/>\n\t\t</Fragment>\n\t)\n}\nfunction renderChats(userChats) {\n\tlet renderedChats = []\n\tfor (let chatId in userChats) {\n\t\trenderedChats.push(<Chat key={chatId} chatId={chatId} chat={userChats[chatId]}/>)\n\t}\n\treturn renderedChats\n}\nfunction filterChatsByParticipant(chats, userId) {\n\tlet filteredChats = {}\n\tfor(let chatId in chats) {\n\t\tif( chats[chatId] \n\t\t\t&& Array.isArray(chats[chatId].participantIds) \n\t\t\t&& (chats[chatId].participantIds.indexOf(userId) >= 0)) {\n\t\t\tfilteredChats[chatId] = chats[chatId]\n\t\t}\n\t}\n\treturn filteredChats\n}\nconst mapStateToProps = ({auth, chatCache}) => {\n\tconst userId = auth.authData && auth.authData.uid\n\treturn {\n\t\tuserId,\n\t\twait:  chatCache.chatsByParticipantWait[userId],\n\t\terror: chatCache.chatsByParticipantError[userId],\n\t\tfetched: chatCache.chatsByParticipantFetched[userId],\n\t\tchats: chatCache.chats\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tfetchChats(userId) {\n\t\tdispatch(chatCacheFetchByParticipantRequest(userId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageChats)","import React from 'react'\nimport styled from 'styled-components'\nconst StyledSpoilerContainer = styled.div`\n\tposition: relative;\n\tbackground-color: #191A24;\n`\nconst StyledSpoilerButton = styled.button`\n\tborder: none;\n\tcolor: #FDE74C;\n\tpadding-left: 20px;\n\tpadding-right: 50px;\n\ttext-align: left;\n\tbackground: none;\n\twidth: 100%;\n\tline-height: 40px;\n\tcursor: pointer;\n\t&:after {\n\t\tcontent: \"\";\n\t\tposition: absolute;\n\t\ttop: 10px;\n\t\tright: 20px;\n\t\twidth: 12px;\n\t\theight: 12px;\n\t\tborder-bottom: 2px solid #FDE74C;\n\t\tborder-right: 2px solid #FDE74C;\n\t\ttransform: rotate(45deg);\n\t}\n\t${({toggled}) => toggled\n\t&& `&:after {\n\t\t\ttransform: rotate(225deg);\n\t\t}\n\t`}\n`\nconst StyledSpoilerContents = styled.div`\n\tdisplay: none;\n\tposition: absolute;\n\tbackground-color: inherit;\n\twidth: 100%;\n\ttop: 40px;\n\tleft: 0;\n\t${({toggled}) => toggled && 'display: block'}\n`\nexport default function({title, toggled, onClick, children}) {\n\treturn (\n\t\t<StyledSpoilerContainer>\n\t\t\t<StyledSpoilerButton toggled={toggled} onClick={onClick}>\n\t\t\t\t{title}\n\t\t\t</StyledSpoilerButton>\n\t\t\t<StyledSpoilerContents toggled={toggled}>\n\t\t\t\t{children}\n\t\t\t</StyledSpoilerContents>\n\t\t</StyledSpoilerContainer>\n\t)\n}","import React from 'react'\nexport default () => (\n\t<svg width=\"17\" height=\"18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<path d=\"M1 3.6c0-.5.3-.9.8-1l5-1a1 1 0 0 1 1.2.9v13a1 1 0 0 1-1.2 1l-5-1.1a1 1 0 0 1-.8-1V3.6zM12 1v16M16 1v16\" stroke=\"#FDE74C\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n\t</svg>\n)","import React from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport {\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\nconst DealBalanceContainer = styled.div`\n\tcolor: #FDE74C;\n\tpadding: 20px;\n`\nfunction DealBalance ({chatClausesArray, games, userId}) {\n\tconst evaluatedBalance = getBalance(chatClausesArray, games, userId, CLAUSE_STATUS_ACCEPTED)\n\treturn (\n\t\t<DealBalanceContainer>\n\t\t\t{getBalanceStatus(evaluatedBalance)}: {Math.abs(evaluatedBalance)}\n\t\t</DealBalanceContainer>\n\t)\n}\nfunction getBalanceStatus(evaluatedBalance) {\n\tif(evaluatedBalance === 0) {\n\t\treturn null;\n\t} \n\tif(evaluatedBalance > 0) {\n\t\treturn 'You receive'\n\t}\n\tif(evaluatedBalance < 0) {\n\t\treturn 'You pay'\n\t}\n}\nfunction getBalance(clausesArray, games, userId, clauseStatus) {\n\treturn clausesArray.reduce((balance, clause) => {\n\t\tif(clause.status !== clauseStatus) {\n\t\t\treturn balance\n\t\t}\n\t\t//TODO IMPORTANT, send error to server money evaluation!\n\t\t//must contain all games\n\t\tconst gamePrice = +(games[clause.gameId].unpackedPrice)\n\t\tif(userId === clause.ownerId) {\n\t\t\treturn balance + gamePrice\n\t\t}\n\t\treturn balance - gamePrice\n\t}, 0)\n}\n\nconst mapStateToProps = ({auth, gameCache}) => ({\n\tuserId: auth.authData && auth.authData.uid,\n\tgames: gameCache.games\n})\nconst mapDispatchToProps = dispatch => ({\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DealBalance)","import React from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport Avatar from '../common/Avatar'\nimport StyledButton from '../common/StyledButton'\nimport GameLoader from '../containers/GameLoader'\nimport GameTile from './GameTile'\nimport {\n\tCLAUSE_STATUS_REJECTED,\n\tCLAUSE_STATUS_ACCEPTED\n} from '../constants/clause-statuses'\nimport {clauseCacheUpdateStatusRequest} from '../actions/clause-cache'\nconst ClauseContainer = styled.div`\n\tpadding: 10px 20px;\n`\nconst ClauseControlsContainer = styled.div`\n\tdisplay: flex;\n\tmargin: 0 -10px\n`\nconst ClauseMessage = styled.p`\n\tmargin: 0;\n\tline-height: 32px;\n\tword-break: break-word;\n`\nconst ClauseBody = styled.div`\n\tdisplay: flex;\n`\nconst ClauseDescription = styled.div`\n\tmargin-left: 10px;\n`\nconst ClauseGameContainer = styled.div`\n\tdisplay: flex;\n`\nconst ClauseGameInfo = styled.div`\n\tpadding-left: 10px;\n\tline-height: 41px;\n`\nconst ClauseGameName = styled.h4`\n\tmargin: 0;\n\tpadding; 0;\n`\nconst ClauseGamePlatform = styled.p`\n\tmargin:0;\n\tpadding: 0;\n`\nfunction ClauseControls({userId, clause, acceptClause, rejectClause}) {\n\tif(clause.respondentId === userId && clause.status !== CLAUSE_STATUS_ACCEPTED) {\n\t\treturn (\n\t\t\t<ClauseControlsContainer>\n\t\t\t\t<StyledButton onClick={acceptClause}>Accept</StyledButton>\n\t\t\t\t<StyledButton onClick={rejectClause} reject>Reject</StyledButton>\n\t\t\t</ClauseControlsContainer>\n\t\t)\n\t}\n\treturn (\n\t\t<ClauseControlsContainer>\n\t\t\t<StyledButton onClick={rejectClause} reject>Reject</StyledButton>\n\t\t</ClauseControlsContainer>\n\t)\n}\nfunction ClauseGame({gameId, game}) {\n\treturn (\n\t\t<ClauseGameContainer>\n\t\t\t<GameTile gameId={gameId} game={game}/>\n\t\t\t<ClauseGameInfo>\n\t\t\t\t<ClauseGameName>{game.name}</ClauseGameName>\n\t\t\t\t<ClauseGamePlatform>{game.platform}</ClauseGamePlatform>\n\t\t\t</ClauseGameInfo>\n\t\t</ClauseGameContainer>\n\t)\n}\n\nfunction Clause ({clause, userId, user, acceptClause, rejectClause}) {\n\tif(!user) {\n\t\treturn <ClauseContainer>Loading... {JSON.stringify(clause)}</ClauseContainer>\n\t}\n\treturn (\n\t\t\t<ClauseContainer>\n\t\t\t\t<ClauseBody>\n\t\t\t\t\t<Avatar pic={user.pic} name={user.name}/>\n\t\t\t\t\t<ClauseDescription>\n\t\t\t\t\t\t<ClauseMessage>Is offering to you:</ClauseMessage>\n\t\t\t\t\t\t<GameLoader gameId={clause.gameId} Component={ClauseGame}/>\n\t\t\t\t\t</ClauseDescription>\n\t\t\t\t</ClauseBody>\n\t\t\t\t<ClauseControls\tuserId={userId}\n\t\t\t\t\t\t\t\tclause={clause}\n\t\t\t\t\t\t\t\tacceptClause={acceptClause}\n\t\t\t\t\t\t\t\trejectClause={rejectClause}/>\n\t\t\t</ClauseContainer>\n\t)\n}\n\nconst mapStateToProps = ({auth, userCache}, {clause}) => ({\n\tuser: userCache.users[clause.ownerId],\n\tuserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = (dispatch, {clauseId, clause}) => ({\n\tacceptClause() {\n\t\tdispatch(clauseCacheUpdateStatusRequest(clauseId, {\n\t\t\t...clause,\n\t\t\tstatus: CLAUSE_STATUS_ACCEPTED\n\t\t}))\n\t},\n\trejectClause() {\n\t\tdispatch(clauseCacheUpdateStatusRequest(clauseId, {\n\t\t\t...clause,\n\t\t\tstatus: CLAUSE_STATUS_REJECTED\n\t\t}))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Clause)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Clause from './clause'\n\nfunction DealClauses ({chatClauses}) {\n\tlet renderedClauses = []\n\tfor (let clauseId in chatClauses) {\n\t\tconst renderedClause = <Clause\tkey={clauseId} \n\t\t\t\t\t\t\t\t\t\tclauseId={clauseId}\n\t\t\t\t\t\t\t\t\t\tclause={chatClauses[clauseId]}/> \n\t\trenderedClauses.push(renderedClause)\n\t}\n\treturn renderedClauses\n}\nconst mapStateToProps = ({clauseCache}, {chatId}) => {\n\tlet chatClauses = {}\n\tfor(let clauseId in clauseCache.clauses) {\n\t\tif(chatId && clauseCache.clauses[clauseId] \n\t\t\t&& clauseCache.clauses[clauseId].chatId === chatId) {\n\t\t\tchatClauses[clauseId] = clauseCache.clauses[clauseId]\n\t\t}\n\t}\n\t//TODO check why this mapStateToProps evaluated multiple times\n\treturn {\n\t\tchatClauses\n\t}\n}\n\nexport default connect(mapStateToProps)(DealClauses)","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport DealBalance from './DealBalance'\nimport DealClauses from './DealClauses'\nimport {gameCacheFetchMissingGamesRequest} from '../actions/game-cache'\nfunction Deal ({\n\tchatId,\n\tchatClausesArray,\n\tgames,\n\tgamesByIdWait,\n\tgamesFetchErrors,\n\tisGamesFetched,\n\tisGamesWait,\n\thasAllRequiredGames,\n\tfetchGames\n}) {\n\tuseEffect(()=> {\n\t\tconst gameIds = chatClausesArray.map(clause => clause.gameId)\n\t\tfetchGames(gameIds, games, gamesByIdWait)\n\t})\n\tif(isGamesWait || !isGamesFetched) {\n\t\treturn <div>Wait...</div>\n\t}\n\tif(!hasAllRequiredGames) {\n\t\t//TODO ERROR DISPLAYER\n\t\treturn (<div>\n\t\t\tError fetching Games\n\t\t\t<pre>{JSON.stringify(gamesFetchErrors)}</pre>\n\t\t</div>)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<DealClauses chatId={chatId}/>\n\t\t\t<DealBalance chatClausesArray={chatClausesArray}/>\n\t\t</div>\n\t)\n}\n\nconst mapStateToProps = ({clauseCache, gameCache}, {chatId}) => {\n\tconst chatClausesArray = Object.values(clauseCache.clauses).filter(clause => clause.chatId = chatId)\n\tconst gamesFetchErrors = chatClausesArray.reduce((gamesFetchErrors, clause) => {\n\t\tif(gameCache.gamesByIdError[clause.gameId]) {\n\t\t\treturn [...gamesFetchErrors, gameCache.gamesByIdError[clause.gameId]]\n\t\t}\n\t\treturn gamesFetchErrors\n\t}, [])\n\tconst isGamesFetched = chatClausesArray.every(clause => gameCache.gamesByIdFetched[clause.gameId])\n\tconst isGamesWait = chatClausesArray.some(clause => gameCache.gamesByIdWait[clause.gameId])\n\tconst hasAllRequiredGames = chatClausesArray.every(clause => gameCache.games[clause.gameId])\n\n\treturn {\n\t\tchatClausesArray,\n\t\tgames: gameCache.games,\n\t\tgamesByIdWait: gameCache.gamesByIdWait,\n\t\tgamesFetchErrors,\n\t\tisGamesFetched,\n\t\tisGamesWait,\n\t\thasAllRequiredGames\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tfetchGames(gameIds, games, gamesByIdWait) {\n\t\tdispatch(gameCacheFetchMissingGamesRequest(gameIds, games, gamesByIdWait))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Deal)","import React from 'react'\nimport {connect} from 'react-redux'\nimport Avatar from '../common/Avatar'\nimport styled from 'styled-components'\n\nconst MessageContainer = styled.div`\n\tpadding: 10px 20px;\n\tdisplay: flex;\n`\nconst MessageText = styled.p`\n\tmargin-left: 10px;\n\tmargin-top: 7px;\n\tword-break: break-word;\n`\nfunction Message ({message, user}) {\n\tif(!user) {\n\t\treturn <MessageContainer>Loading...</MessageContainer> //TODO perform check earlier\n\t}\n\treturn (\n\t\t<MessageContainer>\n\t\t\t<Avatar pic={user.pic} name={user.name}/>\n\t\t\t<MessageText>\n\t\t\t\t{message.text} {getStatusSign(message)}\n\t\t\t</MessageText>\n\t\t</MessageContainer>\n\t)\n}\nfunction getStatusSign(message) {\n\tif(message.isUpdating) {\n\t\treturn String.fromCharCode(8987)\n\t}\n\treturn String.fromCharCode(10003)\n}\nconst mapStateToProps = ({userCache}, {message}) => {\n\treturn {\n\t\tuser: userCache.users[message.authorId]\n\t}\n}\n\nexport default connect(mapStateToProps)(Message)","import React from 'react'\nimport Message from './Message'\nimport Clause from './clause'\nexport default function MessagesListBody({messages, clauses}) {\n\tconst unsortedCommunications = [...messages, ...objectToArrayWithIds(clauses)]\n\tconst communications = unsortedCommunications.sort((a, b) => {\n\t\t\treturn a.sendDate - b.sendDate\n\t\t})\n\treturn communications.map(communication => {\n\t\tif(communication.gameId) {\n\t\t\treturn <Clause key={communication.id} clauseId={communication.id} clause={communication}/>\n\t\t}\n\t\treturn <Message key={communication.id} message={communication} />\n\t})\n}\nfunction objectToArrayWithIds(list) { //TODO move to utilities\n\tlet listArray = []\n\tfor(let id in list) {\n\t\tlistArray.push({\n\t\t\tid,\n\t\t\t...list[id]\n\t\t})\n\t}\n\treturn listArray\n}","import React, {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport styled from 'styled-components'\nimport MessageListBody from './MessagesListBody'\nimport {messageCacheFetchRequest} from '../actions/message-cache'\nimport {clauseCacheFetchActiveByChatRequest} from '../actions/clause-cache'\nconst MessageListContainer = styled.div`\n\theight: calc(100vh - 230px);\n\toverflow: auto;\n`\nfunction MessageList ({\n\t\tchatId,\n\t\tmessagesFetched,\n\t\tmessagesFetching,\n\t\tmessages,\n\t\tclausesFetched,\n\t\tclausesFetching,\n\t\tclauses,\n\t\tonMessagesFetch,\n\t\tonClauseFetch\n\t}) {\n\t// fetch messages\n\tuseEffect(() => {\n\t\tif(!messagesFetching && !messagesFetched) {\n\t\t\tonMessagesFetch(chatId)\n\t\t}\n\t}, [chatId, messagesFetched, messagesFetching, onMessagesFetch])\n\n\t// fetch clauses\n\tuseEffect(()=> {\n\t\tif(!clausesFetching && !clausesFetched) {\n\t\t\tonClauseFetch(chatId)\n\t\t}\n\t}, [chatId, clausesFetched, clausesFetching, onClauseFetch])\n\n\tif(!clausesFetched && !clausesFetched) {\n\t\treturn <div>wait...</div>\n\t}\n\treturn (\n\t\t<MessageListContainer>\n\t\t\t<MessageListBody messages={messages} clauses={clauses}/>\n\t\t</MessageListContainer>\n\t)\n}\nconst mapStateToProps = ({messageCache, clauseCache}, {chatId}) => ({\n\tmessagesFetched: messageCache.messagesFetched,\n\tmessagesFetching: messageCache.messagesFetching,\n\tmessages: messageCache.messages,\n\tclausesFetched: clauseCache.clausesByChatFetched[chatId],\n\tclausesFetching: clauseCache.clausesByChatWait[chatId],\n\tclauses: clauseCache.clauses\n})\nconst mapDispatchToProps = dispatch => ({\n\tonMessagesFetch(chatId) {\n\t\tdispatch(messageCacheFetchRequest(chatId))\n\t},\n\tonClauseFetch(chatId) {\n\t\tdispatch(clauseCacheFetchActiveByChatRequest(chatId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessageList)","import React, {useState} from 'react'\nimport {connect} from 'react-redux'\nimport {messageCacheSendMessageRequest} from '../actions/message-cache'\nimport StyledInput from '../common/StyledInput'\nimport styled from 'styled-components'\nconst MeassageInputContainer = styled.div`\n\tposition: fixed;\n\tbox-sizing: border-box;\n\twidth: 100%;\n\tpadding: 4px 20px;\n\tleft: 0;\n\tbottom: 0;\n`\nfunction MessageInput ({chatId, recipientId, userId, onSendMessage}) {\n\tconst [message, setMessage] = useState('')\n\tfunction onSubmit() {\n\t\tonSendMessage(chatId, message, userId, recipientId)\n\t\tsetMessage('');\n\t}\n\treturn (\n\t\t<MeassageInputContainer>\n\t\t\t<StyledInput\tvalue={message}\n\t\t\t\t\t\t\tplaceholder=\"Type your message here\"\n\t\t\t\t\t\t\tonChange={setMessage}\n\t\t\t\t\t\t\tonSubmit={onSubmit}/>\n\t\t</MeassageInputContainer>\n\t)\n}\nconst mapStateToProps = ({auth}) => ({\n\tuserId: auth.authData && auth.authData.uid\n})\nconst mapDispatchToProps = dispatch => ({\n\tonSendMessage(text, chatId, authorId, recipientId) {\n\t\tdispatch(messageCacheSendMessageRequest(text, chatId, authorId, recipientId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MessageInput)","import React, {Fragment, useEffect, useState} from 'react'\nimport {connect} from 'react-redux'\nimport {PATH_PAGE_CHATS} from '../constants/paths.js'\nimport StyledLink from '../common/StyledLink'\nimport StyledSpoiler from '../common/StyledSpoiler'\nimport IconList from '../common/Icons/IconList'\nimport {chatCacheFetcByIdRequest} from '../actions/chat-cache'\nimport {userCacheFetchUserByIdRequest} from '../actions/user-cache'\nimport AskAuthenticate from '../components/ask-authenticate'\nimport Deal from '../components/Deal'\nimport MessageList from '../components/MessageList'\nimport MessageInput from '../components/MessageInput'\nimport styled from 'styled-components'\nconst IconContainer = styled.span`\n\tdisplay: inline-block;\n\tvertical-align: midle;\n\tfloat: right;\n`\nconst ChatContainer = styled.div`\n\tmargin-bottom: 82px;\n`\nfunction PageChat ({\n\tchatId,\n\tchat,\n\tuserId,\n\tuser,\n\tcompanionId,\n\tcompanion,\n\tonChatFetch,\n\tonUserFetch}) {\n\tuseEffect(() => {\n\t\tif(userId && !user) {\n\t\t\tonUserFetch(userId)\n\t\t}\n\t\tif(companionId && !companion) {\n\t\t\tonUserFetch(companionId)\n\t\t}\n\t\tif(!chat && chatId) {\n\t\t\tonChatFetch(chatId)\n\t\t}\n\t}, [userId, user, chatId, chat, companionId, companion, onChatFetch, onUserFetch])\n\tconst [dealToggled, setDealToggled] = useState(false)\n\tif(!userId) {\n\t\treturn <AskAuthenticate />\n\t}\n\treturn (\n\t\t<Fragment>\n\t\t\t<ChatContainer>\n\t\t\t\t<StyledLink to={PATH_PAGE_CHATS} left bold >\n\t\t\t\t\tChat with {companion?.name}\n\t\t\t\t\t<IconContainer><IconList /></IconContainer>\n\t\t\t\t</StyledLink>\n\t\t\t\t<StyledSpoiler\ttitle=\"Exchange details\"\n\t\t\t\t\t\t\t\ttoggled={dealToggled}\n\t\t\t\t\t\t\t\tonClick={() => setDealToggled(!dealToggled)}>\n\t\t\t\t\t<Deal chatId={chatId} />\n\t\t\t\t</StyledSpoiler>\n\t\t\t\t<MessageList chatId={chatId}/>\n\t\t\t</ChatContainer>\n\t\t\t<MessageInput chatId={chatId} recipientId={companionId}/>\n\t\t</Fragment>\n\t)\n}\n\nconst mapStateToProps = ({auth, chatCache, userCache},{match}) => {\n\tconst chatId = match.params.chatId\n\tconst userId = auth.authData && auth.authData.uid\n\tconst chat = chatCache.chats[chatId]\n\tconst companionId = (Array.isArray(chat && chat.participantIds) \n\t\t? chat.participantIds.find(participantId => participantId !== userId)\n\t\t: null\n\t)\n\treturn {\n\t\tchatId,\n\t\tchat,\n\t\tuserId,\n\t\tuser: userCache.users[userId],\n\t\tcompanionId,\n\t\tcompanion: userCache.users[companionId]\n\t}\n}\nconst mapDispatchToProps = dispatch => ({\n\tonChatFetch(chatId) {\n\t\tdispatch(chatCacheFetcByIdRequest(chatId))\n\t},\n\tonUserFetch(userId) {\n\t\tdispatch(userCacheFetchUserByIdRequest(userId))\n\t}\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PageChat)","import React from 'react'\nexport default function NotFound () {\n\treturn <h2>Page not found</h2>\n}","import React, {Fragment} from 'react'\nimport { createStore, applyMiddleware } from 'redux'\nimport thunk from 'redux-thunk'\nimport { Provider } from 'react-redux';\nimport { BrowserRouter, Switch, Route} from 'react-router-dom'\n\nimport rootReducer from './rootReducer'\n\n//initial components\nimport Header from './components/Header'\nimport Modals from './containers/Modals'\nimport SubscriptionMessages from './components/subscription-messages'\n\n//pages components\nimport PageSearch from './pages/PageSearch'\nimport PageOffers from './pages/PageOffers'\nimport PageProfile from './pages/PageProfile'\nimport PageRegistration from './pages/PageRegistration'\nimport PageGame from './pages/PageGame'\nimport PageChats from './pages/PageChats'\nimport PageChat from './pages/PageChat'\nimport PageNotFound from './pages/PageNotFound'\n\nimport {\n\tPATH_TAB_LIST,\n\tPATH_TAB_LOCATION,\n\tPATH_PAGE_SEARCH,\n\tPATH_PAGE_PROFILE,\n\tPATH_PAGE_OFFERS,\n\tPATH_PAGE_REGISTRATION,\n\tPATH_PAGE_GAME,\n\tPATH_PAGE_CHATS,\n\tPATH_PAGE_CHAT,\n} from './constants/paths'\n\n\nconst store = createStore(\n\trootReducer,\n    undefined,\n    applyMiddleware(thunk)\n);\nexport default function() {\n\treturn (\n\t\t<Fragment>\n\t\t\t<Provider store={store}>\n\t\t\t\t<BrowserRouter>\n\t\t\t\t\t<Route component={Header} />\n\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t<Route exact path=\"/\" component={PageOffers} />\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_SEARCH} component={PageSearch} />\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_OFFERS} component={PageOffers} />\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_PROFILE} component={PageProfile} />\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_REGISTRATION} component={PageRegistration} />\n\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_GAME} component={PageGame} />\n\t\t\t\t\t\t\t<Route\texact\n\t\t\t\t\t\t\t\t\tpath={PATH_PAGE_GAME + '/' + PATH_TAB_LIST} \n\t\t\t\t\t\t\t\t\trender={routeProps => <PageGame {...routeProps} activeTab={PATH_TAB_LIST}/>} />\n\t\t\t\t\t\t\t<Route\texact\n\t\t\t\t\t\t\t\t\tpath={PATH_PAGE_GAME + '/' + PATH_TAB_LOCATION} \n\t\t\t\t\t\t\t\t\trender={routeProps => <PageGame {...routeProps} activeTab={PATH_TAB_LOCATION}/>} />\n\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_CHATS} component={PageChats} />\n\t\t\t\t\t\t\t<Route exact path={PATH_PAGE_CHAT} component={PageChat} />\n\t\t\t\t\t\t\t<Route component={PageNotFound} />\n\t\t\t\t\t\t</Switch>\n\t\t\t\t\t<Modals/>\n\t\t\t\t</BrowserRouter>\n\t\t\t\t<SubscriptionMessages />\n\t\t\t</Provider>\n\t\t</Fragment>\n\t)\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport firebase from 'firebase/app';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css'\n\nconst firebaseConfig = {\n\tapiKey: \"AIzaSyAbxWCNCtF7lm-fmwg00zbAY11aMWPomz0\",\n\tauthDomain: \"unpacked-dev.firebaseapp.com\",\n\tdatabaseURL: \"https://unpacked-dev.firebaseio.com\",\n\tprojectId: \"unpacked-dev\",\n\tstorageBucket: \"unpacked-dev.appspot.com\",\n\tmessagingSenderId: \"1063122406998\",\n\tappId: \"1:1063122406998:web:615fd045afd6407f\"\n};\nfirebase.initializeApp(firebaseConfig)\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}